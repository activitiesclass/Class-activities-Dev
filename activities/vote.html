<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ØµÙˆÙ‘Øª ÙˆÙ‚Ø±Ø± âœ‹ğŸ—³ï¸</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  
  <!-- Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ù…Ø¯Ù…Ø¬Ø© ÙÙŠ Ø§Ù„ØµÙØ­Ø© -->
  <style>
    /* Unified Styles Template - Ù…Ø¯Ù…Ø¬ */
    :root {
      --primary-color: #DC143C;
      --secondary-color: #228B22;
      --accent-color: #FFD700;
      --omani-red: #DC143C;
      --omani-green: #228B22;
      --omani-gold: #FFD700;
      --bg-primary: #ffffff;
      --bg-secondary: #f8f9fa;
      --bg-card: #ffffff;
      --text-primary: #333333;
      --text-secondary: #666666;
      --text-light: #ffffff;
      --text-muted: #999999;
      --success-color: #28a745;
      --warning-color: #ffc107;
      --error-color: #dc3545;
      --info-color: #17a2b8;
      --light-gray: #f8f9fa;
      --medium-gray: #dee2e6;
      --dark-gray: #6c757d;
      --white: #ffffff;
      --black: #000000;
      --shadow-light: 0 2px 4px rgba(0,0,0,0.1);
      --shadow-medium: 0 4px 8px rgba(0,0,0,0.15);
      --shadow-heavy: 0 8px 16px rgba(0,0,0,0.2);
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;
      --radius-xl: 16px;
      --radius-full: 50px;
      --space-xs: 4px;
      --space-sm: 8px;
      --space-md: 16px;
      --space-lg: 24px;
      --space-xl: 32px;
      --font-size-xs: 0.75rem;
      --font-size-sm: 0.875rem;
      --font-size-base: 1rem;
      --font-size-lg: 1.125rem;
      --font-size-xl: 1.25rem;
      --transition-fast: 0.15s;
      --transition-normal: 0.3s;
      --transition-slow: 0.5s;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      margin: 0;
      padding: 0;
      line-height: 1.6;
      color: var(--text-primary);
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: var(--space-lg);
    }

    .header {
      text-align: center;
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color: var(--text-light);
      padding: var(--space-xl);
      border-radius: var(--radius-xl);
      margin-bottom: var(--space-xl);
      box-shadow: var(--shadow-heavy);
    }

    .card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      margin-bottom: var(--space-lg);
      box-shadow: var(--shadow-medium);
      border: 1px solid var(--light-gray);
    }

    .btn {
      display: inline-block;
      padding: var(--space-sm) var(--space-md);
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      text-decoration: none;
      font-weight: 600;
      transition: all var(--transition-normal);
      text-align: center;
      font-size: var(--font-size-base);
    }

    .btn-primary {
      background: var(--primary-color);
      color: var(--text-light);
    }

    .btn-secondary {
      background: var(--secondary-color);
      color: var(--text-light);
    }

    .btn-accent {
      background: var(--accent-color);
      color: var(--text-primary);
    }

    .btn-large {
      padding: var(--space-md) var(--space-lg);
      font-size: var(--font-size-lg);
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-medium);
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .form-group {
      margin-bottom: var(--space-md);
    }

    .form-label {
      display: block;
      margin-bottom: var(--space-sm);
      font-weight: 600;
      color: var(--text-primary);
    }

    .form-select {
      width: 100%;
      padding: var(--space-sm);
      border: 2px solid var(--light-gray);
      border-radius: var(--radius-md);
      font-size: var(--font-size-base);
      background: var(--bg-primary);
      transition: border-color var(--transition-normal);
    }

    .form-select:focus {
      outline: none;
      border-color: var(--primary-color);
    }

    .text-center {
      text-align: center;
    }

    /* Responsive Framework */
    .responsive-container {
      width: 100%;
      max-width: 100%;
      margin: 0 auto;
      padding: 0 var(--space-md);
    }

    .mobile-card {
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-light);
      transition: all var(--transition-normal);
    }

    .mobile-heading {
      font-size: clamp(1.2rem, 4vw, 2rem);
      margin-bottom: var(--space-md);
    }

    .mobile-subtitle {
      font-size: clamp(0.9rem, 3vw, 1.1rem);
      opacity: 0.8;
    }

    .mobile-grid {
      display: grid;
      gap: var(--space-md);
    }

    .mobile-input {
      width: 100%;
    }

    .mobile-label {
      font-size: clamp(0.9rem, 3vw, 1rem);
    }

    .mobile-btn {
      min-height: 48px;
      font-size: clamp(0.9rem, 3vw, 1.1rem);
      padding: var(--space-sm) var(--space-md);
    }

    .mobile-text {
      font-size: clamp(0.8rem, 2.5vw, 1rem);
      line-height: 1.5;
    }

    .mobile-notification {
      padding: var(--space-md);
      border-radius: var(--radius-md);
      font-size: clamp(0.8rem, 2.5vw, 0.95rem);
    }

    .mobile-chart {
      width: 100%;
      height: auto;
      max-height: 400px;
    }

    .touch-target {
      min-height: 44px;
      min-width: 44px;
    }

    .touch-device .btn {
      padding: var(--space-md);
      font-size: var(--font-size-lg);
    }

    /* Ø¥Ø®ÙØ§Ø¡ Ø±Ø§Ø¨Ø· ØªØ®Ø·ÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
    .sr-only {
      position: absolute !important;
      width: 1px !important;
      height: 1px !important;
      padding: 0 !important;
      margin: -1px !important;
      overflow: hidden !important;
      clip: rect(0, 0, 0, 0) !important;
      white-space: nowrap !important;
      border: 0 !important;
    }

    .sr-only:focus {
      position: static !important;
      width: auto !important;
      height: auto !important;
      padding: var(--space-sm) var(--space-md) !important;
      margin: 0 !important;
      overflow: visible !important;
      clip: auto !important;
      white-space: normal !important;
      background: var(--primary-color) !important;
      color: var(--text-light) !important;
      text-decoration: none !important;
      border-radius: var(--radius-sm) !important;
      z-index: 10000 !important;
    }

    /* Ø£Ù†Ù…Ø§Ø· Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© */
    .back-to-main {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 9999;
    }

    .back-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color: var(--text-light);
      padding: 12px 20px;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 600;
      font-size: 14px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.1);
      min-height: 48px;
      min-width: 48px;
      justify-content: center;
    }

    .back-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
    }

    .back-btn:active {
      transform: translateY(-1px) scale(1.02);
    }

    .back-icon {
      font-size: 18px;
      animation: float 3s ease-in-out infinite;
    }

    .back-text {
      font-family: 'Cairo', sans-serif;
      white-space: nowrap;
    }

    /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø§Ù†ÙŠÙ…ÙŠØ´Ù† */
    @keyframes backButtonGlow {
      0%, 100% { 
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2), 0 0 0 0 rgba(220, 20, 60, 0.4);
      }
      50% { 
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3), 0 0 0 10px rgba(220, 20, 60, 0.1);
      }
    }

    .back-btn:focus {
      outline: none;
      animation: backButtonGlow 2s ease-in-out infinite;
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
    @media (max-width: 768px) {
      .back-to-main {
        top: 15px;
        left: 15px;
      }

      .back-btn {
        padding: 10px 16px;
        font-size: 13px;
        border-radius: 40px;
      }

      .back-icon {
        font-size: 16px;
      }

      .back-text {
        font-size: 12px;
      }

      /* Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙˆØª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
      .audio-controls {
        top: 80px !important;
        left: 15px !important;
        flex-direction: column !important;
        gap: 5px !important;
        padding: 8px !important;
      }
    }

    /* Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ - Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙÙ‚Ø· */
    @media (max-width: 480px) {
      .back-text {
        display: none;
      }

      .back-btn {
        width: 48px;
        height: 48px;
        padding: 12px;
        border-radius: 50%;
      }

      .back-icon {
        font-size: 20px;
      }

      /* Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙˆØª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
      .audio-controls {
        top: 75px !important;
        left: 15px !important;
        flex-direction: row !important;
        gap: 5px !important;
        padding: 6px !important;
      }
    }

    /* ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
    @media (hover: hover) {
      .back-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
        transition: left 0.6s;
        border-radius: inherit;
      }

      .back-btn:hover::before {
        left: 100%;
      }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„Ù…Ø³ÙŠØ© */
    @media (hover: none) and (pointer: coarse) {
      .back-btn {
        min-height: 52px;
        min-width: 52px;
        padding: 14px 18px;
      }

      .back-btn:hover {
        transform: none;
      }

      .back-btn:active {
        transform: scale(0.95);
      }
    }

    @media (max-width: 768px) {
      .container {
        padding: var(--space-md);
      }

      .mobile-grid {
        grid-template-columns: 1fr;
      }

      .mobile-btn {
        width: 100%;
        margin: var(--space-xs) 0;
      }
    }
  </style>
  
  <!-- Activity-specific styles -->
  <style>
    /* Voting activity specific styles */
    .voting-setup {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--space-md);
      margin: var(--space-xl) 0;
    }
    
    .candidate-area {
      background: linear-gradient(135deg, var(--accent-light), var(--accent-color));
      border-radius: var(--radius-xl);
      padding: var(--space-xl);
      margin: var(--space-lg) 0;
      border: 3px dashed var(--primary-color);
      min-height: 150px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    
    .candidates-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: var(--space-md);
      margin: var(--space-lg) 0;
    }
    
    .candidate-card {
      background: var(--bg-card);
      border: 2px solid var(--primary-color);
      border-radius: var(--radius-lg);
      padding: var(--space-md);
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-normal);
      position: relative;
      overflow: hidden;
    }
    
    .candidate-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--omani-red), var(--omani-green), var(--omani-gold));
    }
    
    .candidate-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-medium);
      border-color: var(--accent-color);
    }
    
    .candidate-card.selected {
      background: var(--primary-color);
      color: var(--text-light);
      transform: translateY(-6px);
      box-shadow: var(--shadow-heavy);
    }
    
    .voters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: var(--space-sm);
      margin: var(--space-lg) 0;
    }
    
    .voter-card {
      background: var(--bg-card);
      border: 2px solid var(--secondary-color);
      border-radius: var(--radius-md);
      padding: var(--space-sm);
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-normal);
      font-size: var(--font-size-sm);
    }
    
    .voter-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-light);
    }
    
    .voter-card.voted {
      background: var(--secondary-color);
      color: var(--text-light);
      border-color: var(--secondary-dark);
    }
    
    .results-section {
      background: var(--bg-card);
      border-radius: var(--radius-xl);
      padding: var(--space-xl);
      margin: var(--space-xl) 0;
      border: 2px solid var(--accent-color);
    }
    
    .result-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-md);
      margin: var(--space-sm) 0;
      background: var(--light-gray);
      border-radius: var(--radius-lg);
      border-left: 4px solid var(--primary-color);
    }
    
    .result-item.winner {
      background: linear-gradient(135deg, var(--accent-light), var(--white));
      border-left-color: var(--accent-color);
      animation: pulse 2s infinite;
    }
    
    .vote-count {
      background: var(--primary-color);
      color: var(--text-light);
      padding: var(--space-xs) var(--space-sm);
      border-radius: var(--radius-full);
      font-weight: 600;
      min-width: 40px;
      text-align: center;
    }
    
    .progress-bar-custom {
      width: 100%;
      height: 8px;
      background: var(--light-gray);
      border-radius: var(--radius-full);
      overflow: hidden;
      margin: var(--space-sm) 0;
    }
    
    .progress-fill-custom {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      border-radius: var(--radius-full);
      transition: width var(--transition-slow);
    }
    
    .voting-status {
      text-align: center;
      padding: var(--space-lg);
      margin: var(--space-lg) 0;
      background: linear-gradient(135deg, var(--light-gray), var(--white));
      border-radius: var(--radius-lg);
      border: 2px solid var(--medium-gray);
    }
    
    .voting-status.active {
      border-color: var(--success-color);
      background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), var(--white));
    }
    
    .voting-status.completed {
      border-color: var(--accent-color);
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), var(--white));
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±Ø© */
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    @keyframes glow {
      0%, 100% { box-shadow: 0 0 5px var(--primary-color); }
      50% { box-shadow: 0 0 20px var(--primary-color), 0 0 30px var(--primary-color); }
    }

    @keyframes sparkle {
      0% { opacity: 1; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
      100% { opacity: 0; transform: scale(1.2); }
    }

    @keyframes slideInFromLeft {
      0% { transform: translateX(-100%); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }

    @keyframes slideInFromRight {
      0% { transform: translateX(100%); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }

    @keyframes bounceIn {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.05); }
      70% { transform: scale(0.9); }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @keyframes countdownPulse {
      0% { transform: scale(1); background: var(--bg-card); }
      50% { transform: scale(1.1); background: var(--accent-color); color: white; }
      100% { transform: scale(1); background: var(--bg-card); }
    }

    @keyframes typewriter {
      from { width: 0; }
      to { width: 100%; }
    }

    @keyframes blink {
      50% { border-color: transparent; }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªÙØ§Ø¹Ù„ÙŠØ© Ù…ØªØ·ÙˆØ±Ø© */
    .enhanced-card {
      position: relative;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .enhanced-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.6s;
      z-index: 1;
    }

    .enhanced-card:hover::before {
      left: 100%;
    }

    .interactive-button {
      position: relative;
      overflow: hidden;
      background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
      background-size: 200% 200%;
      animation: gradientShift 3s ease infinite;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .interactive-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .interactive-button:active {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .particle-effect {
      position: absolute;
      width: 10px;
      height: 10px;
      background: var(--accent-color);
      border-radius: 50%;
      animation: sparkle 1s ease-out forwards;
    }

    .floating-element {
      animation: float 6s ease-in-out infinite;
    }

    .glowing-border {
      border: 2px solid var(--primary-color);
      animation: glow 2s ease-in-out infinite alternate;
    }

    .typewriter-text {
      overflow: hidden;
      border-right: 2px solid var(--primary-color);
      white-space: nowrap;
      margin: 0 auto;
      animation: typewriter 2s steps(40, end), blink 0.75s step-end infinite;
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙˆÙŠØª */
    .candidate-card {
      background: var(--bg-card);
      border: 2px solid var(--primary-color);
      border-radius: var(--radius-lg);
      padding: var(--space-md);
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-normal);
      position: relative;
      overflow: hidden;
      animation: slideInFromLeft 0.6s ease-out;
      background: linear-gradient(135deg, var(--bg-card), #f8f9fa);
    }

    .candidate-card:nth-child(even) {
      animation: slideInFromRight 0.6s ease-out;
    }

    .candidate-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--omani-red), var(--omani-green), var(--omani-gold));
    }

    .candidate-card::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: radial-gradient(circle, rgba(255, 215, 0, 0.3), transparent);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: all 0.6s ease;
      z-index: 0;
    }

    .candidate-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
      border-color: var(--accent-color);
    }

    .candidate-card:hover::after {
      width: 100%;
      height: 100%;
    }

    .candidate-card.selected {
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color: var(--text-light);
      transform: translateY(-10px) scale(1.05);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      animation: bounceIn 0.6s ease, glow 2s ease-in-out infinite alternate;
    }

    .candidate-card.selected::before {
      background: linear-gradient(90deg, #fff, #ffd700, #fff);
      animation: sparkle 1.5s ease infinite;
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…ØµÙˆØªÙŠÙ† */
    .voter-card {
      background: var(--bg-card);
      border: 2px solid var(--secondary-color);
      border-radius: var(--radius-md);
      padding: var(--space-sm);
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-normal);
      font-size: var(--font-size-sm);
      position: relative;
      overflow: hidden;
      animation: bounceIn 0.4s ease;
    }

    .voter-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(34, 139, 34, 0.2), transparent);
      transition: left 0.5s;
    }

    .voter-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      border-color: var(--primary-color);
    }

    .voter-card:hover::before {
      left: 100%;
    }

    .voter-card.voted {
      background: linear-gradient(135deg, var(--secondary-color), var(--success-color));
      color: var(--text-light);
      border-color: var(--secondary-dark);
      animation: pulse 0.6s ease;
    }

    .voter-card.voting {
      animation: countdownPulse 1s ease infinite;
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
    .results-section {
      background: linear-gradient(135deg, var(--bg-card), #f8f9fa);
      border-radius: var(--radius-xl);
      padding: var(--space-xl);
      margin: var(--space-xl) 0;
      border: 2px solid var(--accent-color);
      position: relative;
      overflow: hidden;
      animation: slideInFromLeft 0.8s ease-out;
    }

    .results-section::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: conic-gradient(from 0deg, transparent, rgba(255, 215, 0, 0.1), transparent);
      animation: rotate 4s linear infinite;
      z-index: 0;
    }

    @keyframes rotate {
      100% { transform: rotate(360deg); }
    }

    .results-section > * {
      position: relative;
      z-index: 1;
    }

    .result-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-md);
      margin: var(--space-sm) 0;
      background: linear-gradient(135deg, var(--light-gray), #fff);
      border-radius: var(--radius-lg);
      border-left: 4px solid var(--primary-color);
      transition: all 0.4s ease;
      animation: slideInFromRight 0.6s ease-out;
    }

    .result-item:hover {
      transform: translateX(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .result-item.winner {
      background: linear-gradient(135deg, #ffd700, #fff8dc);
      border-left-color: var(--accent-color);
      animation: pulse 2s infinite, glow 3s ease-in-out infinite alternate;
      position: relative;
    }

    .result-item.winner::after {
      content: 'ğŸ‘‘';
      position: absolute;
      top: -10px;
      right: 10px;
      font-size: 2rem;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-30px); }
      60% { transform: translateY(-15px); }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
    .progress-bar-custom {
      width: 100%;
      height: 12px;
      background: var(--light-gray);
      border-radius: var(--radius-full);
      overflow: hidden;
      margin: var(--space-sm) 0;
      position: relative;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .progress-fill-custom {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color), var(--omani-gold));
      background-size: 200% 100%;
      border-radius: var(--radius-full);
      transition: width 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      animation: progressShine 2s ease infinite;
      position: relative;
    }

    @keyframes progressShine {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    .progress-fill-custom::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: progressGlow 1.5s ease-in-out infinite;
    }

    @keyframes progressGlow {
      0%, 100% { transform: translateX(-100%); }
      50% { transform: translateX(100%); }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø­Ø§Ù„Ø© Ø§Ù„ØªØµÙˆÙŠØª */
    .voting-status {
      text-align: center;
      padding: var(--space-lg);
      margin: var(--space-lg) 0;
      background: linear-gradient(135deg, var(--light-gray), var(--white));
      border-radius: var(--radius-lg);
      border: 2px solid var(--medium-gray);
      position: relative;
      overflow: hidden;
      animation: slideInFromLeft 0.6s ease-out;
    }

    .voting-status::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      animation: progressShine 2s ease infinite;
    }

    .voting-status.active {
      border-color: var(--success-color);
      background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), var(--white));
      animation: glow 2s ease-in-out infinite alternate;
    }

    .voting-status.completed {
      border-color: var(--accent-color);
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), var(--white));
      animation: pulse 1.5s ease-in-out infinite;
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª ØµÙˆØªÙŠØ© Ø¨ØµØ±ÙŠØ© */
    .sound-wave {
      position: relative;
      display: inline-block;
      margin-left: 10px;
    }

    .sound-wave::before,
    .sound-wave::after {
      content: '';
      position: absolute;
      width: 3px;
      height: 15px;
      background: var(--primary-color);
      border-radius: 2px;
      animation: soundWave 1s ease-in-out infinite;
    }

    .sound-wave::before {
      left: -8px;
      animation-delay: 0.2s;
    }

    .sound-wave::after {
      right: -8px;
      animation-delay: 0.4s;
    }

    @keyframes soundWave {
      0%, 100% { height: 5px; }
      50% { height: 15px; }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
    .notification-enhanced {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, var(--success-color), #4caf50);
      color: white;
      padding: var(--space-md) var(--space-lg);
      border-radius: var(--radius-lg);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      transform: translateX(100%);
      transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      z-index: 1000;
      animation: slideInFromRight 0.5s ease-out;
    }

    .notification-enhanced.show {
      transform: translateX(0);
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª */
    .particles-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 999;
    }

    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: var(--accent-color);
      border-radius: 50%;
      animation: particleFloat 3s ease-out forwards;
    }

    @keyframes particleFloat {
      0% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translateY(-200px) scale(0);
      }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© */
    .enhanced-btn {
      position: relative;
      background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
      border: none;
      border-radius: var(--radius-lg);
      color: white;
      padding: var(--space-md) var(--space-xl);
      font-size: var(--font-size-base);
      font-weight: 600;
      cursor: pointer;
      overflow: hidden;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .enhanced-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      transition: left 0.6s;
    }

    .enhanced-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .enhanced-btn:hover::before {
      left: 100%;
    }

    .enhanced-btn:active {
      transform: translateY(-1px);
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù…Ø¹ Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª */
    @media (max-width: 768px) {
      .voting-setup {
        grid-template-columns: 1fr;
      }
      
      .candidates-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }
      
      .voters-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      }
      
      .result-item {
        flex-direction: column;
        gap: var(--space-sm);
        text-align: center;
      }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØµÙˆÙŠØª */
    
    /* Ø´Ø§Ø´Ø§Øª ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ (1200px+) */
    @media (min-width: 1200px) {
      .voting-setup {
        grid-template-columns: repeat(2, 1fr);
        gap: var(--space-xl);
      }

      .candidates-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: var(--space-lg);
      }

      .candidate-card {
        padding: var(--space-lg);
        font-size: var(--font-size-lg);
      }

      .voters-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: var(--space-md);
      }

      .voter-card {
        padding: var(--space-md);
        font-size: var(--font-size-base);
      }
    }

    /* Ø´Ø§Ø´Ø§Øª ÙƒØ¨ÙŠØ±Ø© (1024px - 1199px) */
    @media (max-width: 1199px) and (min-width: 1024px) {
      .voting-setup {
        grid-template-columns: repeat(2, 1fr);
        gap: var(--space-lg);
      }

      .candidates-grid {
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: var(--space-md);
      }

      .voters-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: var(--space-md);
      }
    }

    /* ØªØ§Ø¨Ù„Øª (768px - 1023px) */
    @media (max-width: 1023px) and (min-width: 768px) {
      .voting-setup {
        grid-template-columns: 1fr;
        gap: var(--space-md);
      }

      .candidates-grid {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: var(--space-md);
      }

      .candidate-card {
        padding: var(--space-md);
        font-size: var(--font-size-base);
      }

      .voters-grid {
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
        gap: var(--space-sm);
      }

      .voter-card {
        padding: var(--space-sm);
        font-size: var(--font-size-sm);
      }

      .result-item {
        padding: var(--space-md);
      }

      .candidate-area {
        padding: var(--space-lg);
        min-height: 120px;
      }
    }

    /* Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙƒØ¨ÙŠØ± (480px - 767px) */
    @media (max-width: 767px) and (min-width: 480px) {
      .voting-setup {
        grid-template-columns: 1fr;
        gap: var(--space-sm);
      }

      .candidates-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: var(--space-sm);
      }

      .candidate-card {
        padding: var(--space-sm);
        font-size: var(--font-size-sm);
      }

      .voters-grid {
        grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
        gap: var(--space-sm);
      }

      .voter-card {
        padding: var(--space-xs);
        font-size: var(--font-size-xs);
      }

      .result-item {
        flex-direction: column;
        gap: var(--space-sm);
        text-align: center;
        padding: var(--space-sm);
      }

      .candidate-area {
        padding: var(--space-md);
        min-height: 100px;
      }

      .results-section {
        padding: var(--space-lg);
      }

      .voting-status {
        padding: var(--space-md);
        font-size: var(--font-size-sm);
      }

      .btn-large {
        width: 100%;
        padding: var(--space-md);
        font-size: var(--font-size-base);
      }
    }

    /* Ù…ÙˆØ¨Ø§ÙŠÙ„ ØµØºÙŠØ± (320px - 479px) */
    @media (max-width: 479px) {
      .voting-setup {
        gap: var(--space-xs);
      }

      .candidates-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: var(--space-xs);
      }

      .candidate-card {
        padding: var(--space-xs);
        font-size: var(--font-size-xs);
      }

      .voters-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: var(--space-xs);
      }

      .voter-card {
        padding: var(--space-xs);
        font-size: var(--font-size-xs);
      }

      .result-item {
        padding: var(--space-xs);
        font-size: var(--font-size-xs);
      }

      .candidate-area {
        padding: var(--space-sm);
        min-height: 80px;
      }

      .results-section {
        padding: var(--space-md);
      }

      .voting-status {
        padding: var(--space-sm);
        font-size: var(--font-size-xs);
      }

      .btn-large {
        width: 100%;
        padding: var(--space-sm);
        font-size: var(--font-size-sm);
      }

      .vote-count {
        font-size: var(--font-size-xs);
        padding: var(--space-xs);
        min-width: 30px;
      }

      .progress-bar-custom {
        height: 6px;
      }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø®Ø§ØµØ© Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„Ù…Ø³ÙŠØ© */
    @media (hover: none) and (pointer: coarse) {
      .candidate-card {
        min-height: 60px;
        border-width: 3px;
      }

      .candidate-card:hover {
        transform: none;
      }

      .candidate-card:active {
        transform: scale(0.98);
      }

      .voter-card {
        min-height: 48px;
        border-width: 2px;
      }

      .voter-card:hover {
        transform: none;
      }

      .voter-card:active {
        transform: scale(0.98);
      }

      .btn {
        min-height: 48px;
        border-width: 2px;
      }

      .form-select {
        min-height: 48px;
        border-width: 2px;
      }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ‚ÙŠ ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    @media screen and (max-height: 500px) and (orientation: landscape) {
      .candidate-area {
        min-height: 60px;
        padding: var(--space-sm);
      }

      .voting-status {
        padding: var(--space-sm);
      }

      .results-section {
        padding: var(--space-md);
      }

      .candidates-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: var(--space-xs);
      }

      .voters-grid {
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        gap: var(--space-xs);
      }

      .candidate-card,
      .voter-card {
        padding: var(--space-xs);
        font-size: var(--font-size-xs);
      }

      .btn-large {
        padding: var(--space-xs) var(--space-sm);
        font-size: var(--font-size-sm);
      }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„ÙƒØ«Ø§ÙØ© */
    @media (-webkit-min-device-pixel-ratio: 2),
           (min-resolution: 192dpi) {
      .candidate-card {
        border-width: 1.5px;
      }

      .voter-card {
        border-width: 1.5px;
      }

      .candidate-card::before {
        height: 3px;
      }

      .result-item {
        border-left-width: 3px;
      }
    }

    /* RTL layout optimizations for responsive design */
    [dir="rtl"] .voting-setup {
      direction: rtl;
    }

    [dir="rtl"] .candidates-grid {
      direction: rtl;
    }

    [dir="rtl"] .voters-grid {
      direction: rtl;
    }

    @media (max-width: 767px) {
      [dir="rtl"] .result-item {
        direction: ltr;
      }
    }
  </style>
</head>
<body class="responsive-body touch-device">
  <!-- Skip link for accessibility -->
  <a href="#main-content" class="sr-only">ØªØ®Ø·ÙŠ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</a>
  
  <!-- Audio elements - Ù…Ø­Ù„ÙŠØ© -->
  <audio id="clickSound" src="../assets/media/sounds/Click.mp3"></audio>
  <audio id="successSound" src="../assets/media/sounds/win.mp3"></audio>
  <audio id="errorSound" src="../assets/media/sounds/wrong_answer.mp3"></audio>
  <audio id="notificationSound" src="../assets/media/sounds/Notification.mp3"></audio>
  <audio id="backgroundMusic" src="../assets/media/sounds/kingdom-sounds/adventure-theme.mp3" loop></audio>
  <audio id="countdownSound" src="../assets/media/sounds/countdown-beep.mp3"></audio>
  <audio id="voteConfirmSound" src="../assets/media/sounds/kingdom-sounds/crystal-ping.mp3"></audio>
  <audio id="resultsRevealSound" src="../assets/media/sounds/kingdom-sounds/cosmic-explosion.mp3"></audio>

  <!-- Main container -->
  <div class="container responsive-container">
    <!-- Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="back-to-main">
      <a href="../main.html" class="back-btn" title="Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø£Ù†Ø´Ø·Ø©">
        <span class="back-icon">ğŸ </span>
        <span class="back-text">Ø§Ù„Ø£Ù†Ø´Ø·Ø©</span>
      </a>
    </div>

    <!-- Header -->
    <header class="header mobile-header">
      <h1 class="mobile-heading">âœ‹ğŸ—³ï¸ ØµÙˆÙ‘Øª ÙˆÙ‚Ø±Ø±</h1>
      <p class="mobile-subtitle">Ø§Ø®ØªØ± Ø§Ù„ØµÙ ÙˆÙ†ÙˆØ¹ Ø§Ù„ØªØµÙˆÙŠØªØŒ Ø«Ù… Ø±Ø´Ù‘Ø­ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</p>
    </header>

    <!-- Main content -->
    <main id="main-content">
      <!-- Voting setup -->
      <div class="card mobile-card">
        <h3 class="mobile-heading">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØµÙˆÙŠØª</h3>
        <div class="voting-setup mobile-grid">
          <div class="form-group mobile-input">
            <label class="form-label mobile-label">Ø§Ø®ØªØ± Ø§Ù„ØµÙ:</label>
            <select id="classSelect" class="form-select touch-target">
              <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ØµÙ --</option>
            </select>
          </div>
          <div class="form-group mobile-input">
            <label class="form-label mobile-label">Ù†ÙˆØ¹ Ø§Ù„ØªØµÙˆÙŠØª:</label>
            <select id="voteMode" class="form-select touch-target">
              <option value="">-- Ù†ÙˆØ¹ Ø§Ù„ØªØµÙˆÙŠØª --</option>
              <option value="single">ÙØ±Ø¯ÙŠ Ø¹Ø´ÙˆØ§Ø¦ÙŠ âš¡</option>
              <option value="group">Ø¬Ù…Ø§Ø¹ÙŠ Ø¹Ø´ÙˆØ§Ø¦ÙŠ ğŸ‘¥</option>
              <option value="select-single">ÙØ±Ø¯ÙŠ Ø§Ù†ØªÙ‚Ø§Ø¦ÙŠ ğŸ¯</option>
              <option value="select-group">Ø¬Ù…Ø§Ø¹ÙŠ Ø§Ù†ØªÙ‚Ø§Ø¦ÙŠ ğŸ¯ğŸ‘¥</option>
            </select>
          </div>
        </div>
        <div class="text-center">
          <button id="startNominateBtn" class="btn btn-primary btn-large touch-target mobile-btn" disabled>ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ±Ø´ÙŠØ­</button>
        </div>
      </div>

      <!-- Candidates area -->
      <div id="candidateArea" class="card mobile-card" style="display:none">
        <h3 class="mobile-heading">ğŸ”· Ø§Ù„Ù…Ø±Ø´Ø­ÙˆÙ†</h3>
        <div class="candidate-area mobile-card">
          <div id="candidatesDisplay" class="mobile-text">
            <p>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¯Ù†Ø§Ù‡</p>
          </div>
        </div>
        <div class="candidates-grid mobile-grid" id="candidatesGrid"></div>
        <div class="text-center">
          <button id="confirmCandidatesBtn" class="btn btn-secondary btn-large touch-target mobile-btn" disabled>âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ†</button>
        </div>
      </div>

      <!-- Voters area -->
      <div id="votersArea" class="card mobile-card" style="display:none">
        <h3 class="mobile-heading">ğŸ§‘â€ğŸ“ Ø§Ù„Ù…ØµÙˆÙ‘ØªÙˆÙ†</h3>
        <div class="voting-status mobile-notification" id="votingStatus">
          <p class="mobile-text">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø«Ù… Ø§Ø®ØªØ± Ù…Ù† ÙŠØ±ÙŠØ¯ Ø§Ù„ØªØµÙˆÙŠØª Ù„Ù‡</p>
        </div>
        <div class="voters-grid mobile-grid" id="votersContainer"></div>
        <div class="text-center">
          <button id="showResultsBtn" class="btn btn-accent btn-large touch-target mobile-btn" disabled>ğŸ“Š ÙØ±Ø² Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
        </div>
      </div>

      <!-- Results area -->
      <div id="resultsArea" class="results-section mobile-card" style="display:none">
        <h2 class="mobile-heading typewriter-text">ğŸ† Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h2>
        <div class="chart-container" style="position: relative; height: 400px; margin: 20px 0;">
          <canvas id="resultsChart" class="mobile-chart"></canvas>
        </div>
        <div class="celebration-message" style="text-align: center; margin: 20px 0; font-size: 1.2em; color: var(--primary-color);">
          <div class="sound-wave">ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ Ù„Ù„ÙØ§Ø¦Ø²ÙŠÙ†! ğŸŠ</div>
        </div>
        <div class="action-buttons" style="text-align: center; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
          <button onclick="location.reload()" class="btn btn-primary enhanced-btn touch-target mobile-btn">
            ğŸ”„ Ø¨Ø¯Ø¡ ØªØµÙˆÙŠØª Ø¬Ø¯ÙŠØ¯
          </button>
          <button onclick="printResults()" class="btn btn-secondary enhanced-btn touch-target mobile-btn">
            ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
          </button>
          <button onclick="shareResults()" class="btn btn-accent enhanced-btn touch-target mobile-btn">
            ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
          </button>
        </div>
      </div>
    </main>
  </div>

  <!-- Ù…Ø¤Ø«Ø±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© -->
  <div id="fireworks-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999;"></div>
  
  <audio id="clapSound" src="../assets/media/sounds/clap.mp3"></audio>
  
  <script>
    // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ø­Ø³Ù†Ø©
    
    // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    function printResults() {
      const printWindow = window.open('', '_blank');
      const resultsHTML = generatePrintableResults();
      
      printWindow.document.write(`
        <!DOCTYPE html>
        <html dir="rtl" lang="ar">
        <head>
          <meta charset="UTF-8">
          <title>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµÙˆÙŠØª - ${currentClass}</title>
          <style>
            body { font-family: 'Cairo', Arial, sans-serif; direction: rtl; margin: 20px; }
            .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 20px; }
            .result-item { margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
            .winner { background-color: #fff3cd; border-color: #ffeaa7; }
            .stats { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; }
            @media print { button { display: none; } }
          </style>
        </head>
        <body>
          ${resultsHTML}
          <button onclick="window.print()" style="margin: 20px auto; display: block; padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">Ø·Ø¨Ø§Ø¹Ø©</button>
        </body>
        </html>
      `);
      
      printWindow.document.close();
      smartAudio.play('Click.mp3');
      notifications.show('ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ğŸ–¨ï¸', 'info');
    }

    // ØªÙˆÙ„ÙŠØ¯ HTML Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©
    function generatePrintableResults() {
      const labels = Object.keys(voteCounts);
      const data = Object.values(voteCounts);
      const totalVotes = data.reduce((a, b) => a + b, 0);
      const maxVotes = Math.max(...data);
      const winners = labels.filter((name, i) => data[i] === maxVotes);
      
      const sortedResults = labels.map((name, index) => ({
        name,
        votes: data[index],
        percentage: ((data[index] / totalVotes) * 100).toFixed(1)
      })).sort((a, b) => b.votes - a.votes);

      const currentDate = new Date().toLocaleDateString('ar-SA');
      const currentTime = new Date().toLocaleTimeString('ar-SA');

      return `
        <div class="header">
          <h1>ğŸ—³ï¸ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµÙˆÙŠØª - Ø§Ù„ØµÙ ${currentClass}</h1>
          <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${currentDate} | Ø§Ù„ÙˆÙ‚Øª: ${currentTime}</p>
          <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†: ${voterList.length} | Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆØ§Øª: ${totalVotes}</p>
        </div>
        
        <h2>ğŸ† Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h2>
        ${sortedResults.map((result, index) => {
          const isWinner = winners.includes(result.name);
          return `
            <div class="result-item ${isWinner ? 'winner' : ''}">
              <strong>${isWinner ? 'ğŸ†' : index + 1}. ${result.name}</strong><br>
              Ø§Ù„Ø£ØµÙˆØ§Øª: ${result.votes} (${result.percentage}%)<br>
              Ø§Ù„Ø­Ø§Ù„Ø©: ${isWinner ? 'ğŸ‰ ÙØ§Ø¦Ø²' : 'Ù…Ø´Ø§Ø±Ùƒ'}
            </div>
          `;
        }).join('')}
        
        <div class="stats">
          <h3>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØµÙˆÙŠØª:</h3>
          <p><strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©:</strong> ${((totalVotes / voterList.length) * 100).toFixed(1)}%</p>
          <p><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ†:</strong> ${candidateList.length}</p>
          <p><strong>Ø§Ù„ÙØ§Ø¦Ø²/Ø§Ù„ÙØ§Ø¦Ø²ÙˆÙ†:</strong> ${winners.join(', ')}</p>
          <p><strong>Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©:</strong> ${maxVotes} ${maxVotes === 1 ? 'ØµÙˆØª' : 'Ø£ØµÙˆØ§Øª'}</p>
        </div>
      `;
    }

    // Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    async function shareResults() {
      const shareText = generateShareText();
      
      if (navigator.share) {
        try {
          await navigator.share({
            title: `Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµÙˆÙŠØª - Ø§Ù„ØµÙ ${currentClass}`,
            text: shareText,
            url: window.location.href
          });
          notifications.show('ØªÙ… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ù†Ø¬Ø§Ø­! ğŸ“¤', 'success');
        } catch (error) {
          copyToClipboard(shareText);
        }
      } else {
        copyToClipboard(shareText);
      }
      
      smartAudio.play('Notification.mp3');
    }

    // ØªÙˆÙ„ÙŠØ¯ Ù†Øµ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©
    function generateShareText() {
      const labels = Object.keys(voteCounts);
      const data = Object.values(voteCounts);
      const maxVotes = Math.max(...data);
      const winners = labels.filter((name, i) => data[i] === maxVotes);
      
      return `
ğŸ—³ï¸ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµÙˆÙŠØª - Ø§Ù„ØµÙ ${currentClass}

ğŸ† Ø§Ù„ÙØ§Ø¦Ø²: ${winners.join(', ')} Ø¨Ù€ ${maxVotes} ${maxVotes === 1 ? 'ØµÙˆØª' : 'Ø£ØµÙˆØ§Øª'}

ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©:
${labels.map((name, i) => `â€¢ ${name}: ${data[i]} ${data[i] === 1 ? 'ØµÙˆØª' : 'Ø£ØµÙˆØ§Øª'}`).join('\n')}

ğŸ“ˆ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†: ${voterList.length}
ğŸ“… ${new Date().toLocaleDateString('ar-SA')}

#Ø§Ù„ØªØµÙˆÙŠØª_Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ #Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª_Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©
      `.trim();
    }

    // Ù†Ø³Ø® Ù„Ù„Ø­Ø§ÙØ¸Ø©
    function copyToClipboard(text) {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
          notifications.show('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø­Ø§ÙØ¸Ø©! ğŸ“‹', 'success');
        }).catch(() => {
          fallbackCopyTextToClipboard(text);
        });
      } else {
        fallbackCopyTextToClipboard(text);
      }
    }

    // Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ
    function fallbackCopyTextToClipboard(text) {
      const textArea = document.createElement("textarea");
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();
      
      try {
        document.execCommand('copy');
        notifications.show('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø­Ø§ÙØ¸Ø©! ğŸ“‹', 'success');
      } catch (err) {
        notifications.show('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ù†ØªØ§Ø¦Ø¬', 'error');
      }
      
      document.body.removeChild(textArea);
    }

    // Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ù†Ø§Ø±ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
    function createFireworks() {
      const container = document.getElementById('fireworks-container');
      
      for (let i = 0; i < 5; i++) {
        setTimeout(() => {
          const firework = document.createElement('div');
          firework.style.cssText = `
            position: absolute;
            left: ${Math.random() * 100}%;
            top: ${Math.random() * 100}%;
            width: 4px;
            height: 4px;
            background: ${visualEffects.getRandomColor()};
            border-radius: 50%;
            animation: fireworkExplosion 2s ease-out forwards;
          `;
          
          container.appendChild(firework);
          
          // Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø±Ø§Ø±Ø§Øª
          for (let j = 0; j < 20; j++) {
            setTimeout(() => {
              const spark = document.createElement('div');
              const angle = (j * 18) * Math.PI / 180;
              const distance = Math.random() * 100 + 50;
              
              spark.style.cssText = `
                position: absolute;
                left: ${firework.offsetLeft}px;
                top: ${firework.offsetTop}px;
                width: 2px;
                height: 2px;
                background: ${visualEffects.getRandomColor()};
                border-radius: 50%;
                animation: sparkFly 1.5s ease-out forwards;
                transform: translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px);
              `;
              
              container.appendChild(spark);
              
              setTimeout(() => {
                if (spark.parentNode) {
                  spark.parentNode.removeChild(spark);
                }
              }, 1500);
            }, j * 50);
          }
          
          setTimeout(() => {
            if (firework.parentNode) {
              firework.parentNode.removeChild(firework);
            }
          }, 2000);
        }, i * 500);
      }
    }

    // Ø¥Ø¶Ø§ÙØ© CSS Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ù†Ø§Ø±ÙŠØ©
    const fireworksCSS = `
      @keyframes fireworkExplosion {
        0% { transform: scale(0); opacity: 1; }
        50% { transform: scale(1); opacity: 1; }
        100% { transform: scale(1.5); opacity: 0; }
      }
      
      @keyframes sparkFly {
        0% { opacity: 1; transform: scale(1); }
        100% { opacity: 0; transform: scale(0); }
      }
    `;
    
    const styleSheet = document.createElement('style');
    styleSheet.textContent = fireworksCSS;
    document.head.appendChild(styleSheet);

    // ØªØ­Ø³ÙŠÙ† Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ©
    function playContextualSound(action) {
      const soundMap = {
        'vote_cast': 'kingdom-sounds/crystal-ping.mp3',
        'candidate_selected': 'Click.mp3',
        'voting_complete': 'kingdom-sounds/cosmic-explosion.mp3',
        'winner_announced': 'kingdom-sounds/crown-ceremony.mp3',
        'celebration': 'kingdom-sounds/battle-victory.mp3',
        'error': 'wrong_answer.mp3',
        'notification': 'Notification.mp3'
      };
      
      const sound = soundMap[action];
      if (sound) {
        smartAudio.play(sound);
      }
    }

    // Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·
    class VotingAnalytics {
      constructor() {
        this.startTime = Date.now();
        this.events = [];
      }

      logEvent(eventType, data = {}) {
        this.events.push({
          type: eventType,
          timestamp: Date.now(),
          data: data
        });
      }

      generateReport() {
        const duration = Date.now() - this.startTime;
        const minutes = Math.floor(duration / 60000);
        const seconds = Math.floor((duration % 60000) / 1000);
        
        return {
          duration: `${minutes}:${seconds.toString().padStart(2, '0')}`,
          totalEvents: this.events.length,
          events: this.events
        };
      }
    }

    // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª
    const analytics = new VotingAnalytics();

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
    const originalStartVotingSetup = startVotingSetup;
    startVotingSetup = function() {
      analytics.logEvent('voting_setup_started', { 
        class: currentClass, 
        mode: document.getElementById("voteMode").value 
      });
      return originalStartVotingSetup.apply(this, arguments);
    };

    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ù‚Øª Ù„Ù„Ù†Ø´Ø§Ø·
    let activityTimer = {
      startTime: null,
      element: null,
      interval: null,
      
      start() {
        this.startTime = Date.now();
        this.element = document.createElement('div');
        this.element.style.cssText = `
          position: fixed;
          top: 70px;
          left: 20px;
          background: rgba(0, 0, 0, 0.8);
          color: white;
          padding: 8px 16px;
          border-radius: 20px;
          font-family: monospace;
          font-size: 14px;
          z-index: 1000;
        `;
        document.body.appendChild(this.element);
        
        this.interval = setInterval(() => this.update(), 1000);
      },
      
      update() {
        if (!this.startTime) return;
        
        const elapsed = Date.now() - this.startTime;
        const minutes = Math.floor(elapsed / 60000);
        const seconds = Math.floor((elapsed % 60000) / 1000);
        
        this.element.textContent = `â±ï¸ ${minutes}:${seconds.toString().padStart(2, '0')}`;
      },
      
      stop() {
        if (this.interval) {
          clearInterval(this.interval);
        }
        if (this.element && this.element.parentNode) {
          this.element.parentNode.removeChild(this.element);
        }
        this.startTime = null;
      }
    };

    // ØªØ­Ø¯ÙŠØ« ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù„ØªØ´Ù…Ù„ Ø§Ù„Ù…Ø¤Ù‚Øª
    const originalLoadStudents = loadStudents;
    loadStudents = async function() {
      await originalLoadStudents.apply(this, arguments);
      activityTimer.start();
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti"></script>
  
  <!-- Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ÙˆØ­Ø¯ Ù…Ø¯Ù…Ø¬ -->
  <script>
    // ActivityUtils Ù…Ø¯Ù…Ø¬
    class ActivityUtils {
      constructor(activityName, soundPath) {
        this.activityName = activityName;
        this.soundPath = soundPath || '../assets/media/sounds/';
        this.sounds = new Map();
        this.notifications = [];
      }

      init() {
        console.log(`ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ù†Ø´Ø§Ø·: ${this.activityName}`);
        this.preloadCommonSounds();
      }

      preloadCommonSounds() {
        const commonSounds = [
          'Click.mp3', 'win.mp3', 'wrong_answer.mp3', 'Notification.mp3',
          'clap.mp3', 'select.mp3', 'start-timer.mp3', 'end-timer.mp3'
        ];
        
        commonSounds.forEach(sound => {
          const audio = new Audio(this.soundPath + sound);
          audio.preload = 'auto';
          this.sounds.set(sound, audio);
        });
      }

      playSound(soundName, options = {}) {
        const sound = this.sounds.get(soundName);
        if (sound) {
          sound.currentTime = 0;
          sound.volume = options.volume || 0.7;
          sound.play().catch(e => console.log('Audio play failed:', e));
        }
      }

      showNotification(message, type = 'info', duration = 4000) {
        // Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø³Ù†
        if (window.notifications) {
          window.notifications.show(message, type, duration);
        } else {
          console.log(`${type}: ${message}`);
        }
      }

      showModal(title, message, isConfirm = false) {
        if (isConfirm) {
          return confirm(`${title}\n\n${message}`);
        } else {
          alert(`${title}\n\n${message}`);
          return false;
        }
      }
    }
  </script>
  
  <!-- Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª -->
  <div class="particles-container" id="particlesContainer"></div>
  
  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø­Ø³Ù† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ActivityUtils
    const activity = new ActivityUtils('Ù†Ø´Ø§Ø· Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ù…Ø­Ø³Ù†', '../assets/media/sounds/');
    
    // Ù†Ø¸Ø§Ù… ØµÙˆØªÙŠ Ø°ÙƒÙŠ Ù…Ø­Ø³Ù†
    class SmartAudioSystem {
      constructor() {
        this.audioContext = null;
        this.gainNode = null;
        this.sounds = new Map();
        this.backgroundMusic = null;
        this.isMuted = false;
        this.volume = 0.7;
        this.init();
      }

      async init() {
        try {
          this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
          this.gainNode = this.audioContext.createGain();
          this.gainNode.connect(this.audioContext.destination);
          this.gainNode.gain.value = this.volume;
          
          // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚
          await this.preloadSounds();
        } catch (error) {
          console.warn('Audio context not supported:', error);
        }
      }

      async preloadSounds() {
        const soundFiles = [
          'Click.mp3', 'win.mp3', 'wrong_answer.mp3', 'Notification.mp3',
          'countdown-beep.mp3', 'clap.mp3', 'select.mp3', 'start-timer.mp3', 'end-timer.mp3'
        ];

        for (const sound of soundFiles) {
          try {
            const audio = new Audio(`../assets/media/sounds/${sound}`);
            audio.preload = 'auto';
            this.sounds.set(sound, audio);
          } catch (error) {
            console.warn(`Failed to load sound: ${sound}`, error);
          }
        }
      }

      play(soundName, options = {}) {
        if (this.isMuted) return;

        const sound = this.sounds.get(soundName);
        if (sound) {
          sound.currentTime = 0;
          sound.volume = (options.volume || 1) * this.volume;
          
          if (options.fade) {
            this.fadeIn(sound, options.fade);
          }
          
          sound.play().catch(error => console.warn('Audio play failed:', error));
          
          if (options.delay) {
            setTimeout(() => sound.pause(), options.delay);
          }
        }
      }

      fadeIn(audio, duration) {
        audio.volume = 0;
        const targetVolume = this.volume;
        const steps = 20;
        const stepTime = duration / steps;
        const volumeStep = targetVolume / steps;

        let currentStep = 0;
        const fadeInterval = setInterval(() => {
          if (currentStep >= steps) {
            clearInterval(fadeInterval);
            audio.volume = targetVolume;
          } else {
            audio.volume = volumeStep * currentStep;
            currentStep++;
          }
        }, stepTime);
      }

      playSequence(sounds, delay = 500) {
        sounds.forEach((sound, index) => {
          setTimeout(() => this.play(sound), index * delay);
        });
      }

      setVolume(volume) {
        this.volume = Math.max(0, Math.min(1, volume));
        if (this.gainNode) {
          this.gainNode.gain.value = this.volume;
        }
      }

      mute() {
        this.isMuted = true;
        if (this.backgroundMusic) {
          this.backgroundMusic.pause();
        }
      }

      unmute() {
        this.isMuted = false;
        if (this.backgroundMusic) {
          this.backgroundMusic.play();
        }
      }

      playBackgroundMusic() {
        // Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø®Ù„ÙÙŠØ© Ø¨Ø³ÙŠØ·Ø©
        if (this.isMuted) return;
        console.log('Background music would play here');
      }

      stopBackgroundMusic() {
        if (this.backgroundMusic) {
          this.backgroundMusic.pause();
          this.backgroundMusic.currentTime = 0;
        }
      }
    }

    // Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
    class AdvancedVisualEffects {
      constructor() {
        this.particlesContainer = document.getElementById('particlesContainer');
        this.activeAnimations = new Set();
      }

      createParticleExplosion(element, count = 20) {
        const rect = element.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;

        for (let i = 0; i < count; i++) {
          this.createParticle(centerX, centerY);
        }
      }

      createParticle(x, y) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = x + 'px';
        particle.style.top = y + 'px';
        particle.style.background = this.getRandomColor();
        
        const angle = Math.random() * 360;
        const velocity = Math.random() * 100 + 50;
        const life = Math.random() * 2000 + 1000;

        particle.style.transform = `translate(${Math.cos(angle) * velocity}px, ${Math.sin(angle) * velocity}px)`;
        
        this.particlesContainer.appendChild(particle);

        setTimeout(() => {
          if (particle.parentNode) {
            particle.parentNode.removeChild(particle);
          }
        }, life);
      }

      getRandomColor() {
        const colors = ['#FFD700', '#DC143C', '#228B22', '#FF6B6B', '#4ECDC4'];
        return colors[Math.floor(Math.random() * colors.length)];
      }

      animateCounter(element, start, end, duration = 1000) {
        let startTime = null;
        
        const animate = (currentTime) => {
          if (!startTime) startTime = currentTime;
          const progress = Math.min((currentTime - startTime) / duration, 1);
          
          const value = Math.floor(start + (end - start) * this.easeOutQuart(progress));
          element.textContent = value;
          
          if (progress < 1) {
            requestAnimationFrame(animate);
          }
        };
        
        requestAnimationFrame(animate);
      }

      easeOutQuart(t) {
        return 1 - (--t) * t * t * t;
      }

      typewriterEffect(element, text, speed = 50) {
        element.textContent = '';
        element.style.borderRight = '2px solid var(--primary-color)';
        
        let i = 0;
        const timer = setInterval(() => {
          if (i < text.length) {
            element.textContent += text.charAt(i);
            i++;
          } else {
            clearInterval(timer);
            setTimeout(() => {
              element.style.borderRight = 'none';
            }, 500);
          }
        }, speed);
      }

      slideInElements(elements, delay = 100) {
        elements.forEach((element, index) => {
          element.style.opacity = '0';
          element.style.transform = 'translateY(30px)';
          
          setTimeout(() => {
            element.style.transition = 'all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            element.style.opacity = '1';
            element.style.transform = 'translateY(0)';
          }, index * delay);
        });
      }

      glowEffect(element, duration = 2000) {
        element.classList.add('glowing-border');
        setTimeout(() => {
          element.classList.remove('glowing-border');
        }, duration);
      }

      confettiBlast(options = {}) {
        const defaults = {
          particleCount: 150,
          spread: 120,
          origin: { y: 0.6 },
          colors: ['#FFD700', '#DC143C', '#228B22', '#FF6B6B', '#4ECDC4'],
          shapes: ['square', 'circle'],
          gravity: 0.8,
          drift: 0.1
        };

        confetti({ ...defaults, ...options });

        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¥Ø¶Ø§ÙÙŠ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
        setTimeout(() => {
          confetti({
            ...defaults,
            ...options,
            particleCount: 50,
            spread: 60
          });
        }, 1000);
      }

      chartRevealAnimation(chart) {
        const originalDraw = chart.draw;
        chart.draw = function() {
          const ctx = chart.ctx;
          ctx.save();
          ctx.globalCompositeOperation = 'source-over';
          originalDraw.apply(this, arguments);
          ctx.restore();
        };
      }
    }

    // Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†
    class EnhancedNotificationSystem {
      constructor() {
        this.notifications = [];
        this.container = this.createContainer();
      }

      createContainer() {
        const container = document.createElement('div');
        container.id = 'notifications-container';
        container.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 10000;
          max-width: 400px;
        `;
        document.body.appendChild(container);
        return container;
      }

      show(message, type = 'info', duration = 4000, options = {}) {
        const notification = this.createNotification(message, type, options);
        this.container.appendChild(notification);
        
        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¯Ø®ÙˆÙ„
        requestAnimationFrame(() => {
          notification.style.transform = 'translateX(0)';
          notification.style.opacity = '1';
        });

        // Ø¥Ø²Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
        setTimeout(() => {
          this.remove(notification);
        }, duration);

        return notification;
      }

      createNotification(message, type, options) {
        const notification = document.createElement('div');
        notification.className = `notification-enhanced notification-${type}`;
        
        const colors = {
          success: '#4CAF50',
          error: '#f44336',
          warning: '#ff9800',
          info: '#2196F3'
        };

        const icons = {
          success: 'âœ…',
          error: 'âŒ',
          warning: 'âš ï¸',
          info: 'â„¹ï¸'
        };

        notification.style.cssText = `
          background: linear-gradient(135deg, ${colors[type]}, ${colors[type]}dd);
          color: white;
          padding: 16px 20px;
          margin-bottom: 10px;
          border-radius: 12px;
          box-shadow: 0 8px 25px rgba(0,0,0,0.2);
          transform: translateX(100%);
          opacity: 0;
          transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
          display: flex;
          align-items: center;
          gap: 12px;
          font-weight: 500;
          position: relative;
          overflow: hidden;
        `;

        notification.innerHTML = `
          <span style="font-size: 1.2em;">${icons[type]}</span>
          <span>${message}</span>
          <button onclick="this.parentElement.remove()" style="
            background: none;
            border: none;
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            margin-left: auto;
          ">Ã—</button>
        `;

        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…ÙˆØ¬Ø©
        const wave = document.createElement('div');
        wave.style.cssText = `
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
          transition: left 0.6s;
        `;
        notification.appendChild(wave);

        setTimeout(() => {
          wave.style.left = '100%';
        }, 500);

        return notification;
      }

      remove(notification) {
        notification.style.transform = 'translateX(100%)';
        notification.style.opacity = '0';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 500);
      }
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø©
    const smartAudio = new SmartAudioSystem();
    const visualEffects = new AdvancedVisualEffects();
    const notifications = new EnhancedNotificationSystem();
    
    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ù…Ø­Ø³Ù†Ø©
    let studentData = {}, currentClass = '', candidateList = [], voterList = [], selectedManual = [], voteCounts = {}, voted = new Set();
    let votingTimer = null, votingTimeLeft = 0;

    // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª - Ù…Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­Ù„ÙŠ
    async function loadStudents() {
      try {
        // ØªØ£Ø«ÙŠØ± Ø§Ù„ØªØ­Ù…ÙŠÙ„
        const loadingMsg = notifications.show('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨...', 'info', 10000);
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­Ù„ÙŠ
        const res = await fetch('../data/studentData.json');
        if (!res.ok) {
          throw new Error('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        }
        studentData = await res.json();
        
        const classSelect = document.getElementById("classSelect");
        classSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„ØµÙ --</option>';
        
        Object.keys(studentData).forEach((cls, index) => {
          const option = document.createElement("option");
          option.value = cls;
          option.textContent = `Ø§Ù„ØµÙ ${cls}`;
          classSelect.appendChild(option);
          
          // ØªØ£Ø«ÙŠØ± Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠ
          setTimeout(() => {
            option.style.animation = 'slideInFromLeft 0.3s ease-out';
          }, index * 100);
        });

        notifications.remove(loadingMsg);
        smartAudio.play('Notification.mp3');
        notifications.show('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ğŸ“', 'success');
        
        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø®Ù„ÙÙŠØ©
        setTimeout(() => {
          smartAudio.playBackgroundMusic();
        }, 1000);
        
      } catch (error) {
        notifications.show('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨: ' + error.message, 'error');
        smartAudio.play('wrong_answer.mp3');
        
        // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        studentData = {
          "7A": ["Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯", "ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ", "Ø³Ø§Ù„Ù… Ø®Ø§Ù„Ø¯", "Ù…Ø±ÙŠÙ… Ø³Ø¹ÙŠØ¯", "ÙŠÙˆØ³Ù Ø­Ù…Ø¯"],
          "7B": ["Ù†ÙˆØ±Ø§ Ø£Ø­Ù…Ø¯", "Ù…Ø­Ù…Ø¯ Ø³Ø§Ù„Ù…", "Ø¢Ù…Ù†Ø© ÙŠÙˆØ³Ù", "Ø®Ø§Ù„Ø¯ Ù…Ø­Ù…Ø¯", "Ù‡Ù†Ø§Ø¡ Ø¹Ù„ÙŠ"],
          "8A": ["Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø³Ø¹ÙŠØ¯", "Ø²ÙŠÙ†Ø¨ Ù…Ø­Ù…Ø¯", "Ø·Ø§Ø±Ù‚ Ø£Ø­Ù…Ø¯", "Ø±Ù‚ÙŠØ© Ø³Ø§Ù„Ù…", "Ø­Ù…Ø¯ Ø¹Ù„ÙŠ"],
          "8B": ["Ø³Ø¹Ø§Ø¯ Ø®Ø§Ù„Ø¯", "Ø¹Ù…Ø± Ù…Ø­Ù…Ø¯", "Ù„ÙŠÙ„Ù‰ Ø£Ø­Ù…Ø¯", "Ù†Ø§ØµØ± Ø³Ø¹ÙŠØ¯", "Ø¹Ø§Ø¦Ø´Ø© Ø­Ù…Ø¯"]
        };
        
        const classSelect = document.getElementById("classSelect");
        classSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„ØµÙ --</option>';
        
        Object.keys(studentData).forEach((cls) => {
          const option = document.createElement("option");
          option.value = cls;
          option.textContent = `Ø§Ù„ØµÙ ${cls}`;
          classSelect.appendChild(option);
        });
        
        notifications.show('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø£ØµÙ„ÙŠ', 'warning');
      }
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ù…Ø­Ø³Ù†
    function startVotingSetup() {
      currentClass = document.getElementById("classSelect").value;
      const mode = document.getElementById("voteMode").value;
      
      if (!currentClass || !mode) {
        smartAudio.play('wrong_answer.mp3');
        notifications.show('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ ÙˆÙ†ÙˆØ¹ Ø§Ù„ØªØµÙˆÙŠØª Ø£ÙˆÙ„Ø§Ù‹', 'warning');
        return;
      }

      const fullList = [...studentData[currentClass]];
      selectedManual = [];

      smartAudio.play('kingdom-sounds/crystal-ping.mp3');
      
      // ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
      const setupCard = document.querySelector('.voting-setup');
      visualEffects.glowEffect(setupCard);

      if (mode === 'single') {
        const index = Math.floor(Math.random() * fullList.length);
        candidateList = [fullList.splice(index, 1)[0]];
        voterList = fullList;
        
        // ØªØ£Ø«ÙŠØ± Ø§Ù„ÙƒØ´Ù Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠ
        setTimeout(() => {
          renderVotingUI();
          notifications.show(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${candidateList[0]} ÙƒÙ…Ø±Ø´Ø­ ÙˆØ§Ø­Ø¯ ğŸ¯`, 'success');
        }, 500);
        
      } else if (mode === 'group') {
        const shuffled = fullList.sort(() => 0.5 - Math.random());
        candidateList = shuffled.slice(0, 3);
        voterList = shuffled.slice(3);
        
        setTimeout(() => {
          renderVotingUI();
          notifications.show(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${candidateList.length} Ù…Ø±Ø´Ø­ÙŠÙ† Ø¹Ø´ÙˆØ§Ø¦ÙŠØ§Ù‹ ğŸ‘¥`, 'success');
        }, 500);
        
      } else {
        renderManualSelection(fullList, mode);
        notifications.show('Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ğŸ¯', 'info');
      }
    }

    // Ø¹Ø±Ø¶ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙŠØ¯ÙˆÙŠ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
    function renderManualSelection(fullList, mode) {
      const candidateArea = document.getElementById("candidateArea");
      const candidatesGrid = document.getElementById("candidatesGrid");
      
      candidateArea.style.display = 'block';
      candidatesGrid.innerHTML = '';
      
      // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ±
      candidateArea.style.opacity = '0';
      candidateArea.style.transform = 'translateY(30px)';
      
      setTimeout(() => {
        candidateArea.style.transition = 'all 0.6s ease';
        candidateArea.style.opacity = '1';
        candidateArea.style.transform = 'translateY(0)';
      }, 100);

      fullList.forEach((name, index) => {
        const card = document.createElement("div");
        card.className = 'candidate-card enhanced-card touch-target mobile-card';
        card.textContent = name;
        
        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠ
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
          card.style.transition = 'all 0.4s ease';
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 100);
        
        card.onclick = () => {
          smartAudio.play('Click.mp3');
          visualEffects.createParticleExplosion(card, 10);
          
          if (mode === 'select-single') {
            selectedManual = [name];
            document.querySelectorAll('.candidate-card').forEach(el => el.classList.remove('selected'));
            card.classList.add('selected');
            
            notifications.show(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${name} ğŸ¯`, 'info', 2000);
            
          } else {
            if (selectedManual.includes(name)) {
              selectedManual = selectedManual.filter(n => n !== name);
              card.classList.remove('selected');
              notifications.show(`ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ø®ØªÙŠØ§Ø± ${name}`, 'warning', 2000);
            } else {
              selectedManual.push(name);
              card.classList.add('selected');
              notifications.show(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${name} Ù„Ù„Ù…Ø±Ø´Ø­ÙŠÙ† âœ…`, 'success', 2000);
            }
          }
          
          // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯
          const confirmBtn = document.getElementById("confirmCandidatesBtn");
          confirmBtn.disabled = selectedManual.length === 0;
          if (selectedManual.length > 0) {
            confirmBtn.classList.add('enhanced-btn');
            visualEffects.glowEffect(confirmBtn, 1000);
          }
        };
        
        candidatesGrid.appendChild(card);
      });

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Øµ Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠ
      const display = document.getElementById("candidatesDisplay");
      const maxCandidates = mode === 'select-single' ? 1 : Math.floor(fullList.length / 2);
      visualEffects.typewriterEffect(display.querySelector('p'), 
        `Ø§Ø®ØªØ± ${mode === 'select-single' ? 'Ù…Ø±Ø´Ø­Ø§Ù‹ ÙˆØ§Ø­Ø¯Ø§Ù‹' : `Ù…Ù† 1 Ø¥Ù„Ù‰ ${maxCandidates} Ù…Ø±Ø´Ø­ÙŠÙ†`} Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¯Ù†Ø§Ù‡`);
    }

    // Ø¹Ø±Ø¶ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ù…Ø­Ø³Ù†Ø©
    function renderVotingUI() {
      const votersArea = document.getElementById("votersArea");
      const votersContainer = document.getElementById("votersContainer");
      const candidateArea = document.getElementById("candidateArea");
      
      votersArea.style.display = 'block';
      votersContainer.innerHTML = '';
      voteCounts = {};
      voted.clear();

      // Ø¥Ø®ÙØ§Ø¡ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† ÙˆØ¥Ø¸Ù‡Ø§Ø± Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
      candidateArea.style.display = 'none';
      
      // ØªÙ‡ÙŠØ¦Ø© Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ØµÙˆØ§Øª
      candidateList.forEach(name => {
        voteCounts[name] = 0;
      });

      // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø·Ù‚Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰
      createCandidatesDisplay();

      // Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù†Ø§Ø®Ø¨ÙŠÙ† Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª
      voterList.forEach((name, index) => {
        const voterCard = createEnhancedVoterCard(name, index);
        votersContainer.appendChild(voterCard);
      });

      // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªØµÙˆÙŠØª
      updateVotingStatus();
      
      // ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ©
      const elements = votersContainer.querySelectorAll('.voter-card');
      visualEffects.slideInElements(Array.from(elements), 100);
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø·Ù‚Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† Ø§Ù„Ù…Ø­Ø³Ù†Ø©
    function createCandidatesDisplay() {
      const existingDisplay = document.getElementById('candidatesDisplay');
      if (existingDisplay) {
        existingDisplay.remove();
      }

      const display = document.createElement('div');
      display.id = 'candidatesDisplay';
      display.className = 'candidates-display-enhanced';
      display.style.cssText = `
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        border: 2px solid var(--primary-color);
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        animation: slideInFromLeft 0.6s ease-out;
      `;

      candidateList.forEach((name, index) => {
        const candidateBox = document.createElement('div');
        candidateBox.className = 'candidate-result-box';
        candidateBox.style.cssText = `
          background: linear-gradient(135deg, white, #f8f9fa);
          border: 2px solid var(--secondary-color);
          border-radius: 12px;
          padding: 15px;
          text-align: center;
          position: relative;
          overflow: hidden;
          transition: all 0.3s ease;
        `;

        candidateBox.innerHTML = `
          <h4 style="margin: 0 0 10px 0; color: var(--primary-color); font-size: 1.1em;">${name}</h4>
          <div class="vote-counter" style="font-size: 1.5em; font-weight: bold; color: var(--accent-color);">0</div>
          <div class="vote-text" style="font-size: 0.9em; color: var(--secondary-color);">Ø£ØµÙˆØ§Øª</div>
          <div class="progress-bar-custom">
            <div class="progress-fill-custom" style="width: 0%"></div>
          </div>
          <div class="voters-list" style="margin-top: 10px; font-size: 0.8em; color: var(--text-muted);"></div>
        `;

        display.appendChild(candidateBox);
      });

      const votersArea = document.getElementById("votersArea");
      votersArea.insertBefore(display, votersArea.firstChild);
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ù†Ø§Ø®Ø¨ Ù…Ø­Ø³Ù†Ø©
    function createEnhancedVoterCard(voterName, index) {
      const card = document.createElement("div");
      card.className = 'voter-card enhanced-card touch-target mobile-card';
      card.style.cssText = `
        background: linear-gradient(135deg, white, #f8f9fa);
        border: 2px solid var(--secondary-color);
        border-radius: 12px;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
        opacity: 0;
        transform: translateY(20px);
      `;

      // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„Ù…ØªØ£Ø®Ø±
      setTimeout(() => {
        card.style.opacity = '1';
        card.style.transform = 'translateY(0)';
      }, index * 100);

      card.innerHTML = `
        <div class="voter-name" style="font-weight: 600; margin-bottom: 10px; color: var(--primary-color);">
          ${voterName}
        </div>
        <select class="vote-select enhanced-select" style="
          width: 100%;
          padding: 8px;
          border: 2px solid var(--light-gray);
          border-radius: 8px;
          background: white;
          font-size: 0.9em;
          transition: all 0.3s ease;
        ">
          <option value="">ğŸ—³ï¸ Ø§Ø®ØªØ± Ù…Ø±Ø´Ø­</option>
          ${candidateList.map(candidate => 
            `<option value="${candidate}">ğŸ‘¤ ${candidate}</option>`
          ).join('')}
          <option value="no-vote">âŒ Ù„Ø§ Ø£ØµÙˆÙ‘Øª</option>
        </select>
      `;

      const select = card.querySelector('.vote-select');
      
      select.onchange = (e) => {
        handleVote(voterName, e.target.value, card);
      };

      select.onfocus = () => {
        card.style.borderColor = 'var(--primary-color)';
        card.style.transform = 'translateY(-5px)';
        smartAudio.play('Click.mp3', { volume: 0.3 });
      };

      select.onblur = () => {
        if (!select.value) {
          card.style.borderColor = 'var(--secondary-color)';
          card.style.transform = 'translateY(0)';
        }
      };

      return card;
    }

    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØªØµÙˆÙŠØª Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª
    function handleVote(voterName, selectedCandidate, voterCard) {
      if (!selectedCandidate) return;

      // ØªØ£Ø«ÙŠØ±Ø§Øª ØµÙˆØªÙŠØ© ÙˆØ¨ØµØ±ÙŠØ©
      smartAudio.play('kingdom-sounds/crystal-ping.mp3');
      visualEffects.createParticleExplosion(voterCard, 15);

      if (selectedCandidate !== 'no-vote') {
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ØµÙˆØ§Øª
        voteCounts[selectedCandidate]++;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
        updateCandidateDisplay(selectedCandidate);
        
        notifications.show(`ØµÙˆÙ‘Øª ${voterName} Ù„Ù€ ${selectedCandidate} âœ…`, 'success', 3000);
      } else {
        notifications.show(`${voterName} Ø§Ù…ØªÙ†Ø¹ Ø¹Ù† Ø§Ù„ØªØµÙˆÙŠØª`, 'info', 2000);
      }

      // ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØµÙˆØª
      voterCard.style.background = selectedCandidate !== 'no-vote' 
        ? 'linear-gradient(135deg, #d4edda, #c3e6cb)' 
        : 'linear-gradient(135deg, #f8d7da, #f1b2b7)';
      
      voterCard.style.borderColor = selectedCandidate !== 'no-vote' 
        ? 'var(--success-color)' 
        : 'var(--warning-color)';

      // Ø¥Ø¶Ø§ÙØ© Ø£ÙŠÙ‚ÙˆÙ†Ø©
      const icon = document.createElement('div');
      icon.innerHTML = selectedCandidate !== 'no-vote' ? 'âœ…' : 'âŒ';
      icon.style.cssText = `
        position: absolute;
        top: 5px;
        right: 5px;
        font-size: 1.5em;
        animation: bounceIn 0.6s ease;
      `;
      voterCard.appendChild(icon);

      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØµÙˆÙŠØª
      setTimeout(() => {
        voterCard.style.transition = 'all 0.5s ease';
        voterCard.style.opacity = '0';
        voterCard.style.transform = 'translateX(-100%)';
        
        setTimeout(() => {
          if (voterCard.parentNode) {
            voterCard.parentNode.removeChild(voterCard);
          }
        }, 500);
      }, 2000);

      voted.add(voterName);
      
      // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªØµÙˆÙŠØª
      updateVotingStatus();
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØªØµÙˆÙŠØª
      if (voted.size === voterList.length) {
        setTimeout(() => {
          completeVoting();
        }, 3000);
      }
    }

    // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±Ø´Ø­
    function updateCandidateDisplay(candidateName) {
      const display = document.getElementById('candidatesDisplay');
      const candidateBoxes = display.querySelectorAll('.candidate-result-box');
      
      candidateBoxes.forEach(box => {
        const nameElement = box.querySelector('h4');
        if (nameElement.textContent === candidateName) {
          const counter = box.querySelector('.vote-counter');
          const progressFill = box.querySelector('.progress-fill-custom');
          const votersList = box.querySelector('.voters-list');
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ù…Ø¹ ØªØ£Ø«ÙŠØ±
          const currentCount = parseInt(counter.textContent);
          visualEffects.animateCounter(counter, currentCount, voteCounts[candidateName]);
          
          // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
          const percentage = (voteCounts[candidateName] / voterList.length) * 100;
          progressFill.style.width = percentage + '%';
          
          // ØªØ£Ø«ÙŠØ± Ø§Ù„ÙˆÙ‡Ø¬
          visualEffects.glowEffect(box, 1500);
        }
      });
    }

    // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªØµÙˆÙŠØª
    function updateVotingStatus() {
      const statusElement = document.getElementById('votingStatus');
      const remaining = voterList.length - voted.size;
      const percentage = Math.round((voted.size / voterList.length) * 100);
      
      if (remaining > 0) {
        statusElement.className = 'voting-status active';
        visualEffects.typewriterEffect(statusElement.querySelector('p'), 
          `ğŸ“Š Ø§Ù„ØªÙ‚Ø¯Ù…: ${percentage}% â€¢ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${remaining} Ù…ØµÙˆØª`);
      } else {
        statusElement.className = 'voting-status completed';
        visualEffects.typewriterEffect(statusElement.querySelector('p'), 
          'ğŸ‰ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ØªØµÙˆÙŠØª! Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬...');
      }
    }

    // Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ØªØµÙˆÙŠØª
    function completeVoting() {
      smartAudio.play('kingdom-sounds/cosmic-explosion.mp3');
      notifications.show('Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ØªØµÙˆÙŠØª! ğŸ‰ Ø¬Ø§Ø±ÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬...', 'success');
      
      setTimeout(() => {
        showEnhancedResults();
      }, 2000);
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø­Ø³Ù†
    function showEnhancedResults() {
      smartAudio.play('kingdom-sounds/crown-ceremony.mp3');
      smartAudio.stopBackgroundMusic();
      
      const resultsArea = document.getElementById("resultsArea");
      resultsArea.style.display = 'block';
      
      // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ±
      resultsArea.style.opacity = '0';
      resultsArea.style.transform = 'translateY(50px)';
      
      setTimeout(() => {
        resultsArea.style.transition = 'all 0.8s ease';
        resultsArea.style.opacity = '1';
        resultsArea.style.transform = 'translateY(0)';
      }, 100);

      const ctx = document.getElementById("resultsChart").getContext("2d");
      const labels = Object.keys(voteCounts);
      const data = Object.values(voteCounts);

      const maxVotes = Math.max(...data);
      const winners = labels.filter((name, i) => data[i] === maxVotes);

      // Ø£Ù„ÙˆØ§Ù† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ù„Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      const colors = labels.map(name => 
        winners.includes(name) ? '#FFD700' : `hsl(${Math.random() * 360}, 70%, 60%)`
      );

      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª
      const chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels.map(name => winners.includes(name) ? `ğŸ‘‘ ${name}` : name),
          datasets: [{
            label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙˆØ§Øª',
            data,
            backgroundColor: colors,
            borderColor: colors.map(color => color.replace('0.8)', '1)')),
            borderWidth: 3,
            borderRadius: 8,
            borderSkipped: false,
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          animation: {
            duration: 2000,
            easing: 'easeOutBounce'
          },
          plugins: {
            legend: { 
              display: false 
            },
            tooltip: {
              callbacks: {
                title: (context) => {
                  const name = context[0].label.replace('ğŸ‘‘ ', '');
                  return winners.includes(name) ? `ğŸ† ${name} (Ø§Ù„ÙØ§Ø¦Ø²)` : name;
                },
                label: (context) => {
                  const votes = context.raw;
                  const percentage = ((votes / data.reduce((a, b) => a + b, 0)) * 100).toFixed(1);
                  return `${votes} ${votes === 1 ? 'ØµÙˆØª' : 'Ø£ØµÙˆØ§Øª'} (${percentage}%)`;
                }
              },
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              titleColor: '#FFD700',
              bodyColor: '#FFFFFF',
              borderColor: '#FFD700',
              borderWidth: 2,
              cornerRadius: 10,
              displayColors: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                stepSize: 1,
                color: '#333',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              },
              grid: {
                color: 'rgba(0, 0, 0, 0.1)'
              }
            },
            x: {
              ticks: {
                color: '#333',
                font: {
                  size: 12,
                  weight: 'bold'
                }
              },
              grid: {
                display: false
              }
            }
          }
        }
      });

      // ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© Ù„Ù„Ù†ØªØ§Ø¦Ø¬
      setTimeout(() => {
        // Ø§Ù„Ø§Ø­ØªÙØ§Ù„ Ø¨Ø§Ù„ÙØ§Ø¦Ø²
        if (winners.length === 1) {
          notifications.show(`ğŸ‰ Ø§Ù„ÙØ§Ø¦Ø²: ${winners[0]} Ø¨Ù€ ${maxVotes} ${maxVotes === 1 ? 'ØµÙˆØª' : 'Ø£ØµÙˆØ§Øª'}!`, 'success', 8000);
        } else {
          notifications.show(`ğŸ‰ ØªØ¹Ø§Ø¯Ù„ Ø¨ÙŠÙ†: ${winners.join(', ')} Ø¨Ù€ ${maxVotes} ${maxVotes === 1 ? 'ØµÙˆØª' : 'Ø£ØµÙˆØ§Øª'}!`, 'success', 8000);
        }

        // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø§Ø­ØªÙØ§Ù„
        visualEffects.confettiBlast({
          particleCount: 300,
          spread: 180,
          origin: { y: 0.4 }
        });

        // Ø£ØµÙˆØ§Øª Ø§Ù„Ø§Ø­ØªÙØ§Ù„
        smartAudio.playSequence([
          'kingdom-sounds/battle-victory.mp3',
          'clap.mp3'
        ], 1000);

        // ØªØ£Ø«ÙŠØ±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ÙƒÙ„ 3 Ø«ÙˆØ§Ù†
        const celebrationInterval = setInterval(() => {
          visualEffects.confettiBlast({
            particleCount: 100,
            spread: 90,
            origin: { x: Math.random(), y: 0.7 }
          });
        }, 3000);

        // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨Ø¹Ø¯ 15 Ø«Ø§Ù†ÙŠØ©
        setTimeout(() => {
          clearInterval(celebrationInterval);
        }, 15000);

      }, 2500);

      // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ
      createDetailedResultsTable(labels, data, winners, maxVotes);
      
      // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
      updateFinalCandidatesDisplay(winners);
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ
    function createDetailedResultsTable(labels, data, winners, maxVotes) {
      const resultsArea = document.getElementById("resultsArea");
      
      const tableContainer = document.createElement('div');
      tableContainer.className = 'results-table-container';
      tableContainer.style.cssText = `
        margin: 30px 0;
        background: linear-gradient(135deg, #f8f9fa, white);
        border-radius: 15px;
        padding: 20px;
        border: 2px solid var(--accent-color);
        overflow: hidden;
        position: relative;
      `;

      const table = document.createElement('table');
      table.style.cssText = `
        width: 100%;
        border-collapse: collapse;
        font-family: 'Cairo', sans-serif;
      `;

      // Ø±Ø£Ø³ Ø§Ù„Ø¬Ø¯ÙˆÙ„
      table.innerHTML = `
        <thead>
          <tr style="background: linear-gradient(135deg, var(--primary-color), var(--accent-color)); color: white;">
            <th style="padding: 15px; text-align: center; border-radius: 10px 0 0 0;">Ø§Ù„Ù…Ø±ØªØ¨Ø©</th>
            <th style="padding: 15px; text-align: center;">Ø§Ù„Ù…Ø±Ø´Ø­</th>
            <th style="padding: 15px; text-align: center;">Ø§Ù„Ø£ØµÙˆØ§Øª</th>
            <th style="padding: 15px; text-align: center;">Ø§Ù„Ù†Ø³Ø¨Ø©</th>
            <th style="padding: 15px; text-align: center; border-radius: 0 10px 0 0;">Ø§Ù„Ø­Ø§Ù„Ø©</th>
          </tr>
        </thead>
        <tbody id="resultsTableBody">
        </tbody>
      `;

      const tbody = table.querySelector('#resultsTableBody');
      const totalVotes = data.reduce((a, b) => a + b, 0);
      
      // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
      const sortedResults = labels.map((name, index) => ({
        name,
        votes: data[index],
        percentage: ((data[index] / totalVotes) * 100).toFixed(1)
      })).sort((a, b) => b.votes - a.votes);

      // Ø¥Ø¶Ø§ÙØ© ØµÙÙˆÙ Ø§Ù„Ø¬Ø¯ÙˆÙ„
      sortedResults.forEach((result, index) => {
        const isWinner = winners.includes(result.name);
        const row = document.createElement('tr');
        
        row.style.cssText = `
          background: ${isWinner ? 'linear-gradient(135deg, #fff3cd, #ffeaa7)' : (index % 2 === 0 ? '#f8f9fa' : 'white')};
          transition: all 0.3s ease;
          animation: slideInFromRight ${0.6 + index * 0.1}s ease-out;
        `;

        row.innerHTML = `
          <td style="padding: 12px; text-align: center; font-weight: bold; color: ${isWinner ? '#d4a247' : '#6c757d'};">
            ${isWinner ? 'ğŸ†' : index + 1}
          </td>
          <td style="padding: 12px; text-align: center; font-weight: ${isWinner ? 'bold' : 'normal'}; color: ${isWinner ? '#d4a247' : '#333'};">
            ${isWinner ? 'ğŸ‘‘ ' : ''}${result.name}
          </td>
          <td style="padding: 12px; text-align: center; font-weight: bold; color: var(--primary-color);">
            ${result.votes}
          </td>
          <td style="padding: 12px; text-align: center; color: var(--secondary-color);">
            ${result.percentage}%
          </td>
          <td style="padding: 12px; text-align: center;">
            ${isWinner ? '<span style="color: #d4a247; font-weight: bold;">ğŸ‰ ÙØ§Ø¦Ø²</span>' : 
              (result.votes === 0 ? '<span style="color: #6c757d;">Ù„Ù… ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø£ØµÙˆØ§Øª</span>' : 
               '<span style="color: #28a745;">Ù…Ø´Ø§Ø±Ùƒ</span>')}
          </td>
        `;

        // ØªØ£Ø«ÙŠØ± hover
        row.onmouseenter = () => {
          row.style.transform = 'translateX(-5px)';
          row.style.boxShadow = '0 4px 15px rgba(0,0,0,0.1)';
        };

        row.onmouseleave = () => {
          row.style.transform = 'translateX(0)';
          row.style.boxShadow = 'none';
        };

        tbody.appendChild(row);

        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªØ­Ø±Ùƒ
        setTimeout(() => {
          const voteCell = row.children[2];
          visualEffects.animateCounter(voteCell, 0, result.votes, 1500);
        }, 1000 + index * 200);
      });

      tableContainer.appendChild(table);
      
      // Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù‚Ø¨Ù„ Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø©
      const returnButton = resultsArea.querySelector('button');
      resultsArea.insertBefore(tableContainer, returnButton);
    }

    // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
    function updateFinalCandidatesDisplay(winners) {
      const candidatesDisplay = document.getElementById('candidatesDisplay');
      if (candidatesDisplay) {
        const candidateBoxes = candidatesDisplay.querySelectorAll('.candidate-result-box');
        
        candidateBoxes.forEach(box => {
          const nameElement = box.querySelector('h4');
          const candidateName = nameElement.textContent;
          
          if (winners.includes(candidateName)) {
            // ØªØ£Ø«ÙŠØ± Ø§Ù„ÙØ§Ø¦Ø²
            box.style.background = 'linear-gradient(135deg, #ffd700, #fff8dc)';
            box.style.border = '3px solid #d4a247';
            box.style.transform = 'scale(1.05)';
            box.style.boxShadow = '0 10px 30px rgba(212, 162, 71, 0.3)';
            
            nameElement.innerHTML = `ğŸ‘‘ ${candidateName} ğŸ†`;
            nameElement.style.color = '#d4a247';
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„ÙˆÙ‡Ø¬ Ø§Ù„Ù…Ø³ØªÙ…Ø±
            box.style.animation = 'glow 2s ease-in-out infinite alternate';
          }
        });
      }
    }

    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø­Ø³Ù†
    function resetVoting() {
      smartAudio.play('Click.mp3');
      smartAudio.stopBackgroundMusic();
      
      // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø®ÙØ§Ø¡
      const elements = ['candidateArea', 'votersArea', 'resultsArea'];
      elements.forEach(id => {
        const element = document.getElementById(id);
        if (element.style.display !== 'none') {
          element.style.transition = 'all 0.5s ease';
          element.style.opacity = '0';
          element.style.transform = 'translateY(30px)';
          
          setTimeout(() => {
            element.style.display = 'none';
            element.style.opacity = '1';
            element.style.transform = 'translateY(0)';
          }, 500);
        }
      });

      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
      candidateList = [];
      voterList = [];
      selectedManual = [];
      voteCounts = {};
      voted.clear();
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
      document.getElementById("classSelect").value = '';
      document.getElementById("voteMode").value = '';
      document.getElementById("startNominateBtn").disabled = true;
      document.getElementById("confirmCandidatesBtn").disabled = true;
      document.getElementById("showResultsBtn").disabled = true;
      
      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¤Ù‚ØªØ©
      const tempElements = document.querySelectorAll('#candidatesDisplay, .results-table-container');
      tempElements.forEach(el => el.remove());
      
      notifications.show('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø´Ø§Ø· Ø¨Ù†Ø¬Ø§Ø­ ğŸ”„', 'info');
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø®Ù„ÙÙŠØ©
      setTimeout(() => {
        smartAudio.playBackgroundMusic();
      }, 1000);
    }

    // Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø£ØµÙˆØ§Øª
    function createAudioControls() {
      const controlsContainer = document.createElement('div');
      controlsContainer.className = 'audio-controls';
      controlsContainer.style.cssText = `
        position: fixed;
        top: 20px;
        left: 200px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 50px;
        padding: 10px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        display: flex;
        gap: 10px;
        z-index: 1000;
        backdrop-filter: blur(10px);
      `;

      // Ø²Ø± ÙƒØªÙ…/Ø¥Ù„ØºØ§Ø¡ ÙƒØªÙ… Ø§Ù„ØµÙˆØª
      const muteButton = document.createElement('button');
      muteButton.innerHTML = 'ğŸ”Š';
      muteButton.className = 'btn-control';
      muteButton.style.cssText = `
        width: 40px;
        height: 40px;
        border: none;
        border-radius: 50%;
        background: var(--primary-color);
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1.2em;
      `;

      muteButton.onclick = () => {
        if (smartAudio.isMuted) {
          smartAudio.unmute();
          muteButton.innerHTML = 'ğŸ”Š';
          notifications.show('ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª', 'info', 2000);
        } else {
          smartAudio.mute();
          muteButton.innerHTML = 'ğŸ”‡';
          notifications.show('ØªÙ… ÙƒØªÙ… Ø§Ù„ØµÙˆØª', 'warning', 2000);
        }
      };

      // Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª
      const volumeSlider = document.createElement('input');
      volumeSlider.type = 'range';
      volumeSlider.min = '0';
      volumeSlider.max = '1';
      volumeSlider.step = '0.1';
      volumeSlider.value = smartAudio.volume;
      volumeSlider.style.cssText = `
        width: 80px;
        height: 40px;
        cursor: pointer;
      `;

      volumeSlider.oninput = (e) => {
        smartAudio.setVolume(parseFloat(e.target.value));
      };

      controlsContainer.appendChild(muteButton);
      controlsContainer.appendChild(volumeSlider);
      document.body.appendChild(controlsContainer);
      
      // ØªØ­Ø¯ÙŠØ« Ù…ÙˆÙ‚Ø¹ Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
      const updateControlsPosition = () => {
        if (window.innerWidth <= 768) {
          controlsContainer.style.left = '15px';
          controlsContainer.style.top = '80px';
          controlsContainer.style.flexDirection = 'column';
          controlsContainer.style.gap = '5px';
          controlsContainer.style.padding = '8px';
          volumeSlider.style.width = '60px';
          volumeSlider.style.height = '35px';
          muteButton.style.width = '35px';
          muteButton.style.height = '35px';
          muteButton.style.fontSize = '1em';
        } else if (window.innerWidth <= 480) {
          controlsContainer.style.left = '15px';
          controlsContainer.style.top = '75px';
          controlsContainer.style.flexDirection = 'row';
          controlsContainer.style.gap = '5px';
          controlsContainer.style.padding = '6px';
          volumeSlider.style.width = '50px';
          volumeSlider.style.height = '30px';
          muteButton.style.width = '30px';
          muteButton.style.height = '30px';
          muteButton.style.fontSize = '0.9em';
        } else {
          controlsContainer.style.left = '200px';
          controlsContainer.style.top = '20px';
          controlsContainer.style.flexDirection = 'row';
          controlsContainer.style.gap = '10px';
          controlsContainer.style.padding = '10px';
          volumeSlider.style.width = '80px';
          volumeSlider.style.height = '40px';
          muteButton.style.width = '40px';
          muteButton.style.height = '40px';
          muteButton.style.fontSize = '1.2em';
        }
      };

      // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
      updateControlsPosition();
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
      window.addEventListener('resize', updateControlsPosition);
      
      return controlsContainer;
    }

    // ØªØ­Ø¯ÙŠØ« ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    function updateButtonStates() {
      const classSelect = document.getElementById("classSelect");
      const voteMode = document.getElementById("voteMode");
      const startBtn = document.getElementById("startNominateBtn");
      
      startBtn.disabled = !classSelect.value || !voteMode.value;
      
      if (!startBtn.disabled) {
        startBtn.classList.add('enhanced-btn');
        visualEffects.glowEffect(startBtn, 1000);
      } else {
        startBtn.classList.remove('enhanced-btn');
      }
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø­Ø³Ù† Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    window.onload = function() {
      // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£Ù†Ø¸Ù…Ø©
      smartAudio.init();
      loadStudents();
      createAudioControls();
      
      // ØªØ­Ø³ÙŠÙ† Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø©
      const backBtn = document.querySelector('.back-btn');
      if (backBtn) {
        backBtn.addEventListener('mouseenter', () => {
          smartAudio.play('Click.mp3', { volume: 0.3 });
        });
        
        backBtn.addEventListener('click', (e) => {
          smartAudio.play('Notification.mp3');
          
          // ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
          backBtn.style.transform = 'scale(0.9)';
          setTimeout(() => {
            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø³ÙŠØ­Ø¯Ø« ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
          }, 150);
        });

        // ØªØ£Ø«ÙŠØ± Ø§Ù„ÙˆÙ‡Ø¬ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        setTimeout(() => {
          visualEffects.glowEffect(backBtn, 2000);
        }, 1000);
      }
      
      // Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ø­Ø³Ù†Ø©
      document.getElementById('startNominateBtn').onclick = startVotingSetup;
      document.getElementById('showResultsBtn').onclick = showEnhancedResults;
      
      // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
      document.getElementById("classSelect").onchange = updateButtonStates;
      document.getElementById("voteMode").onchange = updateButtonStates;
      
      // ØªØ­Ø³ÙŠÙ† Ø²Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯
      const confirmBtn = document.getElementById("confirmCandidatesBtn");
      confirmBtn.onclick = () => {
        if (selectedManual.length === 0) {
          notifications.show('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø±Ø´Ø­ Ø£Ùˆ Ø£ÙƒØ«Ø± Ø£ÙˆÙ„Ø§Ù‹', 'warning');
          return;
        }
        
        candidateList = [...selectedManual];
        voterList = studentData[currentClass].filter(n => !candidateList.includes(n));
        renderVotingUI();
        smartAudio.play('kingdom-sounds/crystal-ping.mp3');
        notifications.show(`ØªÙ… ØªØ£ÙƒÙŠØ¯ ${candidateList.length} Ù…Ø±Ø´Ø­ ÙˆØ¨Ø¯Ø¡ Ø§Ù„ØªØµÙˆÙŠØª! ğŸš€`, 'success');
      };

      // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø­Ø³Ù†
      const resetBtn = document.createElement('button');
      resetBtn.id = 'resetBtn';
      resetBtn.className = 'btn btn-secondary enhanced-btn touch-target mobile-btn';
      resetBtn.innerHTML = '<i class="fas fa-redo"></i> ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†';
      resetBtn.onclick = resetVoting;
      resetBtn.style.cssText = `
        margin: 10px;
        background: linear-gradient(45deg, #6c757d, #495057);
        border: none;
        color: white;
        padding: 12px 24px;
        border-radius: 25px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      `;
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø²Ø± ÙÙŠ Ù…ÙƒØ§Ù† Ù…Ù†Ø§Ø³Ø¨
      const headerElement = document.querySelector('.header');
      headerElement.appendChild(resetBtn);

      // Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨
      setTimeout(() => {
        notifications.show('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ù…Ø·ÙˆØ±! ğŸ—³ï¸âœ¨', 'info', 5000);
      }, 2000);

      // ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© Ø£ÙˆÙ„ÙŠØ©
      const cards = document.querySelectorAll('.card');
      visualEffects.slideInElements(Array.from(cards), 200);
    };

    // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
    document.addEventListener('keydown', (e) => {
      switch(e.key) {
        case 'r':
        case 'R':
          if (e.ctrlKey) {
            e.preventDefault();
            resetVoting();
          }
          break;
        case 'm':
        case 'M':
          if (e.ctrlKey) {
            e.preventDefault();
            if (smartAudio.isMuted) {
              smartAudio.unmute();
            } else {
              smartAudio.mute();
            }
          }
          break;
      }
    });

    // Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ø§Ù„Ù„Ù…Ø³ Ø§Ù„Ù…Ø­Ø³Ù†
    if ('ontouchstart' in window) {
      document.body.classList.add('touch-device');
      
      // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ù…Ø³
      document.addEventListener('touchstart', (e) => {
        if (e.target.classList.contains('touch-target')) {
          e.target.style.transform = 'scale(0.95)';
        }
      });
      
      document.addEventListener('touchend', (e) => {
        if (e.target.classList.contains('touch-target')) {
          setTimeout(() => {
            e.target.style.transform = '';
          }, 150);
        }
      });
    }
  </script>
  </script>
  
  <!-- Responsive Helper Script -->
  <script src="../assets/js/responsive-helper.js"></script>
</body>
</html>
