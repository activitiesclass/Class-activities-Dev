<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿ≥ŸÑÿ∑ŸÜÿ© ÿπŸèŸÖÿßŸÜ - ŸÑÿπÿ®ÿ© ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑÿ™ÿπŸÑŸäŸÖŸäÿ©">
    <title>ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿ≥ŸÑÿ∑ŸÜÿ© ÿπŸèŸÖÿßŸÜ - ŸÑÿπÿ®ÿ© ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑÿπŸèŸÖÿßŸÜŸäÿ©</title>
    
    <!-- ÿßŸÑÿÆÿ∑Ÿàÿ∑ ŸàÿßŸÑÿ£ŸäŸÇŸàŸÜÿßÿ™ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- ÿßŸÑŸÖŸÉÿ™ÿ®ÿßÿ™ ÿßŸÑÿÆÿßÿ±ÿ¨Ÿäÿ© -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    
    <!-- ÿßŸÑÿ£ŸÜŸÖÿßÿ∑ ŸàÿßŸÑÿ≥ŸÉÿ±Ÿäÿ®ÿ™ ÿßŸÑŸÖŸàÿ≠ÿØ -->
    <link rel="stylesheet" href="../assets/css/style.css">
    <script src="../assets/js/activityUtils.js"></script>

    <style>
        /* ===========================================
           ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿπŸèŸÖÿßŸÜŸä ÿßŸÑŸÖÿ™ŸÇÿØŸÖ
        =========================================== */
        :root {
            /* ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿπŸèŸÖÿßŸÜŸäÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
            --oman-red: #DC143C;
            --oman-green: #228B22;
            --oman-white: #FFFFFF;
            --accent-gold: #FFD700;
            
            /* ÿ™ÿØÿ±ÿ¨ÿßÿ™ ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ŸÖÿÆÿµÿµÿ© */
            --gradient-red: linear-gradient(135deg, var(--oman-red) 0%, #B71C1C 100%);
            --gradient-green: linear-gradient(135deg, var(--oman-green) 0%, #1B5E20 100%);
            --gradient-gold: linear-gradient(135deg, var(--accent-gold) 0%, #F57C00 100%);
            --gradient-background: linear-gradient(135deg, #0F172A 0%, #1E293B 25%, #334155 50%, #475569 75%, #64748B 100%);
            
            /* ÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿßŸÑÿ™ŸÇŸÑŸäÿØŸäÿ© */
            --property-brown: #8B4513;
            --property-light-blue: #87CEEB;
            --property-pink: #FF1493;
            --property-orange: #FF8C00;
            --property-red: var(--oman-red);
            --property-yellow: #FFD700;
            --property-green: var(--oman-green);
            --property-dark-blue: #191970;
            --utility-color: #F0F8FF;
            --railroad-color: #2F4F4F;
            
            /* ÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÜÿ∏ÿßŸÖ */
            --success-color: #22C55E;
            --warning-color: #F59E0B;
            --danger-color: #EF4444;
            --info-color: #3B82F6;
            
            /* ÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÜÿµ ŸàÿßŸÑÿÆŸÑŸÅŸäÿßÿ™ */
            --text-primary: #FFFFFF;
            --text-secondary: #E2E8F0;
            --text-muted: #94A3B8;
            --text-dark: #1E293B;
            --text-board: #1F2937;
            
            /* ÿÆŸÑŸÅŸäÿßÿ™ Ÿàÿ£ÿ≥ÿ∑ÿ≠ */
            --background-primary: #0F172A;
            --background-secondary: #1E293B;
            --surface-elevated: rgba(255, 255, 255, 0.1);
            --surface-glass: rgba(255, 255, 255, 0.05);
            --surface-board: rgba(255, 255, 255, 0.98);
            
            /* ÿ∏ŸÑÿßŸÑ Ÿàÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ */
            --shadow-small: 0 2px 8px rgba(0, 0, 0, 0.15);
            --shadow-medium: 0 4px 20px rgba(0, 0, 0, 0.25);
            --shadow-large: 0 8px 32px rgba(0, 0, 0, 0.35);
            --shadow-glow-red: 0 0 24px rgba(220, 20, 60, 0.4);
            --shadow-glow-green: 0 0 24px rgba(34, 139, 34, 0.4);
            --shadow-glow-gold: 0 0 24px rgba(255, 215, 0, 0.4);
            --shadow-board: 0 12px 48px rgba(0, 0, 0, 0.4);
            
            /* ÿ£ŸÜÿµÿßŸÅ ÿ£ŸÇÿ∑ÿßÿ± ÿßŸÑÿ≠ÿØŸàÿØ */
            --border-radius-small: 8px;
            --border-radius-medium: 12px;
            --border-radius-large: 16px;
            --border-radius-xl: 24px;
            
            /* ÿßŸÜÿ™ŸÇÿßŸÑÿßÿ™ */
            --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ===========================================
           ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿπÿßŸÖÿ©
        =========================================== */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--gradient-background);
            background-attachment: fixed;
            margin: 0;
            padding: 0;
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ÿÆŸÑŸÅŸäÿ© ŸÖÿ™ÿ≠ÿ±ŸÉÿ© ŸÖÿ™ÿ∑Ÿàÿ±ÿ© */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 25% 25%, rgba(220, 20, 60, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(34, 139, 34, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(255, 215, 0, 0.08) 0%, transparent 50%);
            animation: monopolyFlow 25s ease-in-out infinite;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes monopolyFlow {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                opacity: 0.6;
            }
            25% { 
                transform: scale(1.2) rotate(90deg);
                opacity: 0.8;
            }
            50% { 
                transform: scale(0.8) rotate(180deg);
                opacity: 0.4;
            }
            75% { 
                transform: scale(1.1) rotate(270deg);
                opacity: 0.7;
            }
        }

        /* ===========================================
           ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿπŸÑŸàŸäÿ© ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜÿ©
        =========================================== */
        .top-controls-panel {
            position: fixed;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
            z-index: 2147483647;
            flex-direction: row-reverse;
        }

        .control-btn {
            font-size: 18px;
            background: var(--surface-glass);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition-normal);
            padding: 12px;
            border-radius: 50%;
            backdrop-filter: blur(16px);
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-medium);
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }
        
        .control-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
        
        .control-btn:hover::before {
            transform: translateX(100%);
        }
        
        .control-btn:hover {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        #returnToIndex {
            background: linear-gradient(135deg, #2193b0, #6dd5ed);
            border-color: #2193b0;
        }

        #returnToIndex:hover {
            background: linear-gradient(135deg, #1e8397, #5bc3d0);
            box-shadow: 0 8px 25px rgba(33, 147, 176, 0.4);
        }

        #soundToggle {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: #667eea;
        }

        #soundToggle:hover {
            background: linear-gradient(135deg, #5a6fd8, #6a4190);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        #fullscreenToggle {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            border-color: #f093fb;
        }

        #fullscreenToggle:hover {
            background: linear-gradient(135deg, #e87ee8, #e8455a);
            box-shadow: 0 8px 25px rgba(240, 147, 251, 0.4);
        }

        #gameInfo {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            border-color: #4facfe;
        }

        #gameInfo:hover {
            background: linear-gradient(135deg, #3d8bfe, #00d9fe);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
        }

        /* ŸÜÿßŸÅÿ∞ÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ© */
        .game-info-content {
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .info-section {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--oman-red);
        }

        .info-section h3 {
            margin: 0 0 10px 0;
            color: var(--oman-red);
            font-size: 16px;
        }

        .info-section p {
            margin: 0;
            color: #495057;
            line-height: 1.5;
        }

        .modal-footer {
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ© */
        @media (max-width: 768px) {
            .top-controls-panel {
                top: 10px;
                right: 10px;
                gap: 8px;
            }

            .control-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
                padding: 8px;
            }

            .top-controls-panel {
                flex-direction: column;
                position: fixed;
                top: 10px;
                right: 10px;
            }
        }

        @media (max-width: 480px) {
            .control-btn {
                width: 36px;
                height: 36px;
                font-size: 14px;
                padding: 6px;
            }
        }

        /* ===========================================
           ÿßŸÑÿ≠ÿßŸàŸäÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
        =========================================== */
        .monopoly-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* ÿßŸÑÿπŸÜŸàÿßŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */
        .game-title {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: var(--surface-glass);
            border-radius: var(--border-radius-xl);
            backdrop-filter: blur(16px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-large);
        }

        .game-title h1 {
            font-size: 3rem;
            font-weight: 700;
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-title p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        /* ===========================================
           ŸÑŸàÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿπÿµÿ±Ÿäÿ©
        =========================================== */
        .game-board {
            width: 100%;
            max-width: 900px;
            margin: 20px auto;
            aspect-ratio: 1;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #1e3c72 100%);
            border-radius: 20px;
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.3),
                0 0 0 8px rgba(255,255,255,0.1),
                inset 0 0 50px rgba(255,255,255,0.1);
            position: relative;
            border: 6px solid var(--oman-red);
            overflow: visible;
            transform-style: preserve-3d;
            animation: boardGlow 3s ease-in-out infinite alternate;
        }

        @keyframes boardGlow {
            0% { 
                box-shadow: 
                    0 20px 40px rgba(0,0,0,0.3),
                    0 0 0 8px rgba(255,255,255,0.1),
                    inset 0 0 50px rgba(255,255,255,0.1),
                    0 0 60px rgba(220, 20, 60, 0.3);
            }
            100% { 
                box-shadow: 
                    0 25px 50px rgba(0,0,0,0.4),
                    0 0 0 12px rgba(255,255,255,0.15),
                    inset 0 0 80px rgba(255,255,255,0.15),
                    0 0 100px rgba(220, 20, 60, 0.5);
            }
        }

        /* ŸÖÿ±ÿ®ÿπÿßÿ™ ÿßŸÑŸÑŸàÿ≠ÿ© ÿßŸÑÿπÿµÿ±Ÿäÿ© */
        .board-square {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 8px 4px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 3px solid #2c3e50;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            color: #2c3e50;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.1),
                inset 0 1px 0 rgba(255,255,255,0.8);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .board-square::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }

        .board-square:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 
                0 15px 30px rgba(0,0,0,0.2),
                0 0 20px rgba(220, 20, 60, 0.3),
                inset 0 1px 0 rgba(255,255,255,0.9);
            z-index: 10;
        }

        .board-square:hover::before {
            transform: translateX(100%);
        }

        .board-square:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-medium);
            z-index: 10;
        }

        /* ŸÖÿ±ÿ®ÿπÿßÿ™ ÿßŸÑÿ≤ŸàÿßŸäÿß ÿßŸÑÿπÿµÿ±Ÿäÿ© */
        .corner-square {
            width: 120px;
            height: 120px;
            border-radius: 18px !important;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%) !important;
            border: 4px solid #c44569 !important;
            color: white !important;
            font-size: 0.85rem !important;
            font-weight: 800 !important;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3) !important;
            box-shadow: 
                0 8px 16px rgba(0,0,0,0.2),
                inset 0 2px 0 rgba(255,255,255,0.3) !important;
        }

        .corner-square:hover {
            background: linear-gradient(135deg, #ff5252 0%, #d84315 100%) !important;
            transform: translateY(-10px) scale(1.08) !important;
        }

        /* ŸÖÿ±ÿ®ÿπÿßÿ™ ÿßŸÑÿ¨ÿßŸÜÿ® ÿßŸÑÿπÿµÿ±Ÿäÿ© */
        .side-square {
            width: 80px;
            height: 120px;
            border-radius: 14px !important;
        }

        /* ÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑÿπÿµÿ±Ÿäÿ© */
        .brown { 
            background: linear-gradient(135deg, #8b4513 0%, #a0522d 100%) !important; 
            color: white !important;
            border-color: #5d2f0b !important;
        }
        .light-blue { 
            background: linear-gradient(135deg, #87ceeb 0%, #4fb3d9 100%) !important;
            color: #1e3c72 !important;
            border-color: #2980b9 !important;
        }
        .pink { 
            background: linear-gradient(135deg, #ff69b4 0%, #ff1493 100%) !important; 
            color: white !important;
            border-color: #c91d6b !important;
        }
        .orange { 
            background: linear-gradient(135deg, #ffa500 0%, #ff8c00 100%) !important;
            color: white !important;
            border-color: #d67700 !important;
        }
        .red { 
            background: linear-gradient(135deg, #dc143c 0%, #b71c1c 100%) !important; 
            color: white !important;
            border-color: #8b0000 !important;
        }
        .yellow { 
            background: linear-gradient(135deg, #ffd700 0%, #ffb300 100%) !important;
            color: #2c3e50 !important;
            border-color: #e6ac00 !important;
        }
        .green { 
            background: linear-gradient(135deg, #32cd32 0%, #228b22 100%) !important; 
            color: white !important;
            border-color: #1a5d1a !important;
        }
        .dark-blue { 
            background: linear-gradient(135deg, #191970 0%, #000080 100%) !important; 
            color: white !important;
            border-color: #0a0a3a !important;
        }
        .utility { 
            background: linear-gradient(135deg, #708090 0%, #2f4f4f 100%) !important;
            color: white !important;
            border-color: #1c2b2b !important;
        }
        .railroad { 
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%) !important; 
            color: white !important;
            border-color: #1a252f !important;
        }
        .special {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%) !important;
            color: white !important;
            border-color: #c44569 !important;
        }

        /* ŸÖŸàÿßÿ∂ÿπ ÿßŸÑŸÖÿ±ÿ®ÿπÿßÿ™ ÿßŸÑŸÖÿ≠ÿ≥ŸÜÿ© */
        /* ÿßŸÑÿµŸÅ ÿßŸÑÿ≥ŸÅŸÑŸä */
        .square-0 { bottom: 0; right: 0; }
        .square-1 { bottom: 0; right: 130px; }
        .square-2 { bottom: 0; right: 220px; }
        .square-3 { bottom: 0; right: 310px; }
        .square-4 { bottom: 0; right: 400px; }
        .square-5 { bottom: 0; right: 490px; }
        .square-6 { bottom: 0; right: 580px; }
        .square-7 { bottom: 0; right: 670px; }
        .square-8 { bottom: 0; right: 760px; }
        .square-9 { bottom: 0; right: 850px; }
        .square-10 { bottom: 0; left: 0; }

        /* ÿßŸÑÿµŸÅ ÿßŸÑÿ£Ÿäÿ≥ÿ± */
        .square-11 { left: 0; bottom: 130px; transform: rotate(90deg); }
        .square-12 { left: 0; bottom: 220px; transform: rotate(90deg); }
        .square-13 { left: 0; bottom: 310px; transform: rotate(90deg); }
        .square-14 { left: 0; bottom: 400px; transform: rotate(90deg); }
        .square-15 { left: 0; bottom: 490px; transform: rotate(90deg); }
        .square-16 { left: 0; bottom: 580px; transform: rotate(90deg); }
        .square-17 { left: 0; bottom: 670px; transform: rotate(90deg); }
        .square-18 { left: 0; bottom: 760px; transform: rotate(90deg); }
        .square-19 { left: 0; bottom: 850px; transform: rotate(90deg); }
        .square-20 { top: 0; left: 0; }

        /* ÿßŸÑÿµŸÅ ÿßŸÑÿπŸÑŸàŸä */
        .square-21 { top: 0; left: 130px; transform: rotate(180deg); }
        .square-22 { top: 0; left: 220px; transform: rotate(180deg); }
        .square-23 { top: 0; left: 310px; transform: rotate(180deg); }
        .square-24 { top: 0; left: 400px; transform: rotate(180deg); }
        .square-25 { top: 0; left: 490px; transform: rotate(180deg); }
        .square-26 { top: 0; left: 580px; transform: rotate(180deg); }
        .square-27 { top: 0; left: 670px; transform: rotate(180deg); }
        .square-28 { top: 0; left: 760px; transform: rotate(180deg); }
        .square-29 { top: 0; left: 850px; transform: rotate(180deg); }
        .square-30 { top: 0; right: 0; }

        /* ÿßŸÑÿµŸÅ ÿßŸÑÿ£ŸäŸÖŸÜ */
        .square-31 { right: 0; top: 130px; transform: rotate(270deg); }
        .square-32 { right: 0; top: 220px; transform: rotate(270deg); }
        .square-33 { right: 0; top: 310px; transform: rotate(270deg); }
        .square-34 { right: 0; top: 400px; transform: rotate(270deg); }
        .square-35 { right: 0; top: 490px; transform: rotate(270deg); }
        .square-36 { right: 0; top: 580px; transform: rotate(270deg); }
        .square-37 { right: 0; top: 670px; transform: rotate(270deg); }
        .square-38 { right: 0; top: 760px; transform: rotate(270deg); }
        .square-39 { right: 0; top: 850px; transform: rotate(270deg); }

        /* ŸÖÿ±ŸÉÿ≤ ÿßŸÑŸÑŸàÿ≠ÿ© ŸÖÿπ ÿ¥ÿπÿßÿ± ÿπŸèŸÖÿßŸÜ */
        .game-board::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 45%;
            height: 45%;
            background: 
                radial-gradient(circle at center, rgba(220, 20, 60, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(220, 20, 60, 0.05) 100%);
            border-radius: 50%;
            border: 4px solid rgba(220, 20, 60, 0.3);
            backdrop-filter: blur(20px);
            box-shadow: 
                inset 0 0 30px rgba(255,255,255,0.1),
                0 0 40px rgba(220, 20, 60, 0.2);
        }

        .game-board::before {
            content: 'üá¥üá≤';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 80px;
            z-index: 5;
            text-shadow: 0 0 20px rgba(0,0,0,0.3);
            animation: flagWave 4s ease-in-out infinite;
        }

        @keyframes flagWave {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        /* ===========================================
           ÿπŸÜÿßÿµÿ± ÿ™ÿ≠ŸÉŸÖ ÿßŸÑŸÑÿπÿ®ÿ©
        =========================================== */
        .game-controls {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: var(--surface-glass);
            border-radius: var(--border-radius-large);
            backdrop-filter: blur(16px);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .control-button {
            background: var(--gradient-red);
            color: var(--text-primary);
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: var(--border-radius-medium);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-normal);
            font-family: 'Cairo', sans-serif;
            box-shadow: var(--shadow-medium);
        }

        .control-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-glow-red);
        }

        .control-button.green {
            background: var(--gradient-green);
        }

        .control-button.green:hover {
            box-shadow: var(--shadow-glow-green);
        }

        .control-button.gold {
            background: var(--gradient-gold);
            color: var(--text-dark);
        }

        .control-button.gold:hover {
            box-shadow: var(--shadow-glow-gold);
        }

        /* ===========================================
           ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
        =========================================== */
        .players-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .player-card {
            background: var(--surface-glass);
            border-radius: var(--border-radius-large);
            padding: 20px;
            backdrop-filter: blur(16px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition-normal);
        }

        .player-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-large);
            border-color: var(--oman-red);
        }

        .player-card h3 {
            color: var(--accent-gold);
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .player-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        /* ===========================================
           ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ™ÿ≠ŸÉŸÖ (ŸÖÿ∑ÿßÿ®ŸÇÿ© ŸÑÿ®ÿßŸÇŸä ÿßŸÑÿ£ŸÜÿ¥ÿ∑ÿ©)
        =========================================== */
        .game-controls {
            background: var(--surface-glass);
            border-radius: var(--border-radius-xl);
            padding: 30px;
            margin: 30px 0;
            backdrop-filter: blur(16px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-large);
        }

        .control-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-medium);
            background: var(--surface-board);
            color: var(--text-dark);
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            transition: var(--transition-normal);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent-gold);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.3);
        }

        .form-control:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .game-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius-medium);
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-normal);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            min-width: 150px;
            justify-content: center;
            box-shadow: var(--shadow-medium);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn:not(:disabled):hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-large);
        }

        .btn-primary {
            background: var(--gradient-red);
            color: var(--text-primary);
        }

        .btn-primary:not(:disabled):hover {
            box-shadow: var(--shadow-glow-red);
        }

        .btn-success {
            background: var(--gradient-green);
            color: var(--text-primary);
        }

        .btn-success:not(:disabled):hover {
            box-shadow: var(--shadow-glow-green);
        }

        .btn-warning {
            background: var(--gradient-gold);
            color: var(--text-dark);
        }

        .btn-warning:not(:disabled):hover {
            box-shadow: var(--shadow-glow-gold);
        }

        .btn-info {
            background: var(--gradient-red);
            color: var(--text-primary);
        }

        .btn-info:hover {
            box-shadow: var(--shadow-glow-red);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            box-shadow: 0 0 20px rgba(108, 117, 125, 0.4);
        }

        /* ===========================================
           Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑÿ∞ŸÉŸäÿ©
        =========================================== */
        .smart-player-selection {
            background: var(--surface-glass);
            border-radius: var(--border-radius-xl);
            padding: 0;
            margin: 30px 0;
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-large);
            overflow: hidden;
            animation: slideInUp 0.5s ease-out;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .selection-header {
            background: linear-gradient(135deg, var(--oman-red) 0%, #B71C1C 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .selection-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><defs><radialGradient id="a" cx="50%" cy="50%"><stop offset="0%" stop-color="rgba(255,255,255,0.1)"/><stop offset="100%" stop-color="rgba(255,255,255,0)"/></radialGradient></defs><circle cx="10" cy="10" r="10" fill="url(%23a)"><animate attributeName="cx" values="10;90;10" dur="3s" repeatCount="indefinite"/></circle></svg>');
            opacity: 0.3;
            animation: headerFlow 6s ease-in-out infinite;
        }

        @keyframes headerFlow {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .icon-wrapper {
            display: inline-block;
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .icon-wrapper i {
            font-size: 2.5rem;
            color: white;
        }

        .selection-header h2 {
            margin: 0 0 10px 0;
            font-size: 2.2rem;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-gold) 0%, #FFA000 100%);
            width: 0%;
            transition: width 0.5s ease-out;
            border-radius: 3px;
        }

        .selection-counter {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .selected-count {
            font-size: 1.8rem;
            color: var(--accent-gold);
            font-weight: 800;
        }

        .selection-modes {
            padding: 20px 30px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .mode-switcher {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .mode-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: var(--text-secondary);
            padding: 12px 20px;
            border-radius: var(--border-radius-medium);
            cursor: pointer;
            transition: var(--transition-normal);
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 140px;
            justify-content: center;
        }

        .mode-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .mode-btn.active {
            background: var(--gradient-gold);
            border-color: var(--accent-gold);
            color: var(--text-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow-gold);
        }

        .smart-selection-container {
            padding: 30px;
        }

        .smart-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-medium);
            padding: 20px;
            cursor: pointer;
            transition: var(--transition-normal);
            text-align: center;
        }

        .feature-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .feature-card.active {
            background: var(--gradient-green);
            border-color: var(--oman-green);
            color: white;
            transform: translateY(-3px);
            box-shadow: var(--shadow-glow-green);
        }

        .feature-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 1.5rem;
        }

        .feature-card.active .feature-icon {
            background: rgba(255, 255, 255, 0.2);
        }

        .feature-content h4 {
            margin: 0 0 8px 0;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .feature-content p {
            margin: 0;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .search-and-sort {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .search-box {
            position: relative;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-medium);
            background: var(--surface-board);
            color: var(--text-dark);
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            transition: var(--transition-normal);
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--accent-gold);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.3);
        }

        .students-interactive-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            padding: 0 30px;
            max-height: 500px;
            overflow-y: auto;
            margin-bottom: 30px;
        }

        .student-interactive-card {
            background: var(--surface-board);
            border: 2px solid transparent;
            border-radius: var(--border-radius-medium);
            padding: 20px;
            cursor: pointer;
            transition: var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .student-interactive-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .student-interactive-card:hover::before {
            left: 100%;
        }

        .student-interactive-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
            border-color: var(--oman-red);
        }

        .student-interactive-card.selected {
            background: var(--gradient-green);
            color: white;
            border-color: var(--oman-green);
            transform: translateY(-5px);
            box-shadow: var(--shadow-glow-green);
        }

        .student-interactive-card.selected .student-avatar {
            background: rgba(255, 255, 255, 0.2);
            border-color: white;
        }

        .student-avatar {
            width: 60px;
            height: 60px;
            background: var(--gradient-red);
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 1.5rem;
            color: white;
            font-weight: 700;
        }

        .student-name {
            text-align: center;
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .student-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .student-interactive-card.selected .student-stats {
            opacity: 1;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .selected-players-preview {
            padding: 0 30px 20px;
            border-top: 2px solid rgba(255, 255, 255, 0.1);
            margin-top: 20px;
        }

        .selected-players-preview h3 {
            color: var(--accent-gold);
            margin: 20px 0 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .selected-players-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            min-height: 100px;
        }

        .selected-player-card {
            background: var(--gradient-green);
            color: white;
            border-radius: var(--border-radius-medium);
            padding: 15px;
            text-align: center;
            position: relative;
            animation: slideInScale 0.3s ease-out;
        }

        @keyframes slideInScale {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .selected-player-card .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            color: white;
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .selected-player-card .remove-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            color: var(--text-muted);
            padding: 40px;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .manual-selection-container {
            padding: 30px;
        }

        .manual-selectors {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .manual-selector {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-medium);
            padding: 20px;
        }

        .manual-selector label {
            display: block;
            color: var(--text-secondary);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .selection-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.03);
            border-top: 2px solid rgba(255, 255, 255, 0.1);
        }

        .action-btn {
            padding: 15px 30px;
            border: none;
            border-radius: var(--border-radius-medium);
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-normal);
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 150px;
            justify-content: center;
        }

        .action-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .action-btn:not(:disabled):hover {
            transform: translateY(-3px);
        }

        .action-btn.primary {
            background: var(--gradient-green);
            color: white;
        }

        .action-btn.primary:not(:disabled):hover {
            box-shadow: var(--shadow-glow-green);
        }

        .action-btn.secondary {
            background: var(--gradient-gold);
            color: var(--text-dark);
        }

        .action-btn.secondary:hover {
            box-shadow: var(--shadow-glow-gold);
        }

        .action-btn.danger {
            background: var(--gradient-red);
            color: white;
        }

        .action-btn.danger:hover {
            box-shadow: var(--shadow-glow-red);
        }

        .selection-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .selection-header h2 {
            color: var(--accent-gold);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }

        .selection-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            align-items: end;
        }

        .class-selector, .student-select {
            background: var(--surface-board);
            border: 2px solid var(--oman-red);
            border-radius: var(--border-radius-medium);
            padding: 12px;
            font-size: 1rem;
            color: var(--text-dark);
            font-family: 'Cairo', sans-serif;
            width: 100%;
            transition: var(--transition-normal);
        }

        .class-selector:focus, .student-select:focus {
            outline: none;
            border-color: var(--accent-gold);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.3);
        }

        .selection-mode-controls {
            text-align: center;
        }

        .mode-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }

        .mode-btn {
            background: var(--surface-glass);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: var(--border-radius-medium);
            cursor: pointer;
            transition: var(--transition-normal);
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
        }

        .mode-btn.active, .mode-btn:hover {
            background: var(--gradient-red);
            border-color: var(--oman-red);
            color: var(--oman-white);
        }

        .player-selectors {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .player-selector {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: var(--border-radius-medium);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .player-selector label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .students-grid-container {
            margin: 20px 0;
        }

        .selected-students {
            background: var(--surface-elevated);
            padding: 15px;
            border-radius: var(--border-radius-medium);
            margin-bottom: 20px;
            border: 2px solid var(--oman-green);
        }

        .selected-students h4 {
            color: var(--oman-green);
            margin-bottom: 10px;
        }

        .selected-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .selected-student {
            background: var(--gradient-green);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .students-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            max-height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--border-radius-medium);
        }

        .student-card {
            background: var(--surface-board);
            color: var(--text-dark);
            padding: 15px;
            border-radius: var(--border-radius-medium);
            cursor: pointer;
            transition: var(--transition-normal);
            border: 2px solid transparent;
            text-align: center;
            font-weight: 600;
        }

        .student-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
            border-color: var(--oman-red);
        }

        .student-card.selected {
            background: var(--gradient-green);
            color: white;
            border-color: var(--oman-green);
            box-shadow: var(--shadow-glow-green);
        }

        .selection-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        /* ===========================================
           ÿßŸÑŸÜŸàÿßŸÅÿ∞ ÿßŸÑŸÖŸÜÿ®ÿ´ŸÇÿ©
        =========================================== */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
        }

        .modal-content {
            background: var(--surface-board);
            margin: 5% auto;
            padding: 30px;
            border-radius: var(--border-radius-xl);
            width: 90%;
            max-width: 600px;
            position: relative;
            box-shadow: var(--shadow-large);
            color: var(--text-dark);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .close {
            color: var(--text-muted);
            float: left;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .close:hover {
            color: var(--oman-red);
            transform: scale(1.1);
        }

        /* ===========================================
           ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© ÿßŸÑÿπÿµÿ±Ÿäÿ© ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÖÿÆÿ™ŸÑŸÅÿ©
        =========================================== */
        
        /* ÿßŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑŸÉÿ®Ÿäÿ±ÿ© */
        @media (min-width: 1200px) {
            .game-board {
                max-width: 1000px;
            }
            
            .corner-square {
                width: 140px;
                height: 140px;
            }
            
            .side-square {
                width: 90px;
                height: 140px;
            }
        }

        /* ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÑŸàÿ≠Ÿäÿ© */
        @media (max-width: 1024px) {
            .monopoly-container {
                padding: 15px;
            }

            .game-board {
                max-width: 800px;
            }

            .corner-square {
                width: 100px;
                height: 100px;
                font-size: 0.7rem !important;
            }

            .side-square {
                width: 65px;
                height: 100px;
            }

            .board-square {
                font-size: 0.65rem;
                padding: 6px 3px;
            }
        }

        /* ÿßŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑÿ∞ŸÉŸäÿ© */
        @media (max-width: 768px) {
            .monopoly-container {
                padding: 8px;
            }

            .game-title h1 {
                font-size: 1.8rem;
            }

            .game-title p {
                font-size: 0.9rem;
            }

            .game-board {
                max-width: 100%;
                margin: 15px auto;
                border-radius: 15px;
            }

            .corner-square {
                width: 70px;
                height: 70px;
                font-size: 0.6rem !important;
                border-radius: 12px !important;
            }

            .side-square {
                width: 45px;
                height: 70px;
                border-radius: 10px !important;
            }

            .board-square {
                font-size: 0.55rem;
                padding: 4px 2px;
                border-width: 2px;
            }

            .property-content {
                transform: scale(0.9);
            }

            .game-board::before {
                font-size: 50px !important;
            }
        }

        /* ÿßŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© */
        @media (max-width: 480px) {
            .game-board {
                border-radius: 12px;
                border-width: 4px;
            }

            .corner-square {
                width: 60px;
                height: 60px;
                font-size: 0.5rem !important;
            }

            .side-square {
                width: 35px;
                height: 60px;
            }

            .board-square {
                font-size: 0.45rem;
                padding: 2px 1px;
            }

            .game-board::before {
                font-size: 35px !important;
            }

            .game-board::after {
                width: 40%;
                height: 40%;
                border-width: 2px;
            }

            /* ÿ•ÿπÿßÿØÿ© ÿ™ŸÖŸàÿ∂ÿπ ÿßŸÑŸÖÿ±ÿ®ÿπÿßÿ™ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© */
            .square-1 { right: 80px; }
            .square-2 { right: 130px; }
            .square-3 { right: 180px; }
            .square-4 { right: 230px; }
            .square-5 { right: 280px; }
            .square-6 { right: 330px; }
            .square-7 { right: 380px; }
            .square-8 { right: 430px; }
            .square-9 { right: 480px; }

            .control-button {
                padding: 12px 24px;
                font-size: 1rem;
                margin: 8px;
            }

            .players-info {
                grid-template-columns: 1fr;
            }

            /* ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ™ÿ≠ŸÉŸÖ ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ© */
            .control-group {
                grid-template-columns: 1fr;
            }

            .game-buttons {
                flex-direction: column;
                gap: 10px;
            }

            .btn {
                width: 100%;
                min-width: auto;
            }

            /* Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ© */
            .smart-features {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 10px;
            }

            .feature-card {
                padding: 15px;
            }

            .feature-icon {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
                margin-bottom: 10px;
            }

            .search-and-sort {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .students-interactive-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
                gap: 10px;
                padding: 0 15px;
            }

            .student-interactive-card {
                padding: 15px;
            }

            .student-avatar {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
                margin-bottom: 10px;
            }

            .selected-players-list {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 10px;
            }

            .selection-actions {
                flex-direction: column;
                gap: 10px;
            }

            .action-btn {
                width: 100%;
                min-width: auto;
            }

            .mode-switcher {
                flex-direction: column;
                gap: 8px;
            }

            .mode-btn {
                min-width: auto;
            }

            /* Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ∑ŸÑÿßÿ® ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ© */
            .selection-controls {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .mode-buttons {
                flex-direction: column;
                gap: 8px;
            }

            .player-selectors {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .students-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 10px;
            }

            .student-card {
                padding: 10px;
                font-size: 0.9rem;
            }

            .selection-actions {
                flex-direction: column;
                gap: 10px;
            }
        }

        @media (max-width: 480px) {
            .game-title {
                padding: 20px;
            }

            .game-title h1 {
                font-size: 1.5rem;
            }

            .corner-square {
                width: 60px;
                height: 60px;
            }

            .side-square {
                width: 40px;
                height: 60px;
            }

            .board-square {
                font-size: 0.5rem;
                padding: 2px;
            }

            .control-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
                top: 10px;
            }

            #returnToIndex {
                right: 10px;
            }

            #soundToggle {
                right: 60px;
            }

            .student-selection-container {
                padding: 15px;
            }

            .students-grid {
                grid-template-columns: 1fr;
                max-height: 300px;
            }
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ŸÖÿ´Ÿäÿ±ÿ© ŸÑŸÑŸÖŸàŸÜŸàÿ®ŸàŸÑŸä */
        @keyframes landingEffect {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(255, 215, 0, 0.3); }
            100% { transform: scale(1); box-shadow: 0 0 0 20px rgba(255, 215, 0, 0); }
        }

        .landing-effect {
            animation: landingEffect 1s ease-out;
        }

        @keyframes cardSlideIn {
            0% { 
                transform: translateY(-100vh) rotateX(90deg);
                opacity: 0;
            }
            50% {
                transform: translateY(0) rotateX(45deg);
                opacity: 0.7;
            }
            100% { 
                transform: translateY(0) rotateX(0deg);
                opacity: 1;
            }
        }

        @keyframes cardSlideOut {
            0% { 
                transform: translateY(0) rotateX(0deg) scale(1);
                opacity: 1;
            }
            100% { 
                transform: translateY(-50px) rotateX(-15deg) scale(0.9);
                opacity: 0;
            }
        }

        .card-modal {
            perspective: 1000px;
            backdrop-filter: blur(5px);
        }

        .card-content {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border-radius: 20px;
            border: 3px solid;
            padding: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            max-width: 450px;
            transform-style: preserve-3d;
            color: white;
        }

        .card-content h2 {
            color: white !important;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }

        .card-text {
            font-size: 1.3em;
            margin: 20px 0;
            padding: 25px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            border-left: 5px solid #ffd700;
            color: #ffffff;
            font-weight: 600;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
        }

        .card-player {
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #2c3e50;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
            text-shadow: none;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .btn-execute {
            padding: 15px 35px;
            border: none;
            border-radius: 30px;
            color: white;
            font-weight: bold;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 20px;
        }

        .btn-execute:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .purchase-modal {
            backdrop-filter: blur(10px);
        }

        .purchase-content {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            max-width: 450px;
            border: 3px solid #28a745;
        }

        .property-details {
            background: rgba(40, 167, 69, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #28a745;
        }

        .property-details p {
            margin: 10px 0;
            font-weight: 500;
        }

        .purchase-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .btn-purchase, .btn-decline {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .btn-purchase {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .btn-decline {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .btn-purchase:hover, .btn-decline:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse-effect {
            animation: pulse 0.6s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.9); }
        }

        .message-achievement {
            background: linear-gradient(135deg, #FFD700, #FFA500) !important;
            border-left: 5px solid #FF8C00 !important;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4) !important;
        }

        .message-success {
            background: linear-gradient(135deg, #28a745, #20c997) !important;
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3) !important;
        }

        .message-error {
            background: linear-gradient(135deg, #dc3545, #c82333) !important;
            box-shadow: 0 8px 25px rgba(220, 53, 69, 0.3) !important;
        }

        .game-board {
            position: relative;
            overflow: visible;
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© ŸÑŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ */
        .card-modal .card-content[style*="border-color: #e74c3c"] {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
            box-shadow: 0 25px 50px rgba(231, 76, 60, 0.4);
        }

        .card-modal .card-content[style*="border-color: #3498db"] {
            background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
            box-shadow: 0 25px 50px rgba(52, 152, 219, 0.4);
        }

        .card-content .card-text {
            text-align: center;
            line-height: 1.6;
            letter-spacing: 0.5px;
        }

        .card-content .card-text p {
            margin: 0;
            color: white !important;
            font-size: 1.1em;
        }

        .btn-execute:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 12px 30px rgba(0,0,0,0.4);
        }

        .btn-execute:active {
            transform: translateY(-2px) scale(1.02);
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ¥ÿ±ÿßÿ° */
        .property-square.available {
            animation: availableProperty 2s infinite;
        }

        @keyframes availableProperty {
            0%, 100% { 
                box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.7);
                border-color: #2ecc71;
            }
            50% { 
                box-shadow: 0 0 0 8px rgba(46, 204, 113, 0.3);
                border-color: #27ae60;
            }
        }

        .property-square.owned {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: 3px solid #c0392b;
        }

        .property-square.owned::after {
            content: "ŸÖŸÖŸÑŸàŸÉ";
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ¥ÿ±ÿßÿ° */
        .purchase-content h2 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .property-details {
            background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #27ae60;
        }

        .property-details p {
            margin: 8px 0;
            font-weight: 600;
            color: #2c3e50;
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ≠ÿßŸÑŸä */
        .player-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid #dee2e6;
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            color: #2c3e50;
        }

        .player-card h3 {
            color: #2c3e50 !important;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .player-card .stats-grid {
            color: #34495e !important;
        }

        .player-card .stats-grid .stat-label {
            color: #7f8c8d !important;
            font-weight: 600;
        }

        .player-card .stats-grid .stat-value {
            color: #2c3e50 !important;
            font-weight: bold;
        }

        /* ÿ•ÿ∂ÿßŸÅÿ© ÿ™ŸÜÿ≥ŸäŸÇ ŸÑŸÑŸÜÿµŸàÿµ ÿßŸÑÿ£ÿÆÿ±Ÿâ ŸÅŸä ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© */
        .player-card .player-info {
            color: #2c3e50 !important;
        }

        .player-card .player-position-indicator {
            color: #34495e !important;
            font-weight: bold !important;
        }

        .player-card .stat-item div {
            color: #2c3e50 !important;
        }

        .player-card .stat-item div:last-child {
            color: #7f8c8d !important;
        }

        /* ÿ™ÿ£ŸÉÿØ ŸÖŸÜ Ÿàÿ∂Ÿàÿ≠ ÿßŸÑŸÜÿµŸàÿµ ŸÅŸä ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÜÿ¥ÿ∑ÿ© */
        .player-card.current-player .stat-item div {
            color: #fff !important;
        }

        .player-card.current-player .stat-item div:last-child {
            color: #ecf0f1 !important;
        }

        .player-card.current-player .player-info {
            color: #fff !important;
        }

        .player-card.current-player .player-position-indicator {
            color: #ecf0f1 !important;
        }

        /* ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÖŸÅŸÑÿ≥ÿ© */
        .player-card.bankrupt-player {
            background: linear-gradient(135deg, #7f8c8d, #95a5a6) !important;
            opacity: 0.6 !important;
            border: 3px solid #e74c3c !important;
            filter: grayscale(80%) !important;
            position: relative;
        }

        .player-card.bankrupt-player::after {
            content: "üíî ŸÖŸèŸÅŸÑŸêÿ≥";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            background: rgba(231, 76, 60, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.2em;
            border: 2px solid #c0392b;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 10;
        }

        .player-card.bankrupt-player h3,
        .player-card.bankrupt-player .stat-item div,
        .player-card.bankrupt-player .player-info {
            color: #7f8c8d !important;
        }

        .player-card.current-player {
            background: linear-gradient(135deg, #00d2ff, #3a7bd5, #667eea);
            border: 4px solid #fff;
            box-shadow: 0 0 40px rgba(0, 210, 255, 0.8), 0 0 80px rgba(58, 123, 213, 0.5);
            transform: scale(1.1);
            animation: currentPlayerPulse 2s infinite, bounce 1.5s ease-in-out infinite;
            z-index: 1000;
            position: relative;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ± ŸÑŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑÿ£ÿÆÿ±Ÿâ */
        .player-card:not(.current-player) {
            opacity: 0.75;
            transform: scale(0.95);
            transition: all 0.6s ease;
            filter: grayscale(15%) brightness(0.9);
        }

        .player-card:not(.current-player):hover {
            opacity: 0.9;
            transform: scale(1);
            filter: grayscale(0%) brightness(1);
        }

        @keyframes currentPlayerPulse {
            0%, 100% { 
                box-shadow: 0 0 40px rgba(0, 210, 255, 0.8), 0 0 80px rgba(58, 123, 213, 0.5);
                border-color: #fff;
            }
            50% { 
                box-shadow: 0 0 60px rgba(0, 210, 255, 1), 0 0 120px rgba(58, 123, 213, 0.8);
                border-color: #00d2ff;
            }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: scale(1.1) translateY(0);
            }
            40% {
                transform: scale(1.12) translateY(-5px);
            }
            60% {
                transform: scale(1.12) translateY(-3px);
            }
        }

        @keyframes floatDown {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(-30px);
            }
            100% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        @keyframes glow {
            0% {
                text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
            }
            100% {
                text-shadow: 0 0 20px rgba(255, 255, 255, 0.8), 0 0 30px rgba(255, 107, 107, 0.6);
            }
        }

        .player-card.current-player::before {
            content: "üéØ ÿßŸÑÿØŸàÿ± ÿßŸÑÿ¢ŸÜ";
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, #ff6b6b, #ffa500, #ff6b6b);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            animation: floatDown 1s ease-out, glow 2s ease-in-out infinite alternate;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.5);
            z-index: 1001;
            border: 2px solid white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        @keyframes borderRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .player-card.current-player h3 {
            color: #fff;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
            font-size: 1.4em;
            animation: textGlow 2s ease-in-out infinite alternate;
        }

        @keyframes textGlow {
            0% {
                text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
            }
            100% {
                text-shadow: 2px 2px 4px rgba(0,0,0,0.7), 0 0 15px rgba(255,255,255,0.6);
            }
        }

        @keyframes infoGlow {
            0% {
                box-shadow: 0 10px 30px rgba(0, 210, 255, 0.4);
            }
            100% {
                box-shadow: 0 15px 40px rgba(0, 210, 255, 0.7), 0 0 60px rgba(58, 123, 213, 0.3);
            }
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
            }
            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
            }
        }

        /* ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜÿ© */
        .student-card.interactive.enhanced {
            position: relative;
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid #e9ecef;
            overflow: hidden;
            min-height: 200px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .student-card.interactive.enhanced:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .student-card.interactive.enhanced.selected {
            border-color: #4CAF50;
            background: linear-gradient(145deg, #f8fff8, #ffffff);
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.3);
        }

        .card-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            opacity: 0.1;
            z-index: 0;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }

        .student-avatar-enhanced {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .avatar-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .avatar-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff6b35;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(255, 107, 53, 0.4);
        }

        .selection-indicator {
            position: relative;
        }

        .selection-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .student-card.selected .selection-circle {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            transform: scale(1.1);
        }

        .card-content {
            text-align: center;
            margin: 15px 0;
            position: relative;
            z-index: 1;
        }

        .student-name-enhanced {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0 0 8px 0;
            line-height: 1.4;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .student-meta {
            color: #6c757d;
            font-size: 12px;
            margin-bottom: 15px;
        }

        .card-footer {
            position: relative;
            z-index: 1;
            margin-top: auto;
        }

        .action-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 15px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 14px;
            color: #495057;
        }

        .student-card.selected .action-button {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
        }

        .action-text {
            font-weight: 500;
        }

        .action-icon {
            font-size: 12px;
        }

        .card-effects {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            border-radius: inherit;
            overflow: hidden;
        }

        .ripple-effect {
            position: absolute;
            background: rgba(76, 175, 80, 0.3);
            border-radius: 50%;
            transform: scale(0);
            pointer-events: none;
        }

        .ripple-effect.animate {
            animation: rippleAnimation 0.6s ease-out;
        }

        @keyframes rippleAnimation {
            to {
                transform: scale(1);
                opacity: 0;
            }
        }

        .success-animation {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            color: #4CAF50;
            display: none;
            align-items: center;
            justify-content: center;
            animation: successPop 1s ease-out;
        }

        @keyframes successPop {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0;
            }
        }

        @keyframes cardShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes bounceIn {
            0% {
                transform: translate(-50%, -50%) scale(0.3);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            to {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
        }

        .game-ready-notification {
            font-family: 'Cairo', sans-serif;
        }

        .notification-content {
            text-align: center;
        }

        .notification-icon {
            font-size: 48px;
            margin-bottom: 15px;
            animation: pulse 2s infinite;
        }

        .notification-text h3 {
            margin: 0 0 10px 0;
            font-size: 24px;
        }

        .notification-text p {
            margin: 0 0 15px 0;
            opacity: 0.9;
        }

        .ready-players {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin: 15px 0;
        }

        .ready-player {
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: 500;
        }

        .notification-start-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .notification-start-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* ÿ£ŸÜŸÖÿßÿ∑ ÿßÿÆÿ™Ÿäÿßÿ± ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜ */
        .players-count-selector {
            margin-top: 10px;
        }

        .players-count-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 12px;
            margin-bottom: 15px;
        }

        .player-count-option {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .player-count-option:hover {
            border-color: #007bff;
            background: #f8f9ff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.2);
        }

        .player-count-option.selected {
            border-color: #28a745;
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            transform: scale(1.05);
        }

        .player-count-option.selected::before {
            content: '‚úì';
            position: absolute;
            top: 5px;
            right: 8px;
            background: #28a745;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .option-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .option-label {
            font-size: 13px;
            color: #666;
            margin-bottom: 4px;
        }

        .option-number {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .player-count-option.selected .option-label,
        .player-count-option.selected .option-number {
            color: #155724;
        }

        /* ÿ™ŸÜÿ≥ŸäŸÇ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ≥ÿ¨ŸÜ */
        .jail-modal {
            animation: fadeIn 0.3s ease-out;
        }

        .jail-content {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 500px;
            width: 90%;
            border: 3px solid #e74c3c;
        }

        .jail-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .jail-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .jail-btn-try {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .jail-btn-try:hover {
            background: linear-gradient(45deg, #2980b9, #1f639b);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
        }

        .jail-btn-pay {
            background: linear-gradient(45deg, #e67e22, #d35400);
            color: white;
        }

        .jail-btn-pay:hover {
            background: linear-gradient(45deg, #d35400, #bf4f00);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(230, 126, 34, 0.4);
        }

        .jail-btn small {
            display: block;
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.8); }
        }

        /* ÿ™ŸÜÿ≥ŸäŸÇ ŸÜŸàÿßŸÅÿ∞ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥ */
        .bankruptcy-modal {
            animation: bankruptcySlideIn 0.5s ease-out;
        }

        .bankruptcy-content {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.7);
            max-width: 600px;
            width: 90%;
            border: 3px solid #e74c3c;
        }

        .bankruptcy-header h2 {
            margin: 0 0 10px 0;
            font-size: 2em;
        }

        .bankruptcy-warning {
            background: rgba(231, 76, 60, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #e74c3c;
            font-weight: bold;
        }

        .bankruptcy-details {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }

        .debt-info, .assets-info, .current-money {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }

        .debt-amount, .assets-amount, .money-amount {
            font-weight: bold;
            font-size: 1.2em;
        }

        .debt-amount {
            color: #e74c3c;
        }

        .assets-amount {
            color: #f39c12;
        }

        .money-amount.negative {
            color: #e74c3c;
        }

        .bankruptcy-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .bankruptcy-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .sell-btn {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
        }

        .sell-btn:hover {
            background: linear-gradient(45deg, #e67e22, #d35400);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(243, 156, 18, 0.4);
        }

        .bankrupt-btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
        }

        .bankrupt-btn:hover {
            background: linear-gradient(45deg, #c0392b, #a93226);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }

        .bankruptcy-btn small {
            display: block;
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }

        .bankruptcy-help {
            background: rgba(52, 152, 219, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            border: 2px solid #3498db;
            font-size: 14px;
        }

        @keyframes bankruptcySlideIn {
            from { 
                opacity: 0; 
                transform: translateY(-50px) scale(0.9); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        @keyframes bankruptcyExplosion {
            0% { 
                opacity: 0; 
                transform: translate(-50%, -50%) scale(0.5); 
            }
            20% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1.2); 
            }
            80% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1); 
            }
            100% { 
                opacity: 0; 
                transform: translate(-50%, -50%) scale(0.8); 
            }
        }

        .current-player-indicator {
            position: absolute;
            top: -10px;
            right: -10px;
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }

        .player-turn-status {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }

        .player-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }

        .action-hint {
            background: rgba(52, 152, 219, 0.1);
            border: 2px dashed #3498db;
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            text-align: center;
            color: #2c3e50;
            font-weight: 600;
            animation: hintBlink 2s infinite;
        }

        @keyframes hintBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .player-stats-enhanced {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }

        .stat-item {
            background: rgba(255,255,255,0.8);
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #3498db;
        }

        .current-player .stat-item {
            background: rgba(255,255,255,0.9);
            border-left-color: #e74c3c;
        }

        .player-position-indicator {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            margin-top: 5px;
            display: inline-block;
        }

        /* ŸÑŸàÿ≠ÿ© ÿßŸÑŸÇŸäÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿ™ÿ±ŸÅÿ© */
        .leaderboard-header {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.3);
        }

        .leaderboard-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.5em;
        }

        .leaderboard-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .leaderboard-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .leaderboard-player {
            background: white;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .leaderboard-player.first {
            border-color: #FFD700;
            background: linear-gradient(135deg, #fff9e6, #fff);
            box-shadow: 0 8px 30px rgba(255, 215, 0, 0.2);
        }

        .leaderboard-player.second {
            border-color: #C0C0C0;
            background: linear-gradient(135deg, #f8f9fa, #fff);
        }

        .leaderboard-player.third {
            border-color: #CD7F32;
            background: linear-gradient(135deg, #fdf7f0, #fff);
        }

        .leaderboard-player.other {
            border-color: #6c757d;
        }

        .leaderboard-player.current-player {
            transform: scale(1.02);
            box-shadow: 0 8px 30px rgba(0, 123, 255, 0.3);
            border-color: #007bff;
        }

        .leaderboard-player::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #007bff, #0056b3);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .leaderboard-player.current-player::before {
            opacity: 1;
        }

        .player-rank {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .rank-emoji {
            font-size: 2em;
        }

        .rank-number {
            font-size: 1.2em;
            font-weight: bold;
            color: #666;
        }

        .player-info {
            flex: 1;
        }

        .player-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }

        .player-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(248, 249, 250, 0.8);
            border-radius: 8px;
            border-left: 3px solid #007bff;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
        }

        .stat-value {
            font-weight: bold;
            color: #333;
        }

        .stat-value.total-worth {
            color: #28a745;
            font-size: 1.1em;
        }

        .player-achievements {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .achievement {
            background: linear-gradient(45deg, #17a2b8, #138496);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(23, 162, 184, 0.3);
        }

        @media (max-width: 768px) {
            .player-stats {
                grid-template-columns: 1fr;
            }
            
            .leaderboard-stats {
                flex-direction: column;
                gap: 5px;
            }
        }
    </style>
</head>

<body>
    <!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿπŸÑŸàŸäÿ© ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜÿ© -->
    <div class="top-controls-panel">
        <button id="returnToIndex" class="control-btn" title="ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©">
            <i class="fas fa-home"></i>
        </button>
        <button id="soundToggle" class="control-btn" title="ÿ™ÿ¥ÿ∫ŸäŸÑ/ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿµŸàÿ™">
            <i class="fas fa-volume-up"></i>
        </button>
        <button id="fullscreenToggle" class="control-btn" title="ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©">
            <i class="fas fa-expand"></i>
        </button>
        <button id="gameInfo" class="control-btn" title="ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©">
            <i class="fas fa-info-circle"></i>
        </button>
    </div>

    <!-- ÿßŸÑÿ≠ÿßŸàŸäÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© -->
    <div class="monopoly-container">
        <!-- ÿßŸÑÿπŸÜŸàÿßŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä -->
        <div class="game-title">
            <h1><i class="fas fa-building"></i> ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿ≥ŸÑÿ∑ŸÜÿ© ÿπŸèŸÖÿßŸÜ</h1>
            <p>ŸÑÿπÿ®ÿ© ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑÿπŸèŸÖÿßŸÜŸäÿ© ÿßŸÑÿ™ÿπŸÑŸäŸÖŸäÿ© - ÿßÿ≥ÿ™ŸÉÿ¥ŸÅ ŸÖÿπÿßŸÑŸÖ ÿ≥ŸÑÿ∑ŸÜÿ© ÿπŸèŸÖÿßŸÜ ÿßŸÑÿ¨ŸÖŸäŸÑÿ©</p>
        </div>

        <!-- ŸÑŸàÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ© -->
        <div class="game-board" id="gameBoard">
            <!-- ŸÖÿ±ÿ®ÿπÿßÿ™ ÿßŸÑŸÑŸàÿ≠ÿ© ÿ≥Ÿäÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ§Ÿáÿß ÿ®Ÿàÿßÿ≥ÿ∑ÿ© JavaScript -->
        </div>

        <!-- ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© -->
        <div class="game-controls">
            <div class="control-group">
                <div class="form-group">
                    <label for="classSelect">üìö ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿµŸÅ</label>
                    <select id="classSelect" class="form-control">
                        <option value="">ÿßÿÆÿ™ÿ± ÿßŸÑÿµŸÅ ÿßŸÑÿØÿ±ÿßÿ≥Ÿä</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="playersCount">üë• ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ</label>
                    <div class="players-count-selector">
                        <div class="players-count-options">
                            <div class="player-count-option" data-count="2">
                                <div class="option-icon">üë•</div>
                                <div class="option-label">ŸÑÿßÿπÿ®ÿßŸÜ</div>
                                <div class="option-number">2</div>
                            </div>
                            <div class="player-count-option" data-count="3">
                                <div class="option-icon">üë•üë§</div>
                                <div class="option-label">ÿ´ŸÑÿßÿ´ÿ©</div>
                                <div class="option-number">3</div>
                            </div>
                            <div class="player-count-option" data-count="4">
                                <div class="option-icon">üë•üë•</div>
                                <div class="option-label">ÿ£ÿ±ÿ®ÿπÿ©</div>
                                <div class="option-number">4</div>
                            </div>
                            <div class="player-count-option" data-count="5">
                                <div class="option-icon">üë•üë•üë§</div>
                                <div class="option-label">ÿÆŸÖÿ≥ÿ©</div>
                                <div class="option-number">5</div>
                            </div>
                            <div class="player-count-option" data-count="6">
                                <div class="option-icon">üë•üë•üë•</div>
                                <div class="option-label">ÿ≥ÿ™ÿ©</div>
                                <div class="option-number">6</div>
                            </div>
                        </div>
                    </div>
                    <select id="playersCount" class="form-control" style="display: none;">
                        <option value="2">üë• ŸÑÿßÿπÿ®ÿßŸÜ</option>
                        <option value="3">üë•üë§ ÿ´ŸÑÿßÿ´ÿ© ŸÑÿßÿπÿ®ŸäŸÜ</option>
                        <option value="4">üë•üë• ÿ£ÿ±ÿ®ÿπÿ© ŸÑÿßÿπÿ®ŸäŸÜ</option>
                        <option value="5">üë•üë•üë§ ÿÆŸÖÿ≥ÿ© ŸÑÿßÿπÿ®ŸäŸÜ</option>
                        <option value="6">üë•üë•üë• ÿ≥ÿ™ÿ© ŸÑÿßÿπÿ®ŸäŸÜ</option>
                    </select>
                </div>
            </div>

            <!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ© -->
            <div class="game-buttons">
                <button id="setupPlayersBtn" class="btn btn-primary" disabled>
                    <i class="fas fa-users-cog"></i>
                    ‚öôÔ∏è ÿ•ÿπÿØÿßÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
                </button>
                <button id="startGameBtn" class="btn btn-success" disabled>
                    <i class="fas fa-play"></i>
                    üé≤ ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ©
                </button>
                <button id="rollDice" class="btn btn-warning" disabled>
                    <i class="fas fa-dice"></i>
                    üé≤ ÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ
                </button>
                <button id="endTurn" class="btn btn-info" disabled>
                    <i class="fas fa-exchange-alt"></i>
                    üîÑ ÿ•ŸÜŸáÿßÿ° ÿßŸÑÿØŸàÿ±
                </button>
                <button id="showRules" class="btn btn-secondary">
                    <i class="fas fa-book"></i>
                    üìñ ŸÇŸàÿßÿπÿØ ÿßŸÑŸÑÿπÿ®ÿ©
                </button>
                <button id="testCards" class="btn btn-secondary" onclick="testCardDemo()">
                    <i class="fas fa-vial"></i>
                    üß™ ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™
                </button>
                <button id="testJail" class="btn btn-secondary" onclick="testJailDemo()">
                    <i class="fas fa-building"></i>
                    üèõÔ∏è ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ≥ÿ¨ŸÜ
                </button>
                <button id="testBankruptcy" class="btn btn-secondary" onclick="testBankruptcyDemo()">
                    <i class="fas fa-exclamation-triangle"></i>
                    üíî ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ•ŸÅŸÑÿßÿ≥
                </button>
            </div>
        </div>

        <!-- Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÖÿ®ÿ≥ÿ∑ÿ© -->
        <div class="smart-player-selection" id="smartPlayerSelection" style="display: none;">
            <div class="selection-header">
                <div class="header-content">
                    <div class="icon-wrapper">
                        <i class="fas fa-users"></i>
                    </div>
                    <h2>ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ</h2>
                    <p class="subtitle">ÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿßŸÑÿ∑ŸÑÿßÿ® ŸÑÿßÿÆÿ™Ÿäÿßÿ±ŸáŸÖ ŸÅŸä ÿßŸÑŸÑÿπÿ®ÿ©</p>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="selectionProgress"></div>
                </div>
                <div class="selection-counter">
                    <span class="selected-count" id="selectedPlayersCount">0</span>
                    <span class="separator">/</span>
                    <span class="total-count" id="totalPlayersNeeded">2</span>
                    <span class="label">ŸÑÿßÿπÿ®ŸäŸÜ ŸÖÿ≠ÿØÿØŸäŸÜ</span>
                </div>
            </div>

            <!-- ÿ¥ÿ®ŸÉÿ© ÿßŸÑÿ∑ŸÑÿßÿ® ÿßŸÑÿ™ŸÅÿßÿπŸÑŸäÿ© -->
            <div class="students-interactive-grid" id="studentsInteractiveGrid">
                <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®Ÿàÿßÿ≥ÿ∑ÿ© JavaScript -->
            </div>

            <!-- ÿπÿ±ÿ∂ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÖÿÆÿ™ÿßÿ±ŸäŸÜ -->
            <div class="selected-players-preview" id="selectedPlayersPreview">
                <h3>
                    <i class="fas fa-check-circle"></i>
                    ÿßŸÑŸÑÿßÿπÿ®ŸàŸÜ ÿßŸÑŸÖÿÆÿ™ÿßÿ±ŸàŸÜ
                </h3>
                <div class="selected-players-list" id="selectedPlayersList">
                    <div class="empty-state">
                        <i class="fas fa-user-plus"></i>
                        <p>ÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿßŸÑÿ∑ŸÑÿßÿ® ŸÑÿßÿÆÿ™Ÿäÿßÿ±ŸáŸÖ</p>
                    </div>
                </div>
            </div>

            <!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ -->
            <div class="selection-actions">
                <button class="action-btn secondary" id="clearSelection">
                    <i class="fas fa-undo"></i>
                    ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ
                </button>
                <button class="action-btn primary" id="confirmPlayerSelection" disabled>
                    <i class="fas fa-check"></i>
                    ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ±
                </button>
                <button class="action-btn danger" id="cancelPlayerSelection">
                    <i class="fas fa-times"></i>
                    ÿ•ŸÑÿ∫ÿßÿ°
                </button>
            </div>
        </div>

        <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ -->
        <div class="players-info" id="playersInfo">
            <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿ≥Ÿäÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ§Ÿáÿß ÿ®Ÿàÿßÿ≥ÿ∑ÿ© JavaScript -->
        </div>
    </div>

    <!-- ÿßŸÑŸÜŸàÿßŸÅÿ∞ ÿßŸÑŸÖŸÜÿ®ÿ´ŸÇÿ© -->
    <!-- ŸÜÿßŸÅÿ∞ÿ© ŸÇŸàÿßÿπÿØ ÿßŸÑŸÑÿπÿ®ÿ© -->
    <div id="rulesModal" class="modal">
        <div class="modal-content">
            <span class="close" data-modal="rulesModal">&times;</span>
            <h2><i class="fas fa-book"></i> ŸÇŸàÿßÿπÿØ ŸÑÿπÿ®ÿ© ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿπŸèŸÖÿßŸÜ</h2>
            <div style="max-height: 400px; overflow-y: auto; margin-top: 20px;">
                <h3>üéØ ÿßŸÑŸáÿØŸÅ ŸÖŸÜ ÿßŸÑŸÑÿπÿ®ÿ©:</h3>
                <p>ÿ¥ÿ±ÿßÿ° ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑÿπŸèŸÖÿßŸÜŸäÿ© Ÿàÿ™ÿ∑ŸàŸäÿ±Ÿáÿß ŸÑÿ™ÿ≠ŸÇŸäŸÇ ÿ£ŸÉÿ®ÿ± ÿ±ÿ®ÿ≠ ŸÖŸÖŸÉŸÜ.</p>
                
                <h3>üé≤ ŸÉŸäŸÅŸäÿ© ÿßŸÑŸÑÿπÿ®:</h3>
                <ul>
                    <li>ŸÉŸÑ ŸÑÿßÿπÿ® Ÿäÿ®ÿØÿ£ ÿ®ŸÖÿ®ŸÑÿ∫ 1500 ÿ±ŸäÿßŸÑ ÿπŸèŸÖÿßŸÜŸä</li>
                    <li>ÿßÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ Ÿàÿ™ÿ≠ÿ±ŸÉ ÿπŸÑŸâ ÿßŸÑŸÑŸàÿ≠ÿ©</li>
                    <li>ÿßÿ¥ÿ™ÿ± ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™Ÿáÿ®ÿ∑ ÿπŸÑŸäŸáÿß</li>
                    <li>ÿßÿ¨ŸÖÿπ ÿßŸÑÿ•Ÿäÿ¨ÿßÿ± ŸÖŸÜ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑÿ¢ÿÆÿ±ŸäŸÜ</li>
                    <li>ÿ∑Ÿàÿ± ÿπŸÇÿßÿ±ÿßÿ™ŸÉ ŸÑÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ•Ÿäÿ¨ÿßÿ±</li>
                </ul>
                
                <h3>üè† ÿ£ŸÜŸàÿßÿπ ÿßŸÑŸÖÿ±ÿ®ÿπÿßÿ™:</h3>
                <ul>
                    <li><strong>ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™:</strong> ŸäŸÖŸÉŸÜ ÿ¥ÿ±ÿßÿ§Ÿáÿß Ÿàÿ™ÿ∑ŸàŸäÿ±Ÿáÿß</li>
                    <li><strong>ÿßŸÑŸÖÿ≠ÿ∑ÿßÿ™:</strong> ÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑŸÜŸÇŸÑ ÿßŸÑÿπŸèŸÖÿßŸÜŸäÿ©</li>
                    <li><strong>ÿßŸÑŸÖÿ±ÿßŸÅŸÇ:</strong> ÿßŸÑŸÉŸáÿ±ÿ®ÿßÿ° ŸàÿßŸÑŸÖŸäÿßŸá</li>
                    <li><strong>ÿßŸÑÿ∂ÿ±ÿßÿ¶ÿ®:</strong> ÿßÿØŸÅÿπ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ≠ÿØÿØ</li>
                    <li><strong>ÿßŸÑŸÅÿ±ÿµÿ© ŸàÿßŸÑÿµŸÜÿØŸàŸÇ:</strong> ÿßÿ≥ÿ≠ÿ® ÿ®ÿ∑ÿßŸÇÿ©</li>
                </ul>
                
                <h3>üèÜ ÿßŸÑŸÅŸàÿ≤:</h3>
                <p>ÿ¢ÿÆÿ± ŸÑÿßÿπÿ® Ÿäÿ®ŸÇŸâ ŸÅŸä ÿßŸÑŸÑÿπÿ®ÿ© (ŸÑŸÖ ŸäŸÅŸÑÿ≥) ŸäŸÉŸàŸÜ ÿßŸÑŸÅÿßÿ¶ÿ≤!</p>
            </div>
        </div>
    </div>

    <!-- ŸÜÿßŸÅÿ∞ÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÇÿßÿ± -->
    <div id="propertyModal" class="modal">
        <div class="modal-content">
            <span class="close" data-modal="propertyModal">&times;</span>
            <div id="propertyInfo">
                <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÇÿßÿ± ÿ≥Ÿäÿ™ŸÖ ÿπÿ±ÿ∂Ÿáÿß ŸáŸÜÿß -->
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // ===========================================
        // ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©
        // ===========================================
        
        // ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑÿπŸèŸÖÿßŸÜŸäÿ©
        const omanProperties = [
            // ÿßŸÑÿµŸÅ ÿßŸÑÿ≥ŸÅŸÑŸä
            { id: 0, name: "ÿßŸÑÿ®ÿØÿßŸäÿ©", type: "start", price: 0, color: "special" },
            { id: 1, name: "ÿµÿ≠ÿßÿ±", type: "property", price: 60, color: "brown", rent: [2, 10, 30, 90, 160, 250] },
            { id: 2, name: "ÿµŸÜÿØŸàŸÇ ÿßŸÑŸÖÿ¨ÿ™ŸÖÿπ", type: "community", price: 0, color: "special" },
            { id: 3, name: "ÿßŸÑÿ±ÿ≥ÿ™ÿßŸÇ", type: "property", price: 60, color: "brown", rent: [4, 20, 60, 180, 320, 450] },
            { id: 4, name: "ÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑÿØÿÆŸÑ", type: "tax", price: 200, color: "special" },
            { id: 5, name: "ŸÖÿ∑ÿßÿ± ŸÖÿ≥ŸÇÿ∑", type: "airport", price: 200, color: "railroad", rent: [25, 50, 100, 200] },
            { id: 6, name: "ŸÖÿ∑ÿ±ÿ≠", type: "property", price: 100, color: "light-blue", rent: [6, 30, 90, 270, 400, 550] },
            { id: 7, name: "ÿßŸÑŸÅÿ±ÿµÿ©", type: "chance", price: 0, color: "special" },
            { id: 8, name: "ÿßŸÑÿÆŸàŸäÿ±", type: "property", price: 100, color: "light-blue", rent: [6, 30, 90, 270, 400, 550] },
            { id: 9, name: "ÿßŸÑŸÇÿ±ŸÖ", type: "property", price: 120, color: "light-blue", rent: [8, 40, 100, 300, 450, 600] },
            
            // ÿßŸÑÿµŸÅ ÿßŸÑÿ£Ÿäÿ≥ÿ±
            { id: 10, name: "ÿßŸÑÿ≥ÿ¨ŸÜ/ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©", type: "jail", price: 0, color: "special" },
            { id: 11, name: "ÿµŸÑÿßŸÑÿ©", type: "property", price: 140, color: "pink", rent: [10, 50, 150, 450, 625, 750] },
            { id: 12, name: "ÿ¥ÿ±ŸÉÿ© ÿßŸÑŸÉŸáÿ±ÿ®ÿßÿ°", type: "utility", price: 150, color: "utility", rent: [4, 10] },
            { id: 13, name: "ÿ∑ÿßŸÇÿ©", type: "property", price: 140, color: "pink", rent: [10, 50, 150, 450, 625, 750] },
            { id: 14, name: "ŸÖÿ±ÿ®ÿßÿ∑", type: "property", price: 160, color: "pink", rent: [12, 60, 180, 500, 700, 900] },
            { id: 15, name: "ŸÖÿ∑ÿßÿ± ÿµŸÑÿßŸÑÿ©", type: "airport", price: 200, color: "railroad", rent: [25, 50, 100, 200] },
            { id: 16, name: "ŸÜÿ≤ŸàŸâ", type: "property", price: 180, color: "orange", rent: [14, 70, 200, 550, 750, 950] },
            { id: 17, name: "ÿµŸÜÿØŸàŸÇ ÿßŸÑŸÖÿ¨ÿ™ŸÖÿπ", type: "community", price: 0, color: "special" },
            { id: 18, name: "ÿ®ŸáŸÑÿß", type: "property", price: 180, color: "orange", rent: [14, 70, 200, 550, 750, 950] },
            { id: 19, name: "ÿßŸÑÿ≠ŸÖÿ±ÿßÿ°", type: "property", price: 200, color: "orange", rent: [16, 80, 220, 600, 800, 1000] },
            
            // ÿßŸÑÿµŸÅ ÿßŸÑÿπŸÑŸàŸä
            { id: 20, name: "ŸÖŸàŸÇŸÅ ŸÖÿ¨ÿßŸÜŸä", type: "free", price: 0, color: "special" },
            { id: 21, name: "ÿµŸàÿ±", type: "property", price: 220, color: "red", rent: [18, 90, 250, 700, 875, 1050] },
            { id: 22, name: "ÿßŸÑŸÅÿ±ÿµÿ©", type: "chance", price: 0, color: "special" },
            { id: 23, name: "ÿßŸÑŸÉÿßŸÖŸÑ ŸàÿßŸÑŸàÿßŸÅŸä", type: "property", price: 220, color: "red", rent: [18, 90, 250, 700, 875, 1050] },
            { id: 24, name: "ÿ¨ÿπŸÑÿßŸÜ ÿ®ŸÜŸä ÿ®ŸàÿπŸÑŸä", type: "property", price: 240, color: "red", rent: [20, 100, 300, 750, 925, 1100] },
            { id: 25, name: "ŸÖÿ∑ÿßÿ± ÿµŸàÿ±", type: "airport", price: 200, color: "railroad", rent: [25, 50, 100, 200] },
            { id: 26, name: "ÿßŸÑÿÆÿßÿ®Ÿàÿ±ÿ©", type: "property", price: 260, color: "yellow", rent: [22, 110, 330, 800, 975, 1150] },
            { id: 27, name: "ÿßŸÑÿ≥ŸàŸäŸÇ", type: "property", price: 260, color: "yellow", rent: [22, 110, 330, 800, 975, 1150] },
            { id: 28, name: "ÿ¥ÿ±ŸÉÿ© ÿßŸÑŸÖŸäÿßŸá", type: "utility", price: 150, color: "utility", rent: [4, 10] },
            { id: 29, name: "ÿ¥ŸÜÿßÿµ", type: "property", price: 280, color: "yellow", rent: [24, 120, 360, 850, 1025, 1200] },
            
            // ÿßŸÑÿµŸÅ ÿßŸÑÿ£ŸäŸÖŸÜ
            { id: 30, name: "ÿßÿ∞Ÿáÿ® ŸÑŸÑÿ≥ÿ¨ŸÜ", type: "go-to-jail", price: 0, color: "special" },
            { id: 31, name: "ÿ•ÿ®ÿ±ÿßÿ°", type: "property", price: 300, color: "green", rent: [26, 130, 390, 900, 1100, 1275] },
            { id: 32, name: "ÿßŸÑŸÇÿßÿ®ŸÑ", type: "property", price: 300, color: "green", rent: [26, 130, 390, 900, 1100, 1275] },
            { id: 33, name: "ÿµŸÜÿØŸàŸÇ ÿßŸÑŸÖÿ¨ÿ™ŸÖÿπ", type: "community", price: 0, color: "special" },
            { id: 34, name: "ÿ®ÿØŸäÿ©", type: "property", price: 320, color: "green", rent: [28, 150, 450, 1000, 1200, 1400] },
            { id: 35, name: "ŸÖÿ∑ÿßÿ± ÿßŸÑÿØŸÇŸÖ", type: "airport", price: 200, color: "railroad", rent: [25, 50, 100, 200] },
            { id: 36, name: "ÿßŸÑŸÅÿ±ÿµÿ©", type: "chance", price: 0, color: "special" },
            { id: 37, name: "ÿÆÿµÿ®", type: "property", price: 350, color: "dark-blue", rent: [35, 175, 500, 1100, 1300, 1500] },
            { id: 38, name: "ÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑÿ™ÿ±ŸÅ", type: "tax", price: 100, color: "special" },
            { id: 39, name: "ŸÖÿ≥ŸÜÿØŸÖ", type: "property", price: 400, color: "dark-blue", rent: [50, 200, 600, 1400, 1700, 2000] }
        ];

        // ===========================================
        // ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ÿßŸÑŸÖÿ∑Ÿàÿ±ÿ©
        // ===========================================
        let gameState = {
            players: [],
            currentPlayer: 0,
            gameStarted: false,
            soundEnabled: true,
            turn: 1,
            doubles: 0,
            lastRoll: { dice1: 0, dice2: 0, total: 0 },
            gameMode: 'competitive', // ÿ™ŸÜÿßŸÅÿ≥Ÿä
            animations: true,
            leaderboard: [],
            achievements: {},
            gameHistory: []
        };

        let playerData = {};

        // ===========================================
        // ÿ£ŸÜÿ∏ŸÖÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©
        // ===========================================
        
        // ŸÜÿ∏ÿßŸÖ ÿßŸÑÿµŸàÿ™ ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÅŸä
        class SoundSystem {
            constructor() {
                this.sounds = {
                    dice: new Audio('../assets/media/sounds/Click.mp3'),
                    buy: new Audio('../assets/media/sounds/Notification.mp3'),
                    money: new Audio('../assets/media/sounds/select.mp3'),
                    win: new Audio('../assets/media/sounds/win.mp3'),
                    lose: new Audio('../assets/media/sounds/wrong_answer.mp3'),
                    select: new Audio('../assets/media/sounds/select.mp3'),
                    achievement: new Audio('../assets/media/sounds/kingdom-sounds/achievement-unlock.mp3'),
                    victory: new Audio('../assets/media/sounds/kingdom-sounds/battle-victory.mp3'),
                    bonus: new Audio('../assets/media/sounds/kingdom-sounds/bonus-collect.mp3'),
                    countdown: new Audio('../assets/media/sounds/kingdom-sounds/countdown-tick.mp3'),
                    explosion: new Audio('../assets/media/sounds/kingdom-sounds/cosmic-explosion.mp3'),
                    cheer: new Audio('../assets/media/sounds/kingdom-sounds/crowd-cheer.mp3'),
                    bell: new Audio('../assets/media/sounds/kingdom-sounds/ancient-bell.mp3')
                };
                this.enabled = true;
                this.volume = 0.7;
                this.setupVolume();
            }

            setupVolume() {
                Object.values(this.sounds).forEach(sound => {
                    sound.volume = this.volume;
                });
            }

            play(soundName, volume = 1.0) {
                if (this.enabled && this.sounds[soundName]) {
                    const sound = this.sounds[soundName];
                    sound.volume = this.volume * volume;
                    sound.currentTime = 0;
                    sound.play().catch(e => console.log('ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿµŸàÿ™:', e));
                }
            }

            playSequence(sounds, delay = 500) {
                sounds.forEach((sound, index) => {
                    setTimeout(() => this.play(sound), index * delay);
                });
            }

            toggle() {
                this.enabled = !this.enabled;
                return this.enabled;
            }

            setVolume(volume) {
                this.volume = Math.max(0, Math.min(1, volume));
                this.setupVolume();
            }
        }

        // ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÅŸä
        class MessageSystem {
            static show(message, type = 'info', duration = 3000, isImportant = false) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `game-message ${type} ${isImportant ? 'important' : ''}`;
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ŸäŸÇŸàŸÜÿßÿ™ ŸÑŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
                const icons = {
                    success: '‚úÖ',
                    error: '‚ùå',
                    warning: '‚ö†Ô∏è',
                    info: '‚ÑπÔ∏è',
                    money: 'üí∞',
                    achievement: 'üèÜ',
                    dice: 'üé≤'
                };
                
                const icon = icons[type] || icons.info;
                messageDiv.innerHTML = `<span class="message-icon">${icon}</span><span class="message-text">${message}</span>`;
                
                messageDiv.style.cssText = `
                    position: fixed;
                    top: ${isImportant ? '50%' : '100px'};
                    ${isImportant ? 'left: 50%; transform: translateX(-50%) translateY(-50%);' : 'right: 20px;'}
                    background: ${isImportant ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : 'var(--surface-glass)'};
                    color: white;
                    padding: ${isImportant ? '25px 35px' : '15px 20px'};
                    border-radius: var(--border-radius-medium);
                    border: 2px solid var(--oman-${type === 'error' ? 'red' : 'green'});
                    backdrop-filter: blur(16px);
                    box-shadow: ${isImportant ? '0 20px 40px rgba(0,0,0,0.3)' : 'var(--shadow-medium)'};
                    z-index: ${isImportant ? '10002' : '10001'};
                    animation: ${isImportant ? 'bounceIn' : 'slideInRight'} 0.5s ease-out;
                    font-weight: 600;
                    font-size: ${isImportant ? '18px' : '14px'};
                    max-width: ${isImportant ? '400px' : '300px'};
                    text-align: center;
                `;

                document.body.appendChild(messageDiv);

                // ÿ™ÿ£ÿ´Ÿäÿ± ÿÆÿßÿµ ŸÑŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸÖŸáŸÖÿ©
                if (isImportant) {
                    confetti({
                        particleCount: 100,
                        spread: 70,
                        origin: { y: 0.6 }
                    });
                }

                setTimeout(() => {
                    messageDiv.style.animation = isImportant ? 'bounceOut 0.5s ease-in' : 'slideOutRight 0.3s ease-in';
                    setTimeout(() => {
                        if (messageDiv.parentNode) {
                            messageDiv.parentNode.removeChild(messageDiv);
                        }
                    }, isImportant ? 500 : 300);
                }, duration);
            }

            static showTurnAnnouncement(playerName, turnNumber) {
                this.show(`üéØ ÿØŸàÿ± ${playerName} - ÿßŸÑÿ¨ŸàŸÑÿ© ${turnNumber}`, 'info', 4000, true);
            }

            static showMoneyTransaction(player, amount, isReceiving = true) {
                const action = isReceiving ? 'ÿ≠ÿµŸÑ ÿπŸÑŸâ' : 'ÿØŸÅÿπ';
                const icon = isReceiving ? 'üí∞‚¨ÜÔ∏è' : 'üí∞‚¨áÔ∏è';
                this.show(`${icon} ${player} ${action} ${Math.abs(amount)} ÿ±.ÿπ`, 'money', 3000);
            }

            static showPropertyPurchase(player, property, price) {
                this.show(`üè† ${player} ÿßÿ¥ÿ™ÿ±Ÿâ ${property} ŸÖŸÇÿßÿ®ŸÑ ${price} ÿ±.ÿπ`, 'success', 4000);
            }

            static showRentPayment(payer, receiver, property, amount) {
                this.show(`üèòÔ∏è ${payer} ÿØŸÅÿπ ${amount} ÿ±.ÿπ ÿ•Ÿäÿ¨ÿßÿ± ${property} ŸÑŸÄ ${receiver}`, 'warning', 4000);
            }

            static clear() {
                // ÿ•ÿ≤ÿßŸÑÿ© ÿ¨ŸÖŸäÿπ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ≠ÿßŸÑŸäÿ©
                const messages = document.querySelectorAll('.game-message');
                messages.forEach(message => {
                    if (message.parentNode) {
                        message.parentNode.removeChild(message);
                    }
                });
            }
        }

        // ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ£ŸÜÿ∏ŸÖÿ©
        const soundSystem = new SoundSystem();

        // ===========================================
        // ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™ ŸàÿßŸÑŸÇŸäÿßÿØÿ©
        // ===========================================
        class AchievementSystem {
            static achievements = {
                'first_property': { name: 'ÿ£ŸàŸÑ ÿπŸÇÿßÿ±', description: 'ÿßÿ¥ÿ™ÿ± ÿ£ŸàŸÑ ÿπŸÇÿßÿ± ŸÑŸÉ', icon: 'üè†', unlocked: false },
                'monopoly_master': { name: 'ÿ≥ŸäÿØ ÿßŸÑÿßÿ≠ÿ™ŸÉÿßÿ±', description: 'ÿßŸÖÿ™ŸÑŸÉ ŸÖÿ¨ŸÖŸàÿπÿ© ŸÉÿßŸÖŸÑÿ©', icon: 'üëë', unlocked: false },
                'millionaire': { name: 'ÿßŸÑŸÖŸÑŸäŸàŸÜŸäÿ±', description: 'ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 2000 ÿ±.ÿπ', icon: 'üíé', unlocked: false },
                'lucky_roller': { name: 'ŸÖÿ≠ÿ∏Ÿàÿ∏ ÿßŸÑŸÜÿ±ÿØ', description: 'ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ ÿ≤Ÿàÿ¨Ÿä 3 ŸÖÿ±ÿßÿ™ ŸÖÿ™ÿ™ÿßŸÑŸäÿ©', icon: 'üé≤', unlocked: false },
                'rent_collector': { name: 'ÿ¨ÿßŸÖÿπ ÿßŸÑÿ•Ÿäÿ¨ÿßÿ±ÿßÿ™', description: 'ÿßÿ¨ŸÖÿπ 500 ÿ±.ÿπ ŸÖŸÜ ÿßŸÑÿ•Ÿäÿ¨ÿßÿ±ÿßÿ™', icon: 'üí∞', unlocked: false },
                'speed_buyer': { name: 'ŸÖÿ¥ÿ™ÿ±Ÿä ÿ≥ÿ±Ÿäÿπ', description: 'ÿßÿ¥ÿ™ÿ± 3 ÿπŸÇÿßÿ±ÿßÿ™ ŸÅŸä 3 ÿ£ÿØŸàÿßÿ±', icon: '‚ö°', unlocked: false }
            };

            static checkAchievement(player, type, data = {}) {
                const playerId = player.name;
                if (!gameState.achievements[playerId]) {
                    gameState.achievements[playerId] = {};
                }

                switch (type) {
                    case 'first_property':
                        if (player.properties.length === 1 && !gameState.achievements[playerId].first_property) {
                            this.unlockAchievement(playerId, 'first_property');
                        }
                        break;
                    case 'millionaire':
                        if (player.money >= 2000 && !gameState.achievements[playerId].millionaire) {
                            this.unlockAchievement(playerId, 'millionaire');
                        }
                        break;
                    case 'monopoly_master':
                        if (this.hasMonopoly(player) && !gameState.achievements[playerId].monopoly_master) {
                            this.unlockAchievement(playerId, 'monopoly_master');
                        }
                        break;
                    case 'lucky_roller':
                        if (data.consecutiveDoubles >= 3 && !gameState.achievements[playerId].lucky_roller) {
                            this.unlockAchievement(playerId, 'lucky_roller');
                        }
                        break;
                }
            }

            static unlockAchievement(playerId, achievementId) {
                gameState.achievements[playerId][achievementId] = true;
                const achievement = this.achievements[achievementId];
                
                MessageSystem.show(`üèÜ ${playerId} ÿ≠ÿµŸÑ ÿπŸÑŸâ ÿ•ŸÜÿ¨ÿßÿ≤: ${achievement.name}!`, 'achievement', 5000, true);
                soundSystem.play('achievement');
                
                // ÿ™ÿ£ÿ´Ÿäÿ± ÿÆÿßÿµ ŸÑŸÑÿ•ŸÜÿ¨ÿßÿ≤
                confetti({
                    particleCount: 150,
                    spread: 120,
                    origin: { y: 0.6 },
                    colors: ['#FFD700', '#FFA500', '#FF6347']
                });
            }

            static hasMonopoly(player) {
                const colorGroups = {};
                player.properties.forEach(propId => {
                    const prop = omanProperties[propId];
                    if (prop.type === 'property') {
                        if (!colorGroups[prop.color]) colorGroups[prop.color] = 0;
                        colorGroups[prop.color]++;
                    }
                });

                const monopolyCounts = {
                    'brown': 2, 'light-blue': 3, 'pink': 3, 'orange': 3,
                    'red': 3, 'yellow': 3, 'green': 3, 'dark-blue': 2
                };

                return Object.keys(colorGroups).some(color => 
                    colorGroups[color] === monopolyCounts[color]
                );
            }
        }

        // ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÑŸàÿ≠ÿ© ÿßŸÑŸÇŸäÿßÿØŸäÿ© ÿßŸÑŸÖÿ≠ÿ™ÿ±ŸÅ
        class LeaderboardSystem {
            static updateLeaderboard() {
                const leaderboardDiv = document.getElementById('leaderboard');
                if (!leaderboardDiv) return;

                // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿµÿßŸÅŸäÿ© ŸÑŸÉŸÑ ŸÑÿßÿπÿ®
                const playersWithNetWorth = gameState.players.map((player, index) => {
                    // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®
                    validatePlayerData(player);
                    
                    const propertyValue = this.calculatePropertyValue(player);
                    const netWorth = (player.money || 0) + propertyValue;
                    
                    return {
                        ...player,
                        index,
                        propertyValue,
                        netWorth,
                        propertiesCount: player.properties ? player.properties.length : 0
                    };
                });

                // ÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿ≠ÿ≥ÿ® ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿµÿßŸÅŸäÿ©
                playersWithNetWorth.sort((a, b) => b.netWorth - a.netWorth);

                // ÿ•ŸÜÿ¥ÿßÿ° HTML ŸÑŸÑŸàÿ≠ÿ© ÿßŸÑŸÇŸäÿßÿØŸäÿ©
                leaderboardDiv.innerHTML = `
                    <div class="leaderboard-header">
                        <h3>üèÜ ŸÑŸàÿ≠ÿ© ÿßŸÑŸÇŸäÿßÿØÿ©</h3>
                        <div class="leaderboard-stats">
                            <span>ÿßŸÑŸÖÿ±ÿ≠ŸÑÿ©: ${gameState.currentRound}</span>
                            <span>ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ≠ÿßŸÑŸä: ${gameState.players[gameState.currentPlayer]?.name}</span>
                        </div>
                    </div>
                    <div class="leaderboard-list">
                        ${playersWithNetWorth.map((player, rank) => this.createPlayerCard(player, rank)).join('')}
                    </div>
                `;

                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ŸÅŸä ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
                this.updatePlayerCards();
            }

            static calculatePropertyValue(player) {
                if (!player || !player.properties || !Array.isArray(player.properties)) {
                    return 0;
                }
                
                return player.properties.reduce((total, propertyId) => {
                    const property = omanProperties[propertyId];
                    if (property && typeof property.price === 'number') {
                        return total + property.price;
                    }
                    return total;
                }, 0);
            }

            static createPlayerCard(player, rank) {
                const rankEmoji = ['ü•á', 'ü•à', 'ü•â', 'üèÖ'][rank] || 'üèÖ';
                const rankClass = ['first', 'second', 'third', 'other'][rank] || 'other';
                
                return `
                    <div class="leaderboard-player ${rankClass}" data-player="${player.index}">
                        <div class="player-rank">
                            <span class="rank-emoji">${rankEmoji}</span>
                            <span class="rank-number">#${rank + 1}</span>
                        </div>
                        <div class="player-info">
                            <div class="player-name">${player.name}</div>
                            <div class="player-stats">
                                <div class="stat">
                                    <span class="stat-label">üí∞ ÿßŸÑÿ£ŸÖŸàÿßŸÑ:</span>
                                    <span class="stat-value">${formatMoney(player.money)}</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">üè† ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™:</span>
                                    <span class="stat-value">${formatMoney(player.propertyValue)}</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">üìä ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿµÿßŸÅŸäÿ©:</span>
                                    <span class="stat-value total-worth">${formatMoney(player.netWorth)}</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">üèòÔ∏è ÿπÿØÿØ ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™:</span>
                                    <span class="stat-value">${player.propertiesCount}</span>
                                </div>
                            </div>
                        </div>
                        <div class="player-achievements">
                            ${this.getPlayerAchievements(player)}
                        </div>
                    </div>
                `;
            }

            static getPlayerAchievements(player) {
                const achievements = [];
                
                if (player.properties.length >= 1) {
                    achievements.push('<span class="achievement">üè† ŸÖÿßŸÑŸÉ ÿπŸÇÿßÿ±</span>');
                }
                
                if (player.money >= 1000) {
                    achievements.push('<span class="achievement">üí∞ ŸÖŸÑŸäŸàŸÜŸäÿ±</span>');
                }
                
                if (player.properties.length >= 5) {
                    achievements.push('<span class="achievement">üèòÔ∏è ŸÖÿ∑Ÿàÿ± ÿπŸÇÿßÿ±Ÿä</span>');
                }
                
                return achievements.join('');
            }

            static updatePlayerCards() {
                gameState.players.forEach((player, index) => {
                    // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®
                    validatePlayerData(player);
                    
                    const playerElement = document.querySelector(`[data-player="${index}"]`);
                    if (playerElement) {
                        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ŸÅŸä ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÑÿßÿπÿ®
                        const moneyElement = playerElement.querySelector('.money');
                        if (moneyElement) {
                            moneyElement.textContent = formatMoney(player.money);
                        }
                        
                        const propertiesElement = playerElement.querySelector('.properties-count');
                        if (propertiesElement) {
                            propertiesElement.textContent = player.properties ? player.properties.length : 0;
                        }
                    }
                });
            }

            static highlightCurrentPlayer() {
                // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ™ŸÖŸäŸäÿ≤ ŸÖŸÜ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
                document.querySelectorAll('.leaderboard-player').forEach(el => {
                    el.classList.remove('current-player');
                });
                
                // ÿ™ŸÖŸäŸäÿ≤ ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ≠ÿßŸÑŸä
                const currentPlayerElement = document.querySelector(`[data-player="${gameState.currentPlayer}"]`);
                if (currentPlayerElement) {
                    currentPlayerElement.classList.add('current-player');
                }
            }

            static calculateNetWorth(player) {
                if (!player || typeof player.money !== 'number') {
                    return 0;
                }
                
                let netWorth = player.money || 0;
                
                if (player.properties && Array.isArray(player.properties)) {
                    player.properties.forEach(propId => {
                        const prop = omanProperties[propId];
                        if (prop && typeof prop.price === 'number') {
                            netWorth += prop.price;
                        }
                    });
                }
                
                return netWorth;
            }

            static showLeaderboard() {
                this.updateLeaderboard();
                const modal = document.getElementById('leaderboardModal');
                const content = document.getElementById('leaderboardContent');
                
                content.innerHTML = gameState.leaderboard.map(entry => `
                    <div class="leaderboard-entry rank-${entry.rank}">
                        <div class="rank">${entry.rank === 1 ? 'üëë' : entry.rank}</div>
                        <div class="player-name">${entry.name}</div>
                        <div class="net-worth">${entry.netWorth} ÿ±.ÿπ</div>
                        <div class="properties">${entry.properties} ÿπŸÇÿßÿ±</div>
                    </div>
                `).join('');
                
                modal.style.display = 'block';
            }
        }

        // ===========================================
        // ŸÜÿ∏ÿßŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ®ÿ≥ÿ∑ ŸàÿßŸÑŸÅÿπÿßŸÑ
        // ===========================================
        async function loadStudentData() {
            console.log('üîÑ ÿ®ÿØÿ° ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿßÿ®...');
            MessageSystem.show('ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿßÿ®...', 'info', 2000);
            
            try {
                // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖÿ≥ÿßÿ± ÿßŸÑÿµÿ≠Ÿäÿ≠
                let dataURL;
                if (window.location.hostname.includes('github.io')) {
                    // ŸÖÿ≥ÿßÿ± GitHub Pages
                    const pathParts = window.location.pathname.split('/');
                    const repoName = pathParts[1];
                    dataURL = `/${repoName}/data/studentData.json`;
                } else {
                    // ŸÖÿ≥ÿßÿ± ŸÖÿ≠ŸÑŸä
                    dataURL = '../data/studentData.json';
                }
                
                console.log(`üìÇ ŸÖÿ≠ÿßŸàŸÑÿ© ÿ™ÿ≠ŸÖŸäŸÑ ŸÖŸÜ: ${dataURL}`);
                
                const response = await fetch(dataURL);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('üìã ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≠ŸÖŸÑÿ©:', data);
                
                // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®
                const formattedData = {};
                for (const [className, students] of Object.entries(data)) {
                    if (Array.isArray(students) && students.length > 0) {
                        formattedData[className] = students.map((studentName, index) => ({
                            name: studentName,
                            id: `${className.replace(/ /g, '_')}_${index + 1}`,
                            gender: studentName.includes('ŸÅÿßÿ∑ŸÖÿ©') || studentName.includes('ÿ≥ÿßÿ±ÿ©') || 
                                   studentName.includes('ŸÜŸàÿ±ÿß') || studentName.includes('ÿπÿßÿ¶ÿ¥ÿ©') || 
                                   studentName.includes('ŸÖÿ±ŸäŸÖ') || studentName.includes('ŸáÿØŸâ') ? 'female' : 'male'
                        }));
                    }
                }
                
                playerData = formattedData;
                const totalStudents = Object.values(data).flat().length;
                const totalClasses = Object.keys(data).length;
                
                console.log(`‚úÖ ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ${totalStudents} ÿ∑ÿßŸÑÿ® ŸÖŸÜ ${totalClasses} ÿµŸÅ`);
                MessageSystem.clear();
                MessageSystem.show(`‚úÖ ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ${totalStudents} ÿ∑ÿßŸÑÿ® ŸÖŸÜ ${totalClasses} ÿµŸÅ`, 'success', 3000);
                
                return true;
                
            } catch (error) {
                console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:', error);
                
                // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©
                console.log('üîÑ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©...');
                playerData = {
                    "5ÿ£": [
                        { name: "ÿ£ÿ≠ŸÖÿØ ŸÖÿ≠ŸÖÿØ ÿßŸÑÿ¥ÿ±ŸÇŸä", gender: "male", id: "5ÿ£_1" },
                        { name: "ÿ≥ÿßÿ±ÿ© ÿπŸÑŸä ÿßŸÑÿ®Ÿàÿ≥ÿπŸäÿØŸä", gender: "female", id: "5ÿ£_2" },
                        { name: "ŸÖÿ≠ŸÖÿØ ÿπÿ®ÿØÿßŸÑŸÑŸá ÿßŸÑŸáŸÜÿßÿ¶Ÿä", gender: "male", id: "5ÿ£_3" },
                        { name: "ŸÅÿßÿ∑ŸÖÿ© ÿ≥ÿßŸÑŸÖ ÿßŸÑŸÅÿßÿ±ÿ≥Ÿä", gender: "female", id: "5ÿ£_4" },
                        { name: "ŸäŸàÿ≥ŸÅ ÿÆÿßŸÑÿØ ÿßŸÑŸÖÿπŸÖÿ±Ÿä", gender: "male", id: "5ÿ£_5" }
                    ],
                    "5ÿ®": [
                        { name: "ŸÜŸàÿ±ÿß ÿ≠ŸÖÿØ ÿßŸÑÿ≠ÿßÿ±ÿ´Ÿä", gender: "female", id: "5ÿ®_1" },
                        { name: "ÿ≥ŸÑÿ∑ÿßŸÜ ÿ±ÿßÿ¥ÿØ ÿßŸÑÿπÿ®ÿ±Ÿä", gender: "male", id: "5ÿ®_2" },
                        { name: "ÿπÿßÿ¶ÿ¥ÿ© ÿ≥ÿπŸäÿØ ÿßŸÑŸÉŸÜÿØŸä", gender: "female", id: "5ÿ®_3" },
                        { name: "ÿ≤ŸäÿßÿØ ÿ£ÿ≠ŸÖÿØ ÿßŸÑÿ±Ÿàÿßÿ≠Ÿä", gender: "male", id: "5ÿ®_4" }
                    ],
                    "6ÿ£": [
                        { name: "ŸÖÿ±ŸäŸÖ ŸäŸàÿ≥ŸÅ ÿßŸÑÿ∫ÿßŸÅÿ±Ÿä", gender: "female", id: "6ÿ£_1" },
                        { name: "ÿπÿ®ÿØÿßŸÑÿ±ÿ≠ŸÖŸÜ ŸÖÿ≠ŸÖÿØ ÿßŸÑÿµÿßŸÑÿ≠Ÿä", gender: "male", id: "6ÿ£_2" },
                        { name: "ŸáÿØŸâ ÿ≥ŸÑŸäŸÖÿßŸÜ ÿßŸÑÿ≠ÿ®ÿ≥Ÿä", gender: "female", id: "6ÿ£_3" },
                        { name: "ÿ∑ÿßÿ±ŸÇ ŸÅŸäÿµŸÑ ÿßŸÑÿ¥ÿ≠Ÿä", gender: "male", id: "6ÿ£_4" }
                    ]
                };
                
                MessageSystem.clear();
                MessageSystem.show('‚ö†Ô∏è ÿ™ŸÖ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©', 'warning', 3000);
                console.log('‚úÖ ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©');
                
                return false;
            }
        }

        // ===========================================
        // ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ Ÿàÿ•ÿØÿßÿ±ÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
        // ===========================================
        let selectedPlayers = [];
        let currentStudents = [];

        // ŸÖŸÑÿ° ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿµŸÅŸàŸÅ ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÅŸäÿ©
        function populateClassSelect() {
            console.log('üìö ÿ®ÿØÿ° ŸÖŸÑÿ° ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿµŸÅŸàŸÅ...');
            const classSelect = document.getElementById('classSelect');
            const setupBtn = document.getElementById('setupPlayersBtn');
            
            if (!classSelect) {
                console.error('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿπŸÜÿµÿ± classSelect');
                return;
            }
            
            // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑŸÇÿßÿ¶ŸÖÿ©
            classSelect.innerHTML = '<option value="">ÿßÿÆÿ™ÿ± ÿßŸÑÿµŸÅ ÿßŸÑÿØÿ±ÿßÿ≥Ÿä</option>';
            
            if (playerData && Object.keys(playerData).length > 0) {
                console.log(`üìä ÿπÿØÿØ ÿßŸÑÿµŸÅŸàŸÅ ÿßŸÑŸÖÿ™ÿßÿ≠ÿ©: ${Object.keys(playerData).length}`);
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑÿµŸÅŸàŸÅ
                Object.keys(playerData).forEach(className => {
                    const studentCount = playerData[className].length;
                    const option = document.createElement('option');
                    option.value = className;
                    option.textContent = `${className} (${studentCount} ÿ∑ÿßŸÑÿ®)`;
                    classSelect.appendChild(option);
                    console.log(`‚ûï ÿ•ÿ∂ÿßŸÅÿ© ÿµŸÅ: ${className} - ${studentCount} ÿ∑ÿßŸÑÿ®`);
                });
                
                console.log('‚úÖ ÿ™ŸÖ ŸÖŸÑÿ° ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿµŸÅŸàŸÅ ÿ®ŸÜÿ¨ÿßÿ≠');
            } else {
                console.warn('‚ö†Ô∏è ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ÿ∑ŸÑÿßÿ®');
                // ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™ŸÉŸÜ ŸáŸÜÿßŸÉ ÿ®ŸäÿßŸÜÿßÿ™ÿå ÿ£ÿ∂ŸÅ ÿ±ÿ≥ÿßŸÑÿ© ÿ™ŸÜÿ®ŸäŸá
                const option = document.createElement('option');
                option.value = "";
                option.textContent = "‚ùå ŸÅÿ¥ŸÑ ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿßÿ® - ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÖŸÑŸÅ studentData.json";
                option.disabled = true;
                classSelect.appendChild(option);
                
                MessageSystem.show('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿßÿ®! ÿ™ÿ£ŸÉÿØ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ŸÖŸÑŸÅ data/studentData.json ŸàÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿÆÿßÿØŸÖ', 'error', 10000);
            }
            
            // ÿ•ÿπÿØÿßÿØ ÿ≠ÿØÿ´ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿµŸÅ
            classSelect.addEventListener('change', () => {
                if (setupBtn) {
                    const playersCount = document.getElementById('playersCount').value;
                    setupBtn.disabled = !classSelect.value || !playersCount;
                    
                    if (classSelect.value && playerData[classSelect.value]) {
                        const studentCount = playerData[classSelect.value].length;
                        MessageSystem.show(`üìö ÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± "${classSelect.value}" - Ÿäÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ${studentCount} ÿ∑ÿßŸÑÿ®`, 'success', 3000);
                    }
                }
            });
            
            console.log('üîß ÿ™ŸÖ ÿ•ÿπÿØÿßÿØ ŸÖÿ≥ÿ™ŸÖÿπ ÿ£ÿ≠ÿØÿßÿ´ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿµŸÅ');
        }

        // ÿ•ÿπÿØÿßÿØ Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑÿ®ÿ≥Ÿäÿ∑ÿ© (ŸÖÿ´ŸÑ ŸÖŸÑŸÅ 4.html)
        function setupSmartPlayerSelection() {
            const classValue = document.getElementById('classSelect').value;
            const playersCount = parseInt(document.getElementById('playersCount').value);
            
            console.log('üéØ ÿ•ÿπÿØÿßÿØ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ŸÑŸÑÿµŸÅ:', classValue, 'ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ:', playersCount);
            
            if (!classValue) {
                console.warn('‚ö†Ô∏è ŸÑŸÖ Ÿäÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ÿµŸÅ');
                MessageSystem.show('Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿµŸÅ ÿ£ŸàŸÑÿßŸã!', 'error');
                return;
            }

            if (!playersCount || playersCount < 2 || playersCount > 6) {
                MessageSystem.show('Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ (2-6)!', 'error');
                return;
            }

            if (!playerData || Object.keys(playerData).length === 0) {
                console.error('‚ùå playerData ŸÅÿßÿ±ÿ∫ ÿ£Ÿà ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ');
                MessageSystem.show('‚ùå ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ÿ∑ŸÑÿßÿ®! Ÿäÿ¨ÿ® ÿ™ÿ≠ŸÖŸäŸÑ ŸÖŸÑŸÅ studentData.json ÿ£ŸàŸÑÿßŸã', 'error', 10000);
                
                // ŸÖÿ≠ÿßŸàŸÑÿ© ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                console.log('üîÑ ŸÖÿ≠ÿßŸàŸÑÿ© ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™...');
                loadStudentData().then((success) => {
                    if (success) {
                        console.log('‚úÖ ÿ™ŸÖ ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠');
                        populateClassSelect();
                        MessageSystem.show('‚úÖ ÿ™ŸÖ ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿßÿ®! ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ', 'success');
                    } else {
                        console.error('‚ùå ŸÅÿ¥ŸÑ ŸÅŸä ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™');
                    }
                });
                return;
            }

            if (!playerData[classValue]) {
                console.error('‚ùå ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿµŸÅ:', classValue);
                console.log('üîç ÿßŸÑÿµŸÅŸàŸÅ ÿßŸÑŸÖÿ™ÿßÿ≠ÿ©:', Object.keys(playerData));
                MessageSystem.show('ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ÿ∑ŸÑÿßÿ® ŸÑŸáÿ∞ÿß ÿßŸÑÿµŸÅ!', 'error');
                return;
            }

            const students = playerData[classValue];
            if (students.length < playersCount) {
                MessageSystem.show(`ÿßŸÑÿµŸÅ Ÿäÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ${students.length} ÿ∑ÿßŸÑÿ® ŸÅŸÇÿ∑ÿå ŸÑÿß ŸäŸÖŸÉŸÜ ÿßÿÆÿ™Ÿäÿßÿ± ${playersCount} ŸÑÿßÿπÿ®ŸäŸÜ!`, 'error');
                return;
            }

            // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
            selectedPlayers = [];
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿπÿØÿßÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®
            document.getElementById('totalPlayersNeeded').textContent = playersCount;
            
            // ÿπÿ±ÿ∂ Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑÿ™ŸÅÿßÿπŸÑŸäÿ©
            displayStudentsInteractiveGrid(students);
            
            // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸàÿßÿ¨Ÿáÿ©
            const selectionDiv = document.getElementById('smartPlayerSelection');
            selectionDiv.style.display = 'block';
            
            MessageSystem.show(`ÿßÿÆÿ™ÿ± ${playersCount} ÿ∑ŸÑÿßÿ® ŸÖŸÜ ${classValue} ŸÑŸÑŸÖÿ¥ÿßÿ±ŸÉÿ© ŸÅŸä ÿßŸÑŸÑÿπÿ®ÿ©! ÔøΩ`, 'info', 4000);
            
            // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿ•ŸÑŸâ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
            setTimeout(() => {
                selectionDiv.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center' 
                });
            }, 100);
        }
        
        // ÿπÿ±ÿ∂ ÿ¥ÿ®ŸÉÿ© ÿßŸÑÿ∑ŸÑÿßÿ® ÿßŸÑÿ™ŸÅÿßÿπŸÑŸäÿ©
        function displayStudentsInteractiveGrid(students) {
            const gridContainer = document.getElementById('studentsInteractiveGrid');
            
            if (!gridContainer) {
                console.error('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ studentsInteractiveGrid');
                return;
            }
            
            // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑÿ¥ÿ®ŸÉÿ©
            gridContainer.innerHTML = '';
            
            // ÿ•ŸÜÿ¥ÿßÿ° ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑÿ∑ŸÑÿßÿ®
            students.forEach((student, index) => {
                const card = createSimpleStudentCard(student, index);
                gridContainer.appendChild(card);
            });
            
            console.log(`‚úÖ ÿ™ŸÖ ÿπÿ±ÿ∂ ${students.length} ÿ®ÿ∑ÿßŸÇÿ© ÿ∑ÿßŸÑÿ®`);
        }

        // ÿØÿßŸÑÿ© ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ© ŸÖÿπ ÿßŸÑÿ∑ŸÑÿßÿ® ÿßŸÑŸÖÿÆÿ™ÿßÿ±ŸäŸÜ
        function startGameWithStudents() {
            if (!gameState.players || gameState.players.length < 2) {
                MessageSystem.show('Ÿäÿ¨ÿ® ÿ•ÿπÿØÿßÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿ£ŸàŸÑÿßŸã!', 'error');
                return;
            }
            
            startGame();
        }

        // ÿ•ŸÜÿ¥ÿßÿ° ÿ®ÿ∑ÿßŸÇÿ© ÿ∑ÿßŸÑÿ® ŸÖÿ≠ÿ≥ŸëŸÜÿ© Ÿàÿ™ŸÅÿßÿπŸÑŸäÿ©
        function createSimpleStudentCard(student, index) {
            const card = document.createElement('div');
            card.className = 'student-card interactive enhanced';
            card.setAttribute('data-student-id', student.id || student.name);
            
            // ÿ£ŸÑŸàÿßŸÜ ŸÖÿ™ŸÜŸàÿπÿ© ŸÑŸÑÿ®ÿ∑ÿßŸÇÿßÿ™
            const cardColors = [
                'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
                'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
                'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)',
                'linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)',
                'linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)'
            ];
            
            const cardColor = cardColors[index % cardColors.length];
            
            card.innerHTML = `
                <div class="card-background" style="background: ${cardColor}; opacity: 0.1; position: absolute; top: 0; left: 0; right: 0; bottom: 0; border-radius: inherit;"></div>
                <div class="card-header">
                    <div class="student-avatar-enhanced">
                        <div class="avatar-circle" style="background: ${cardColor};">
                            <span class="avatar-letter">${student.name.charAt(0)}</span>
                        </div>
                        <div class="avatar-badge">
                            <span>${index + 1}</span>
                        </div>
                    </div>
                    <div class="selection-indicator">
                        <div class="selection-circle">
                            <i class="fas fa-plus"></i>
                        </div>
                    </div>
                </div>
                <div class="card-content">
                    <h4 class="student-name-enhanced" title="${student.name}">${student.name}</h4>
                    <div class="student-meta">
                        <span class="student-id">ÿ∑ÿßŸÑÿ® ÿ±ŸÇŸÖ: ${index + 1}</span>
                    </div>
                </div>
                <div class="card-footer">
                    <div class="action-button">
                        <span class="action-text">ÿßŸÜŸÇÿ± ŸÑŸÑÿßÿÆÿ™Ÿäÿßÿ±</span>
                        <i class="fas fa-hand-pointer action-icon"></i>
                    </div>
                </div>
                <div class="card-effects">
                    <div class="ripple-effect"></div>
                    <div class="success-animation">
                        <i class="fas fa-check-circle"></i>
                    </div>
                </div>
            `;
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿ™ŸÅÿßÿπŸÑŸäÿ©
            card.addEventListener('mouseenter', () => {
                if (!card.classList.contains('selected')) {
                    card.style.transform = 'translateY(-8px) scale(1.02)';
                    card.style.boxShadow = '0 15px 35px rgba(0,0,0,0.2)';
                }
            });
            
            card.addEventListener('mouseleave', () => {
                if (!card.classList.contains('selected')) {
                    card.style.transform = 'translateY(0) scale(1)';
                    card.style.boxShadow = '0 5px 15px rgba(0,0,0,0.1)';
                }
            });
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ≠ÿØÿ´ ÿßŸÑŸÜŸÇÿ± ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™
            card.addEventListener('click', (e) => {
                // ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑŸÖŸàÿ¨ÿ© ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ±
                createRippleEffect(e, card);
                setTimeout(() => {
                    toggleEnhancedStudentSelection(card, student, index);
                }, 100);
            });
            
            return card;
        }

        // ÿ™ÿ®ÿØŸäŸÑ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ∑ÿßŸÑÿ® ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜ
        function toggleEnhancedStudentSelection(card, student, index) {
            const playersNeeded = parseInt(document.getElementById('totalPlayersNeeded').textContent);
            const isSelected = selectedPlayers.some(p => p.id === (student.id || student.name));
            
            if (isSelected) {
                // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ∑ÿßŸÑÿ® ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™
                deselectStudentCard(card, student);
            } else {
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ∑ÿßŸÑÿ® ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™
                if (selectedPlayers.length >= playersNeeded) {
                    showMaxPlayersReachedAnimation(card);
                    return;
                }
                
                selectStudentCard(card, student, index);
            }
            
            updateSelectionUI();
        }
        
        // ÿ•ŸÜÿ¥ÿßÿ° ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑŸÖŸàÿ¨ÿ© ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ±
        function createRippleEffect(e, element) {
            const ripple = element.querySelector('.ripple-effect');
            const rect = element.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;
            
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = x + 'px';
            ripple.style.top = y + 'px';
            ripple.classList.add('animate');
            
            setTimeout(() => {
                ripple.classList.remove('animate');
            }, 600);
        }
        
        // ÿßÿÆÿ™Ÿäÿßÿ± ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ∑ÿßŸÑÿ®
        function selectStudentCard(card, student, index) {
            // ÿ•ÿ∂ÿßŸÅÿ© ŸÑŸÑŸÇÿßÿ¶ŸÖÿ©
            selectedPlayers.push({
                id: student.id || student.name,
                name: student.name,
                index: index
            });
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ∏Ÿáÿ± ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
            card.classList.add('selected');
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ£ŸäŸÇŸàŸÜÿßÿ™ ŸàÿßŸÑŸÜÿµŸàÿµ
            const selectionCircle = card.querySelector('.selection-circle');
            const actionText = card.querySelector('.action-text');
            const actionIcon = card.querySelector('.action-icon');
            const successAnimation = card.querySelector('.success-animation');
            
            selectionCircle.innerHTML = '<i class="fas fa-check"></i>';
            selectionCircle.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
            actionText.textContent = 'ÿ™ŸÖ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ±';
            actionIcon.className = 'fas fa-check action-icon';
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑŸÜÿ¨ÿßÿ≠
            successAnimation.style.display = 'flex';
            setTimeout(() => {
                successAnimation.style.display = 'none';
            }, 1000);
            
            // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿµŸàÿ™Ÿäÿ©
            soundSystem.play('select');
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ŸÑŸÑÿ®ÿ∑ÿßŸÇÿ©
            card.style.transform = 'translateY(-5px) scale(1.05)';
            card.style.boxShadow = '0 10px 30px rgba(76, 175, 80, 0.3)';
            
            // ŸÅÿ≠ÿµ ÿßŸÉÿ™ŸÖÿßŸÑ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ±
            const playersNeeded = parseInt(document.getElementById('totalPlayersNeeded').textContent);
            if (selectedPlayers.length === playersNeeded) {
                setTimeout(() => {
                    showSelectionCompleteAnimation();
                }, 500);
            }
        }
        
        // ÿ•ŸÑÿ∫ÿßÿ° ÿßÿÆÿ™Ÿäÿßÿ± ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ∑ÿßŸÑÿ®
        function deselectStudentCard(card, student) {
            // ÿ•ÿ≤ÿßŸÑÿ© ŸÖŸÜ ÿßŸÑŸÇÿßÿ¶ŸÖÿ©
            selectedPlayers = selectedPlayers.filter(p => p.id !== (student.id || student.name));
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ∏Ÿáÿ± ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
            card.classList.remove('selected');
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿ£ŸäŸÇŸàŸÜÿßÿ™ ŸàÿßŸÑŸÜÿµŸàÿµ
            const selectionCircle = card.querySelector('.selection-circle');
            const actionText = card.querySelector('.action-text');
            const actionIcon = card.querySelector('.action-icon');
            
            selectionCircle.innerHTML = '<i class="fas fa-plus"></i>';
            selectionCircle.style.background = 'linear-gradient(135deg, #6c757d, #495057)';
            actionText.textContent = 'ÿßŸÜŸÇÿ± ŸÑŸÑÿßÿÆÿ™Ÿäÿßÿ±';
            actionIcon.className = 'fas fa-hand-pointer action-icon';
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑÿ®ÿµÿ±Ÿäÿ©
            card.style.transform = 'translateY(0) scale(1)';
            card.style.boxShadow = '0 5px 15px rgba(0,0,0,0.1)';
            
            // ÿµŸàÿ™ ÿßŸÑÿ•ŸÑÿ∫ÿßÿ°
            soundSystem.play('Click');
        }
        
        // ÿ•ÿ∏Ÿáÿßÿ± ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑŸàÿµŸàŸÑ ŸÑŸÑÿ≠ÿØ ÿßŸÑÿ£ŸÇÿµŸâ
        function showMaxPlayersReachedAnimation(card) {
            const playersNeeded = parseInt(document.getElementById('totalPlayersNeeded').textContent);
            
            // ÿ±ÿ≥ÿßŸÑÿ© ÿ™ÿ≠ÿ∞Ÿäÿ±Ÿäÿ©
            MessageSystem.show(`üö´ ÿ™ŸÖ ÿßŸÑŸàÿµŸàŸÑ ŸÑŸÑÿ≠ÿØ ÿßŸÑÿ£ŸÇÿµŸâ! ŸäŸÖŸÉŸÜ ÿßÿÆÿ™Ÿäÿßÿ± ${playersNeeded} ŸÑÿßÿπÿ®ŸäŸÜ ŸÅŸÇÿ∑`, 'warning', 3000);
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸáÿ™ÿ≤ÿßÿ≤ ŸÑŸÑÿ®ÿ∑ÿßŸÇÿ©
            card.style.animation = 'cardShake 0.6s ease-in-out';
            card.style.borderColor = '#ff4757';
            
            setTimeout(() => {
                card.style.animation = '';
                card.style.borderColor = '';
            }, 600);
            
            // ÿµŸàÿ™ ÿÆÿ∑ÿ£
            soundSystem.play('wrong_answer');
        }
        
        // ÿ•ÿ∏Ÿáÿßÿ± ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÉÿ™ŸÖÿßŸÑ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ±
        function showSelectionCompleteAnimation() {
            const playersNeeded = parseInt(document.getElementById('totalPlayersNeeded').textContent);
            
            // ÿ•ÿÆŸÅÿßÿ° ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ ÿ∫Ÿäÿ± ÿßŸÑŸÖÿÆÿ™ÿßÿ±ÿ© ÿ™ÿØÿ±Ÿäÿ¨ŸäÿßŸã
            const allCards = document.querySelectorAll('.student-card:not(.selected)');
            allCards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '0.3';
                    card.style.transform = 'scale(0.9)';
                    card.style.filter = 'blur(2px)';
                    card.style.pointerEvents = 'none';
                }, index * 100);
            });
            
            // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑŸÉŸàŸÜŸÅŸäÿ™Ÿä
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#4CAF50', '#2196F3', '#FF9800', '#E91E63']
            });
            
            // ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑŸÜÿ¨ÿßÿ≠
            MessageSystem.show(`üéâ ŸÖŸÖÿ™ÿßÿ≤! ÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ${playersNeeded} ŸÑÿßÿπÿ®ŸäŸÜ ÿ®ŸÜÿ¨ÿßÿ≠`, 'success', 4000);
            
            // ÿµŸàÿ™ ÿßŸÑŸÜÿ¨ÿßÿ≠
            soundSystem.play('win');
            
            // ÿ™ŸÅÿπŸäŸÑ ÿ≤ÿ± ÿßŸÑÿ™ÿ£ŸÉŸäÿØ ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™
            const confirmBtn = document.getElementById('confirmPlayerSelection');
            confirmBtn.disabled = false;
            confirmBtn.style.animation = 'pulse 1s infinite';
            confirmBtn.innerHTML = '<i class="fas fa-rocket"></i> ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿ¢ŸÜ!';
            
            // ÿ•ÿ∏Ÿáÿßÿ± ÿ•ÿ¥ÿπÿßÿ± ÿßŸÑÿ¨ÿßŸáÿ≤Ÿäÿ©
            setTimeout(() => {
                showGameReadyNotification();
            }, 2000);
        }
        
        // ÿ•ÿ∏Ÿáÿßÿ± ÿ•ÿ¥ÿπÿßÿ± ÿ¨ÿßŸáÿ≤Ÿäÿ© ÿßŸÑŸÑÿπÿ®ÿ©
        function showGameReadyNotification() {
            const notification = document.createElement('div');
            notification.className = 'game-ready-notification';
            notification.innerHTML = `
                <div class="notification-content">
                    <div class="notification-icon">
                        <i class="fas fa-gamepad"></i>
                    </div>
                    <div class="notification-text">
                        <h3>üöÄ ÿßŸÑŸÑÿπÿ®ÿ© ÿ¨ÿßŸáÿ≤ÿ© ŸÑŸÑÿ®ÿØÿ°!</h3>
                        <p>ÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ÿ¨ŸÖŸäÿπ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿ®ŸÜÿ¨ÿßÿ≠</p>
                        <div class="ready-players">
                            ${selectedPlayers.map(player => `
                                <span class="ready-player">${player.name}</span>
                            `).join('')}
                        </div>
                    </div>
                    <button class="notification-start-btn" onclick="confirmPlayerSelection(); document.body.removeChild(this.closest('.game-ready-notification'));">
                        <i class="fas fa-play"></i>
                        ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ®ÿ©
                    </button>
                </div>
            `;
            
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 30px;
                border-radius: 20px;
                box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                z-index: 10003;
                text-align: center;
                min-width: 350px;
                animation: bounceIn 0.6s ease-out;
                font-family: 'Cairo', sans-serif;
            `;
            
            document.body.appendChild(notification);
            
            // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ•ÿ¥ÿπÿßÿ± ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿ®ÿπÿØ 10 ÿ´ŸàÿßŸÜŸä
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'fadeOut 0.5s ease-in';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, 500);
                }
            }, 10000);
        }

        // ===========================================
        // Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ± ŸàÿßŸÑÿ™ÿ≠ÿØŸäÿ´
        // ===========================================
        function updateSelectionUI() {
            updateSimpleSelectionUI();
        }
        
        function updateSimplePlayerSelectionStatus() {
            updateSimpleSelectionUI();
        }

        // ÿ™ÿ≠ÿØŸäÿ´ Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ®ÿ≥Ÿäÿ∑ÿ©
        function updateSimpleSelectionUI() {
            const selectedCount = selectedPlayers.length;
            const totalNeeded = parseInt(document.getElementById('totalPlayersNeeded').textContent);
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿπÿØÿßÿØ
            document.getElementById('selectedPlayersCount').textContent = selectedCount;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÇÿØŸÖ
            const progress = (selectedCount / totalNeeded) * 100;
            document.getElementById('selectionProgress').style.width = `${progress}%`;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ≤ÿ± ÿßŸÑÿ™ÿ£ŸÉŸäÿØ
            const confirmBtn = document.getElementById('confirmPlayerSelection');
            confirmBtn.disabled = selectedCount !== totalNeeded;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÖÿÆÿ™ÿßÿ±ŸäŸÜ
            updateSimpleSelectedPlayersPreview();
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÖÿÆÿ™ÿßÿ±ŸäŸÜ ÿßŸÑÿ®ÿ≥Ÿäÿ∑ÿ©
        function updateSimpleSelectedPlayersPreview() {
            const previewContainer = document.getElementById('selectedPlayersList');
            
            if (selectedPlayers.length === 0) {
                previewContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-user-plus"></i>
                        <p>ÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿßŸÑÿ∑ŸÑÿßÿ® ŸÑÿßÿÆÿ™Ÿäÿßÿ±ŸáŸÖ</p>
                    </div>
                `;
                return;
            }
            
            previewContainer.innerHTML = '';
            selectedPlayers.forEach((player, index) => {
                const playerCard = document.createElement('div');
                playerCard.className = 'selected-player-card';
                playerCard.innerHTML = `
                    <button class="remove-btn" onclick="removeSelectedPlayer('${player.id}')">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="student-avatar" style="width: 40px; height: 40px; margin: 0 auto 10px;">
                        ${player.name.charAt(0)}
                    </div>
                    <div class="student-name" style="font-size: 0.9rem;">${player.name}</div>
                    <div class="player-role">ŸÑÿßÿπÿ® ${index + 1}</div>
                `;
                previewContainer.appendChild(playerCard);
            });
        }

        // ÿ•ÿ≤ÿßŸÑÿ© ŸÑÿßÿπÿ® ŸÖÿÆÿ™ÿßÿ±
        function removeSelectedPlayer(playerId) {
            selectedPlayers = selectedPlayers.filter(p => p.id !== playerId);
            
            // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ™ÿ≠ÿØŸäÿØ ŸÖŸÜ ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
            const cards = document.querySelectorAll('.student-interactive-card');
            cards.forEach(card => {
                if (card.dataset.studentId === playerId || card.dataset.studentName === playerId) {
                    card.classList.remove('selected');
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
                    const statusElement = card.querySelector('.student-status');
                    statusElement.innerHTML = `
                        <i class="fas fa-plus-circle"></i>
                        <span>ÿßŸÜŸÇÿ± ŸÑŸÑÿßÿÆÿ™Ÿäÿßÿ±</span>
                    `;
                }
            });
            
            updateSimpleSelectionUI();
            soundSystem.play('Click');
        }

        // ÿ™ÿ£ŸÉŸäÿØ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
        function confirmPlayerSelection() {
            if (selectedPlayers.length === 0) {
                MessageSystem.show('Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿ£ŸàŸÑÿßŸã!', 'error');
                return;
            }
            
            // ÿ£ŸÑŸàÿßŸÜ ŸÖÿÆÿ™ŸÑŸÅÿ© ŸÑŸÑÿßÿπÿ®ŸäŸÜ
            const playerColors = ['#e74c3c', '#3498db', '#2ecc71', '#f39c12', '#9b59b6', '#1abc9c'];
            
            // ÿ•ÿπÿØÿßÿØ ÿßŸÑŸÑÿπÿ®ÿ©
            gameState.players = selectedPlayers.map((player, index) => {
                const newPlayer = {
                    name: player.name || `ÿßŸÑŸÑÿßÿπÿ® ${index + 1}`,
                    money: 1500,
                    position: 0,
                    properties: [],
                    color: playerColors[index % playerColors.length],
                    inJail: false,
                    jailTurns: 0
                };
                
                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                validatePlayerData(newPlayer);
                return newPlayer;
            });
            
            gameState.gameStarted = false;
            gameState.currentPlayer = 0;
            
            // ÿ•ÿÆŸÅÿßÿ° Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ± ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÜÿ™ŸÇÿßŸÑŸä
            const selectionDiv = document.getElementById('smartPlayerSelection');
            selectionDiv.style.transform = 'scale(0.95)';
            selectionDiv.style.opacity = '0';
            
            setTimeout(() => {
                selectionDiv.style.display = 'none';
                selectionDiv.style.transform = 'scale(1)';
                selectionDiv.style.opacity = '1';
            }, 300);
            
            // ÿ™ŸÅÿπŸäŸÑ ÿ≤ÿ± ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ©
            document.getElementById('startGameBtn').disabled = false;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿπÿ±ÿ∂ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
            updatePlayersDisplay();
            
            // ÿ•ÿ¥ÿπÿßÿ± ÿ®ÿßŸÑÿ¨ÿßŸáÿ≤Ÿäÿ© ŸÑŸÑÿπÿ®
            MessageSystem.show(`üéÆ ÿ™ŸÖ ÿ•ÿπÿØÿßÿØ ${selectedPlayers.length} ŸÑÿßÿπÿ®ŸäŸÜ ÿ®ŸÜÿ¨ÿßÿ≠! ÿßŸÑŸÑÿπÿ®ÿ© ÿ¨ÿßŸáÿ≤ÿ© ŸÑŸÑÿ®ÿØÿ°`, 'success', 5000);
            soundSystem.play('win');
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑŸÉŸàŸÜŸÅŸäÿ™Ÿä ÿßŸÑŸÉÿ®Ÿäÿ±
            confetti({
                particleCount: 200,
                spread: 120,
                origin: { y: 0.6 }
            });
            
            // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿ•ŸÑŸâ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ
            setTimeout(() => {
                document.querySelector('.game-controls').scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center' 
                });
            }, 500);
        }

        // ÿ•ŸÑÿ∫ÿßÿ° ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
        function cancelPlayerSelection() {
            const selectionDiv = document.getElementById('smartPlayerSelection');
            selectionDiv.style.transform = 'scale(0.95)';
            selectionDiv.style.opacity = '0';
            
            setTimeout(() => {
                selectionDiv.style.display = 'none';
                selectionDiv.style.transform = 'scale(1)';
                selectionDiv.style.opacity = '1';
            }, 300);
            
            selectedPlayers = [];
            MessageSystem.show('ÿ™ŸÖ ÿ•ŸÑÿ∫ÿßÿ° ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ', 'info');
        }

        // ŸÖÿ≥ÿ≠ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ≠ÿßŸÑŸä
        function clearSelection() {
            selectedPlayers = [];
            
            // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ™ÿ≠ÿØŸäÿØ ŸÖŸÜ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™
            const cards = document.querySelectorAll('.student-interactive-card');
            cards.forEach(card => {
                card.classList.remove('selected');
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
                const statusElement = card.querySelector('.student-status');
                if (statusElement) {
                    statusElement.innerHTML = `
                        <i class="fas fa-plus-circle"></i>
                        <span>ÿßŸÜŸÇÿ± ŸÑŸÑÿßÿÆÿ™Ÿäÿßÿ±</span>
                    `;
                }
            });
            
            updateSimpleSelectionUI();
            MessageSystem.show('ÿ™ŸÖ ŸÖÿ≥ÿ≠ ÿ¨ŸÖŸäÿπ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ±ÿßÿ™', 'info');
            soundSystem.play('Click');
        }

        // ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ© ŸÖÿπ ÿßŸÑÿ∑ŸÑÿßÿ® ÿßŸÑŸÖÿÆÿ™ÿßÿ±ŸäŸÜ
        function startGameWithStudents() {
            const classValue = document.getElementById('classSelect').value;
            const playersCount = parseInt(document.getElementById('playersCount').value);

            if (!classValue) {
                MessageSystem.show('Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿµŸÅ ÿ£ŸàŸÑÿßŸã!', 'error');
                return;
            }

            const studentsInClass = playerData[classValue];
            if (studentsInClass.length < playersCount) {
                MessageSystem.show(`ÿßŸÑÿµŸÅ Ÿäÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ${studentsInClass.length} ÿ∑ÿßŸÑÿ® ŸÅŸÇÿ∑ÿå ŸÑÿß ŸäŸÖŸÉŸÜ ÿßÿÆÿ™Ÿäÿßÿ± ${playersCount} ŸÑÿßÿπÿ®ŸäŸÜ!`, 'error');
                return;
            }

            // ÿßÿÆÿ™Ÿäÿßÿ± ÿ∑ŸÑÿßÿ® ÿπÿ¥Ÿàÿßÿ¶ŸäŸäŸÜ ŸÖŸÜ ÿßŸÑÿµŸÅ
            const shuffled = [...studentsInClass].sort(() => 0.5 - Math.random());
            const selectedStudents = shuffled.slice(0, playersCount);

            // ÿ•ÿπÿØÿßÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
            gameState.players = selectedStudents.map((student, index) => ({
                name: student.name,
                money: 1500,
                position: 0,
                properties: []
            }));

            gameState.gameStarted = true;
            gameState.currentPlayer = 0;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ
            document.getElementById('startGameBtn').disabled = true;
            document.getElementById('rollDice').disabled = false;
            document.getElementById('endTurn').disabled = false;
            
            updatePlayersDisplay();
            MessageSystem.show(`ÿ®ÿØÿ£ÿ™ ÿßŸÑŸÑÿπÿ®ÿ© ŸÖÿπ ${playersCount} ŸÑÿßÿπÿ®ŸäŸÜ! ÿ≠ÿ∏ÿßŸã ŸÖŸàŸÅŸÇÿßŸã!`, 'success');
            soundSystem.play('win');
        }

        // ===========================================
        // ÿ•ŸÜÿ¥ÿßÿ° ŸÑŸàÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿπÿµÿ±Ÿäÿ©
        // ===========================================
        function createGameBoard() {
            console.log('üèóÔ∏è ÿ®ÿØÿ° ÿ•ŸÜÿ¥ÿßÿ° ŸÑŸàÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿπÿµÿ±Ÿäÿ©...');
            const board = document.getElementById('gameBoard');
            
            if (!board) {
                console.error('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿπŸÜÿµÿ± gameBoard!');
                return;
            }
            
            // ŸÖŸÜÿπ ÿßŸÑÿ™ŸÉÿ±ÿßÿ± - ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑŸÑŸàÿ≠ÿ© ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ŸÖÿ±ÿ®ÿπÿßÿ™ ÿ®ÿßŸÑŸÅÿπŸÑ
            if (board.children.length > 0) {
                console.log('‚ÑπÔ∏è ÿßŸÑŸÑŸàÿ≠ÿ© ŸÖŸàÿ¨ŸàÿØÿ© ÿ®ÿßŸÑŸÅÿπŸÑÿå ÿ•ÿπÿßÿØÿ© ÿ•ŸÜÿ¥ÿßÿ°...');
                board.innerHTML = ''; // ÿ•ÿπÿßÿØÿ© ÿ•ŸÜÿ¥ÿßÿ° ŸÑÿ∂ŸÖÿßŸÜ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´
            }
            
            if (!omanProperties || omanProperties.length === 0) {
                console.error('‚ùå ÿ®ŸäÿßŸÜÿßÿ™ omanProperties ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ±ÿ©!');
                return;
            }
            
            console.log(`üìä ÿπÿØÿØ ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™: ${omanProperties.length}`);

            // ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÖÿ±ÿ®ÿπÿßÿ™ ŸÖÿπ ÿßŸÑÿ™ÿµŸÖŸäŸÖ ÿßŸÑÿ¨ÿØŸäÿØ
            omanProperties.forEach((property, index) => {
                const square = document.createElement('div');
                const isCorner = index % 10 === 0;
                
                square.className = `board-square ${property.color} ${isCorner ? 'corner-square' : 'side-square'} square-${index}`;
                square.id = `square-${index}`;
                
                // ŸÖÿ≠ÿ™ŸàŸâ ŸÖÿ≠ÿ≥ŸÜ ŸÑŸÑŸÖÿ±ÿ®ÿπÿßÿ™
                square.innerHTML = `
                    <div class="property-content">
                        <div class="property-name" style="font-weight: 800; font-size: ${isCorner ? '0.9rem' : '0.75rem'}; margin-bottom: 4px;">
                            ${property.name}
                        </div>
                        ${property.price > 0 ? `
                            <div class="property-price" style="background: rgba(0,0,0,0.2); color: white; padding: 2px 6px; border-radius: 8px; font-size: 0.7rem; font-weight: 700;">
                                ${property.price} ÿ±.ÿπ
                            </div>
                        ` : ''}
                    </div>
                `;
                
                // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿ™ŸÅÿßÿπŸÑŸäÿ© ŸÖÿ™ŸÇÿØŸÖÿ©
                square.addEventListener('mouseenter', () => {
                    square.style.transform += ' rotateY(5deg)';
                    square.style.boxShadow = '0 20px 40px rgba(0,0,0,0.3), 0 0 30px rgba(220, 20, 60, 0.4)';
                });
                
                square.addEventListener('mouseleave', () => {
                    square.style.transform = square.style.transform.replace(' rotateY(5deg)', '');
                    square.style.boxShadow = '';
                });
                
                square.addEventListener('click', () => {
                    // ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑŸÜŸÇÿ±
                    square.style.transform += ' scale(0.95)';
                    setTimeout(() => {
                        square.style.transform = square.style.transform.replace(' scale(0.95)', '');
                        showPropertyInfo(property);
                    }, 150);
                });
                
                board.appendChild(square);
                console.log(`‚úÖ ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ŸÖÿ±ÿ®ÿπ ${index}: ${property.name}`);
                
                // ÿ™ÿ£ÿ´Ÿäÿ± ÿ∏ŸáŸàÿ± ŸÖÿ™ÿØÿ±ÿ¨
                setTimeout(() => {
                    square.style.opacity = '0';
                    square.style.transform += ' translateY(20px)';
                    requestAnimationFrame(() => {
                        square.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                        square.style.opacity = '1';
                        square.style.transform = square.style.transform.replace(' translateY(20px)', '');
                    });
                }, index * 50); // ÿ™ÿ£ÿÆŸäÿ± ÿ™ÿØÿ±Ÿäÿ¨Ÿä ŸÑŸÉŸÑ ŸÖÿ±ÿ®ÿπ
            });
            
            console.log('üéØ ÿ™ŸÖ ÿßŸÑÿßŸÜÿ™Ÿáÿßÿ° ŸÖŸÜ ÿ•ŸÜÿ¥ÿßÿ° ŸÑŸàÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿπÿµÿ±Ÿäÿ©!');
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ŸÜŸáÿßŸäÿ© ÿßŸÑÿ•ŸÜÿ¥ÿßÿ°
            setTimeout(() => {
                board.style.transform = 'scale(1.02)';
                setTimeout(() => {
                    board.style.transform = 'scale(1)';
                }, 300);
            }, omanProperties.length * 50 + 500);
        }

        // ===========================================
        // ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÇÿßÿ±
        // ===========================================
        function showPropertyInfo(property) {
            const modal = document.getElementById('propertyModal');
            const propertyInfo = document.getElementById('propertyInfo');
            
            let infoHTML = `
                <h2><i class="fas fa-building"></i> ${property.name}</h2>
                <div style="margin-top: 20px;">
            `;

            if (property.type === 'property') {
                infoHTML += `
                    <p><strong>ÿßŸÑŸÜŸàÿπ:</strong> ÿπŸÇÿßÿ±</p>
                    <p><strong>ÿßŸÑÿ≥ÿπÿ±:</strong> ${property.price} ÿ±ŸäÿßŸÑ ÿπŸèŸÖÿßŸÜŸä</p>
                    <p><strong>ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ©:</strong> ${getGroupName(property.color)}</p>
                    <h3>ÿßŸÑÿ•Ÿäÿ¨ÿßÿ±ÿßÿ™:</h3>
                    <ul>
                        <li>ÿ£ÿ±ÿ∂ ŸÅÿßÿ±ÿ∫ÿ©: ${property.rent[0]} ÿ±.ÿπ</li>
                        <li>ŸÖŸÜÿ≤ŸÑ Ÿàÿßÿ≠ÿØ: ${property.rent[1]} ÿ±.ÿπ</li>
                        <li>ŸÖŸÜÿ≤ŸÑÿßŸÜ: ${property.rent[2]} ÿ±.ÿπ</li>
                        <li>ÿ´ŸÑÿßÿ´ÿ© ŸÖŸÜÿßÿ≤ŸÑ: ${property.rent[3]} ÿ±.ÿπ</li>
                        <li>ÿ£ÿ±ÿ®ÿπÿ© ŸÖŸÜÿßÿ≤ŸÑ: ${property.rent[4]} ÿ±.ÿπ</li>
                        <li>ŸÅŸÜÿØŸÇ: ${property.rent[5]} ÿ±.ÿπ</li>
                    </ul>
                `;
            } else if (property.type === 'airport') {
                infoHTML += `
                    <p><strong>ÿßŸÑŸÜŸàÿπ:</strong> ŸÖÿ∑ÿßÿ±</p>
                    <p><strong>ÿßŸÑÿ≥ÿπÿ±:</strong> ${property.price} ÿ±ŸäÿßŸÑ ÿπŸèŸÖÿßŸÜŸä</p>
                    <h3>ÿßŸÑÿ•Ÿäÿ¨ÿßÿ±ÿßÿ™:</h3>
                    <ul>
                        <li>ŸÖÿ∑ÿßÿ± Ÿàÿßÿ≠ÿØ: ${property.rent[0]} ÿ±.ÿπ</li>
                        <li>ŸÖÿ∑ÿßÿ±ÿßŸÜ: ${property.rent[1]} ÿ±.ÿπ</li>
                        <li>ÿ´ŸÑÿßÿ´ÿ© ŸÖÿ∑ÿßÿ±ÿßÿ™: ${property.rent[2]} ÿ±.ÿπ</li>
                        <li>ÿ£ÿ±ÿ®ÿπÿ© ŸÖÿ∑ÿßÿ±ÿßÿ™: ${property.rent[3]} ÿ±.ÿπ</li>
                    </ul>
                `;
            } else if (property.type === 'utility') {
                infoHTML += `
                    <p><strong>ÿßŸÑŸÜŸàÿπ:</strong> ŸÖÿ±ŸÅŸÇ ÿπÿßŸÖ</p>
                    <p><strong>ÿßŸÑÿ≥ÿπÿ±:</strong> ${property.price} ÿ±ŸäÿßŸÑ ÿπŸèŸÖÿßŸÜŸä</p>
                    <p><strong>ÿßŸÑÿ•Ÿäÿ¨ÿßÿ±:</strong> 4 ŸÖÿ±ÿßÿ™ ŸÜÿ™Ÿäÿ¨ÿ© ÿßŸÑŸÜÿ±ÿØ (ŸÖÿ±ŸÅŸÇ Ÿàÿßÿ≠ÿØ) ÿ£Ÿà 10 ŸÖÿ±ÿßÿ™ (ŸÖÿ±ŸÅŸÇÿßŸÜ)</p>
                `;
            } else {
                infoHTML += `<p><strong>ÿßŸÑŸÜŸàÿπ:</strong> ${getSquareTypeName(property.type)}</p>`;
            }

            infoHTML += '</div>';
            propertyInfo.innerHTML = infoHTML;
            modal.style.display = 'block';
        }

        function getGroupName(color) {
            const groups = {
                'brown': 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ®ŸÜŸäÿ©',
                'light-blue': 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ≤ÿ±ŸÇÿßÿ° ÿßŸÑŸÅÿßÿ™ÿ≠ÿ©',
                'pink': 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑŸàÿ±ÿØŸäÿ©',
                'orange': 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ®ÿ±ÿ™ŸÇÿßŸÑŸäÿ©',
                'red': 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ≠ŸÖÿ±ÿßÿ°',
                'yellow': 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿµŸÅÿ±ÿßÿ°',
                'green': 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿÆÿ∂ÿ±ÿßÿ°',
                'dark-blue': 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ≤ÿ±ŸÇÿßÿ° ÿßŸÑÿØÿßŸÉŸÜÿ©',
                'railroad': 'ÿßŸÑŸÖÿ∑ÿßÿ±ÿßÿ™',
                'utility': 'ÿßŸÑŸÖÿ±ÿßŸÅŸÇ ÿßŸÑÿπÿßŸÖÿ©'
            };
            return groups[color] || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
        }

        function getSquareTypeName(type) {
            const types = {
                'start': 'ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®ÿØÿßŸäÿ©',
                'jail': 'ÿßŸÑÿ≥ÿ¨ŸÜ/ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©',
                'free': 'ŸÖŸàŸÇŸÅ ŸÖÿ¨ÿßŸÜŸä',
                'go-to-jail': 'ÿßÿ∞Ÿáÿ® ŸÑŸÑÿ≥ÿ¨ŸÜ',
                'tax': 'ÿ∂ÿ±Ÿäÿ®ÿ©',
                'chance': 'ÿßŸÑŸÅÿ±ÿµÿ©',
                'community': 'ÿµŸÜÿØŸàŸÇ ÿßŸÑŸÖÿ¨ÿ™ŸÖÿπ'
            };
            return types[type] || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
        }

        // ===========================================
        // ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
        // ===========================================
        function initializePlayers(playerNames = null) {
            if (playerNames && playerNames.length > 0) {
                // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ£ÿ≥ŸÖÿßÿ° ŸÖÿÆÿµÿµÿ©
                gameState.players = playerNames.map((name, index) => ({
                    name: name || `ÿßŸÑŸÑÿßÿπÿ® ${index + 1}`,
                    money: 1500,
                    position: 0,
                    properties: []
                }));
            } else {
                // ÿ•ŸÜÿ¥ÿßÿ° ŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÅÿ™ÿ±ÿßÿ∂ŸäŸäŸÜ
                gameState.players = [
                    { name: 'ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ£ŸàŸÑ', money: 1500, position: 0, properties: [] },
                    { name: 'ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ´ÿßŸÜŸä', money: 1500, position: 0, properties: [] }
                ];
            }
            
            updatePlayersDisplay();
            MessageSystem.show(`ÿ™ŸÖ ÿ•ÿπÿØÿßÿØ ${gameState.players.length} ŸÑÿßÿπÿ®ŸäŸÜ`, 'success');
        }

        function updatePropertyDisplay() {
            omanProperties.forEach((property, index) => {
                if (property.type === 'property' || property.type === 'airport' || property.type === 'utility') {
                    const squareElement = document.getElementById(`square-${index}`);
                    if (squareElement) {
                        // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑŸÖŸÑŸÉŸäÿ©
                        const owner = gameState.players.find(p => p.properties.includes(index));
                        
                        if (owner) {
                            // ÿßŸÑÿπŸÇÿßÿ± ŸÖŸÖŸÑŸàŸÉ
                            squareElement.classList.remove('available');
                            squareElement.classList.add('owned');
                            squareElement.style.backgroundColor = owner.color || '#e74c3c';
                            
                            // ÿ•ÿ∂ÿßŸÅÿ© ÿßÿ≥ŸÖ ÿßŸÑŸÖÿßŸÑŸÉ
                            let ownerLabel = squareElement.querySelector('.owner-label');
                            if (!ownerLabel) {
                                ownerLabel = document.createElement('div');
                                ownerLabel.className = 'owner-label';
                                ownerLabel.style.cssText = `
                                    position: absolute;
                                    bottom: 2px;
                                    left: 2px;
                                    right: 2px;
                                    background: rgba(0,0,0,0.8);
                                    color: white;
                                    font-size: 8px;
                                    text-align: center;
                                    border-radius: 3px;
                                    padding: 1px;
                                `;
                                squareElement.appendChild(ownerLabel);
                            }
                            ownerLabel.textContent = owner.name;
                        } else {
                            // ÿßŸÑÿπŸÇÿßÿ± ŸÖÿ™ÿßÿ≠ ŸÑŸÑÿ¥ÿ±ÿßÿ°
                            squareElement.classList.remove('owned');
                            squareElement.classList.add('available');
                            squareElement.style.backgroundColor = '';
                            
                            // ÿ•ÿ≤ÿßŸÑÿ© ÿ™ÿ≥ŸÖŸäÿ© ÿßŸÑŸÖÿßŸÑŸÉ
                            const ownerLabel = squareElement.querySelector('.owner-label');
                            if (ownerLabel) ownerLabel.remove();
                        }
                    }
                }
            });
        }

        // ÿØÿßŸÑÿ© ŸÖÿ≥ÿßÿπÿØÿ© ŸÑÿπÿ±ÿ∂ ÿßŸÑŸÖÿßŸÑ ÿ®ÿ¥ŸÉŸÑ ÿ¢ŸÖŸÜ
        function formatMoney(amount) {
            if (typeof amount !== 'number' || isNaN(amount)) {
                console.warn('‚ö†Ô∏è ŸÇŸäŸÖÿ© ŸÖÿßŸÑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©:', amount);
                return '0 ÿ±.ÿπ';
            }
            return `${Math.round(amount)} ÿ±.ÿπ`;
        }

        // ÿØÿßŸÑÿ© ŸÖÿ≥ÿßÿπÿØÿ© ŸÑŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿµÿ≠ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®
        function validatePlayerData(player) {
            if (!player) {
                console.error('‚ùå ÿ®ŸäÿßŸÜÿßÿ™ ŸÑÿßÿπÿ® ŸÖŸÅŸÇŸàÿØÿ©');
                return false;
            }
            
            // ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ÿßŸÑŸÖÿßŸÑ ŸÉÿ±ŸÇŸÖ
            if (typeof player.money !== 'number' || isNaN(player.money)) {
                console.warn('‚ö†Ô∏è ÿ•ÿµŸÑÿßÿ≠ ŸÖÿßŸÑ ÿßŸÑŸÑÿßÿπÿ®:', player.name, 'ŸÖŸÜ', player.money, 'ÿ•ŸÑŸâ 1500');
                player.money = 1500; // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÖÿßŸÑ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä
            }
            
            // ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ÿßŸÑŸÖŸàŸÇÿπ ŸÉÿ±ŸÇŸÖ
            if (typeof player.position !== 'number' || isNaN(player.position)) {
                console.warn('‚ö†Ô∏è ÿ•ÿµŸÑÿßÿ≠ ŸÖŸàŸÇÿπ ÿßŸÑŸÑÿßÿπÿ®:', player.name, 'ŸÖŸÜ', player.position, 'ÿ•ŸÑŸâ 0');
                player.position = 0;
            }
            
            // ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™
            if (!Array.isArray(player.properties)) {
                console.warn('‚ö†Ô∏è ÿ•ÿµŸÑÿßÿ≠ ŸÇÿßÿ¶ŸÖÿ© ÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®:', player.name);
                player.properties = [];
            }
            
            return true;
        }

        function updatePlayersDisplay() {
            const playersInfo = document.getElementById('playersInfo');
            if (!playersInfo) return;
            
            playersInfo.innerHTML = '';

            gameState.players.forEach((player, index) => {
                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®
                validatePlayerData(player);
                
                const isCurrentPlayer = index === gameState.currentPlayer;
                const playerCard = document.createElement('div');
                playerCard.className = `player-card ${isCurrentPlayer ? 'current-player' : ''} ${player.isBankrupt ? 'bankrupt-player' : ''}`;
                playerCard.setAttribute('data-player', index);
                
                const currentPosition = player.position >= 0 && player.position < omanProperties.length ? 
                    player.position : 0;
                
                // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿµÿßŸÅŸäÿ©
                const netWorth = LeaderboardSystem.calculateNetWorth(player);
                const propertyValue = LeaderboardSystem.calculatePropertyValue(player);
                
                // ÿ™ÿ≠ÿØŸäÿØ ÿ≠ÿßŸÑÿ© ÿßŸÑŸÑÿßÿπÿ®
                let playerStatus = '';
                if (isCurrentPlayer) {
                    if (!gameState.gameStarted) {
                        playerStatus = '<div class="player-turn-status">üéÆ ŸÅŸä ÿßŸÜÿ™ÿ∏ÿßÿ± ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ©</div>';
                    } else {
                        playerStatus = '<div class="player-turn-status">üéØ ÿØŸàÿ±ŸÉ ÿßŸÑÿ¢ŸÜ!</div>';
                        playerStatus += '<div class="action-hint">üí° ÿßÿ∂ÿ∫ÿ∑ "ÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ" ŸÑŸÑÿπÿ®</div>';
                    }
                }
                
                playerCard.innerHTML = `
                    ${isCurrentPlayer ? '<div class="current-player-indicator">ÿØŸàÿ±ŸÉ ÿßŸÑÿ¢ŸÜ</div>' : ''}
                    
                    <h3 style="color: ${isCurrentPlayer ? '#fff' : '#2c3e50'};">
                        ${player.name || `ÿßŸÑŸÑÿßÿπÿ® ${index + 1}`} 
                        ${player.isBankrupt ? 'üíî' : ''}
                        ${player.inJail ? 'üèõÔ∏è' : ''}
                        ${isCurrentPlayer ? 'üëë' : ''}
                        ${isCurrentPlayer ? '<span style="color: #ffeb3b;">‚óÄ ÿØŸàÿ±ŸÉ</span>' : ''}
                        ${player.inJail ? '<span style="color: #e74c3c; font-size: 0.8em;">ŸÅŸä ÿßŸÑÿ≥ÿ¨ŸÜ</span>' : ''}
                        ${player.isBankrupt ? '<span style="color: #e74c3c; font-size: 0.8em; font-weight: bold;">ŸÖŸèŸÅŸÑŸêÿ≥</span>' : ''}
                    </h3>
                    
                    ${playerStatus}
                    
                    <div class="player-stats-enhanced">
                        <div class="stat-item">
                            <div style="font-size: 1.2em; color: #27ae60;">üí∞</div>
                            <div style="font-weight: bold; color: ${isCurrentPlayer ? '#fff' : '#2c3e50'};">${formatMoney(player.money)}</div>
                            <div style="font-size: 0.8em; color: ${isCurrentPlayer ? '#ecf0f1' : '#7f8c8d'};">ÿßŸÑÿ£ŸÖŸàÿßŸÑ</div>
                        </div>
                        
                        <div class="stat-item">
                            <div style="font-size: 1.2em; color: #3498db;">üè†</div>
                            <div style="font-weight: bold; color: ${isCurrentPlayer ? '#fff' : '#2c3e50'};">${player.properties ? player.properties.length : 0}</div>
                            <div style="font-size: 0.8em; color: ${isCurrentPlayer ? '#ecf0f1' : '#7f8c8d'};">ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™</div>
                        </div>
                        
                        <div class="stat-item">
                            <div style="font-size: 1.2em; color: #9b59b6;">üìä</div>
                            <div style="font-weight: bold; color: ${isCurrentPlayer ? '#fff' : '#2c3e50'};">${formatMoney(netWorth)}</div>
                            <div style="font-size: 0.8em; color: ${isCurrentPlayer ? '#ecf0f1' : '#7f8c8d'};">ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿµÿßŸÅŸäÿ©</div>
                        </div>
                        
                        <div class="stat-item">
                            <div style="font-size: 1.2em; color: #e67e22;">üèòÔ∏è</div>
                            <div style="font-weight: bold; color: ${isCurrentPlayer ? '#fff' : '#2c3e50'};">${formatMoney(propertyValue)}</div>
                            <div style="font-size: 0.8em; color: ${isCurrentPlayer ? '#ecf0f1' : '#7f8c8d'};">ŸÇŸäŸÖÿ© ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™</div>
                        </div>
                    </div>
                    
                    <div class="player-info">
                        <span style="color: ${isCurrentPlayer ? '#fff' : '#2c3e50'};">üìç ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ≠ÿßŸÑŸä:</span>
                        <div class="player-position-indicator" style="color: ${isCurrentPlayer ? '#ecf0f1' : '#34495e'}; font-weight: bold;">
                            ${omanProperties[currentPosition]?.name || 'ÿßŸÑÿ®ÿØÿßŸäÿ©'}
                        </div>
                        
                        ${player.inJail ? `
                            <div style="background: rgba(231, 76, 60, 0.2); padding: 10px; border-radius: 10px; margin-top: 10px; border: 2px solid #e74c3c;">
                                <div style="color: #e74c3c; font-weight: bold; font-size: 0.9em;">
                                    üèõÔ∏è ŸÅŸä ÿßŸÑÿ≥ÿ¨ŸÜ - ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ${player.jailTurns || 0}/3
                                </div>
                                <div style="font-size: 0.8em; color: ${isCurrentPlayer ? '#ecf0f1' : '#7f8c8d'}; margin-top: 5px;">
                                    ŸäŸÖŸÉŸÜ ÿßŸÑÿÆÿ±Ÿàÿ¨ ÿ®ÿ≤Ÿàÿ¨Ÿä ÿ£Ÿà ÿØŸÅÿπ 50 ÿ±.ÿπ
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    
                    ${isCurrentPlayer && gameState.gameStarted ? `
                        <div class="player-actions">
                            <small style="color: #7f8c8d; text-align: center; display: block; margin-top: 10px;">
                                ‚è∞ ÿßŸÜÿ™ÿ∏ÿßÿ± ÿßŸÑÿ≠ÿ±ŸÉÿ©...
                            </small>
                        </div>
                    ` : ''}
                `;
                
                playersInfo.appendChild(playerCard);
            });
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ™ŸÖŸäŸäÿ≤ ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©
            updatePlayerCardHighlight();
        }

        // ===========================================
        // ÿßÿÆÿ™ÿ®ÿßÿ± ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≥ÿ≠ÿ®
        // ===========================================
        
        function testBankruptcyDemo() {
            console.log('üíî ÿ®ÿØÿ° ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿä ŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥');
            
            // ÿ•ŸÜÿ¥ÿßÿ° ŸÑÿßÿπÿ®ŸäŸÜ ÿ™ÿ¨ÿ±Ÿäÿ®ŸäŸäŸÜ
            if (!gameState.players || gameState.players.length < 2) {
                gameState.players = [
                    {
                        name: "ŸÑÿßÿπÿ® ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä 1",
                        money: 50, // ŸÖÿßŸÑ ŸÇŸÑŸäŸÑ
                        position: 5,
                        properties: [1, 3], // ÿ®ÿπÿ∂ ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™
                        inJail: false,
                        jailTurns: 0,
                        isBankrupt: false
                    },
                    {
                        name: "ŸÑÿßÿπÿ® ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä 2",
                        money: 1500,
                        position: 10,
                        properties: [],
                        inJail: false,
                        jailTurns: 0,
                        isBankrupt: false
                    }
                ];
                gameState.currentPlayer = 0;
                gameState.gameStarted = true;
                gameState.propertyOwners = {
                    1: gameState.players[0],
                    3: gameState.players[0]
                };
            }
            
            // ŸÖÿ≠ÿßŸÉÿßÿ© ŸÖŸàŸÇŸÅ ÿ•ŸÅŸÑÿßÿ≥
            MessageSystem.show('üí∏ ŸÖÿ≠ÿßŸÉÿßÿ© ŸÖŸàŸÇŸÅ ÿ•ŸÅŸÑÿßÿ≥...', 'info', 2000);
            setTimeout(() => {
                // ÿ™ŸÇŸÑŸäŸÑ ŸÖÿßŸÑ ÿßŸÑŸÑÿßÿπÿ® ŸÑÿ≠ÿØ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥
                const player = gameState.players[0];
                player.money = -200; // ÿ•ŸÅŸÑÿßÿ≥
                
                updatePlayersDisplay();
                
                setTimeout(() => {
                    handleBankruptcy(0, 300);
                }, 1000);
            }, 1000);
            
            console.log('üíî ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ•ŸÅŸÑÿßÿ≥ ŸÖŸèŸÅÿπŸëŸÑ!');
        }

        function testJailDemo() {
            console.log('üèõÔ∏è ÿ®ÿØÿ° ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿä ŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≥ÿ¨ŸÜ');
            
            // ÿ•ŸÜÿ¥ÿßÿ° ŸÑÿßÿπÿ® ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸÖŸàÿ¨ŸàÿØ
            if (!gameState.players || gameState.players.length === 0) {
                gameState.players = [{
                    name: "ŸÑÿßÿπÿ® ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä",
                    money: 1500,
                    position: 5,
                    properties: [],
                    inJail: false,
                    jailTurns: 0
                }];
                gameState.currentPlayer = 0;
                gameState.gameStarted = true;
            }
            
            // ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÑÿßÿπÿ® ŸÑŸÑÿ≥ÿ¨ŸÜ
            MessageSystem.show('üèõÔ∏è ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿä ŸÑŸÑÿ≥ÿ¨ŸÜ...', 'info', 2000);
            setTimeout(() => {
                handleGoToJail(0);
                updatePlayersDisplay();
                
                // ÿßÿÆÿ™ÿ®ÿßÿ± ÿ¢ÿÆÿ± ÿ®ÿπÿØ 3 ÿ´ŸàÿßŸÜ
                setTimeout(() => {
                    MessageSystem.show('üé≤ ŸÖÿ≠ÿßŸàŸÑÿ© ÿßŸÑŸáÿ±Ÿàÿ® ŸÖŸÜ ÿßŸÑÿ≥ÿ¨ŸÜ...', 'info', 2000);
                    gameState.players[0].jailTurns = 1; // ŸÖÿ≠ÿßŸÉÿßÿ© ŸÖÿ≠ÿßŸàŸÑÿ© Ÿàÿßÿ≠ÿØÿ©
                    setTimeout(() => {
                        handleJailTurn(gameState.players[0]);
                    }, 1000);
                }, 3000);
            }, 1000);
            
            console.log('üèõÔ∏è ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ≥ÿ¨ŸÜ ŸÖŸÉÿ™ŸÖŸÑ!');
        }

        function testCardDemo() {
            console.log('üß™ ÿ®ÿØÿ° ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿä ŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™');
            
            // ÿ•ŸÜÿ¥ÿßÿ° ŸÑÿßÿπÿ® ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸÖŸàÿ¨ŸàÿØ
            if (!gameState.players || gameState.players.length === 0) {
                gameState.players = [{
                    name: "ŸÑÿßÿπÿ® ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä",
                    money: 1500,
                    position: 0,
                    properties: []
                }];
                gameState.currentPlayer = 0;
            }
            
            // ÿßÿÆÿ™ÿ®ÿßÿ± ÿ®ÿ∑ÿßŸÇÿ© ÿµÿØŸÅÿ©
            MessageSystem.show('üé≤ ÿßÿÆÿ™ÿ®ÿßÿ± ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿµÿØŸÅÿ©...', 'info', 2000);
            setTimeout(() => {
                handleChanceCard(0);
            }, 1000);
            
            // ÿßÿÆÿ™ÿ®ÿßÿ± ÿ®ÿ∑ÿßŸÇÿ© ÿÆÿ≤ÿßŸÜÿ© ÿ®ÿπÿØ 3 ÿ´ŸàÿßŸÜ
            setTimeout(() => {
                MessageSystem.show('üèõÔ∏è ÿßÿÆÿ™ÿ®ÿßÿ± ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿÆÿ≤ÿßŸÜÿ©...', 'info', 2000);
                setTimeout(() => {
                    handleCommunityCard(0);
                }, 1000);
            }, 3000);
            
            // ÿ∑ÿ®ÿßÿπÿ© ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸÜÿ∏ÿßŸÖ
            const testResult = testCardSystem();
            console.log('üìä ÿ™ŸÇÿ±Ÿäÿ± ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™:', testResult);
            
            return testResult;
        }

        function testCardSystem() {
            console.log('üß™ ÿßÿÆÿ™ÿ®ÿßÿ± ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≥ÿ≠ÿ®...');
            
            // ÿßÿÆÿ™ÿ®ÿßÿ± ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿµÿØŸÅÿ©
            console.log('üìä ÿßÿÆÿ™ÿ®ÿßÿ± ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑÿµÿØŸÅÿ©:', chanceCards.length, 'ÿ®ÿ∑ÿßŸÇÿ©');
            chanceCards.forEach((card, index) => {
                console.log(`${index + 1}. ${card.text}`);
            });
            
            // ÿßÿÆÿ™ÿ®ÿßÿ± ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿÆÿ≤ÿßŸÜÿ©
            console.log('üìä ÿßÿÆÿ™ÿ®ÿßÿ± ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑÿÆÿ≤ÿßŸÜÿ©:', communityCards.length, 'ÿ®ÿ∑ÿßŸÇÿ©');
            communityCards.forEach((card, index) => {
                console.log(`${index + 1}. ${card.text}`);
            });
            
            // ÿßÿÆÿ™ÿ®ÿßÿ± ÿ≥ÿ≠ÿ® ÿπÿ¥Ÿàÿßÿ¶Ÿä
            const randomChance = chanceCards[Math.floor(Math.random() * chanceCards.length)];
            const randomCommunity = communityCards[Math.floor(Math.random() * communityCards.length)];
            
            console.log('üé≤ ÿ®ÿ∑ÿßŸÇÿ© ÿµÿØŸÅÿ© ÿπÿ¥Ÿàÿßÿ¶Ÿäÿ©:', randomChance.text);
            console.log('üèõÔ∏è ÿ®ÿ∑ÿßŸÇÿ© ÿÆÿ≤ÿßŸÜÿ© ÿπÿ¥Ÿàÿßÿ¶Ÿäÿ©:', randomCommunity.text);
            
            return {
                chanceCardsCount: chanceCards.length,
                communityCardsCount: communityCards.length,
                randomChance,
                randomCommunity,
                systemWorking: true
            };
        }

        // ===========================================
        // ŸÖŸäŸÉÿßŸÜŸäŸÉŸäÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÅŸäÿ©
        // ===========================================
        function rollDice() {
            if (!gameState.gameStarted) {
                MessageSystem.show('Ÿäÿ¨ÿ® ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ© ÿ£ŸàŸÑÿßŸã!', 'error');
                return;
            }

            const player = gameState.players[gameState.currentPlayer];
            
            // ŸÅÿ≠ÿµ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ≥ÿ¨ŸÜ ÿ£ŸàŸÑÿßŸã
            if (player.inJail) {
                handleJailTurn(player);
                return;
            }
            
            // ÿ™ÿπÿ∑ŸäŸÑ ÿ≤ÿ± ÿßŸÑŸÜÿ±ÿØ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ±ŸÖŸä
            document.getElementById('rollDice').disabled = true;
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿµŸàÿ™Ÿä ŸÑŸÑÿ™ÿ±ŸÇÿ®
            soundSystem.play('countdown');
            
            // ÿ£ŸÜŸäŸÖŸäÿ¥ŸÜ ÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ
            showDiceAnimation(() => {
                const dice1 = Math.floor(Math.random() * 6) + 1;
                const dice2 = Math.floor(Math.random() * 6) + 1;
                const total = dice1 + dice2;
                const isDouble = dice1 === dice2;

                gameState.lastRoll = { dice1, dice2, total };

                // ÿ™ÿ≠ÿØŸäÿ´ ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ±ÿØ
                updateDiceDisplay(dice1, dice2);
                
                // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿµŸàÿ™Ÿäÿ© ŸÖÿÆÿ™ŸÑŸÅÿ© ÿ≠ÿ≥ÿ® ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©
                if (isDouble) {
                    soundSystem.play('bell');
                    gameState.doubles++;
                } else {
                    soundSystem.play('dice');
                    gameState.doubles = 0;
                }

                // ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™
                let message = `üé≤ ${player.name}: ${dice1} + ${dice2} = ${total}`;
                if (isDouble) {
                    message += ' - ÿ≤Ÿàÿ¨Ÿä! üéâ';
                    confetti({
                        particleCount: 30,
                        spread: 60,
                        origin: { y: 0.8 }
                    });
                }
                
                MessageSystem.show(message, isDouble ? 'success' : 'dice', 4000);

                // ŸÅÿ≠ÿµ ÿßŸÑÿ≤Ÿàÿ¨Ÿä ÿßŸÑÿ´ŸÑÿßÿ´Ÿä (ÿ≥ÿ¨ŸÜ)
                if (gameState.doubles >= 3) {
                    MessageSystem.show('üö® ÿ´ŸÑÿßÿ´ÿ© ÿ≤Ÿàÿ¨Ÿäÿßÿ™ ŸÖÿ™ÿ™ÿßŸÑŸäÿ©! ÿßÿ∞Ÿáÿ® ŸÑŸÑÿ≥ÿ¨ŸÜ!', 'error', 5000, true);
                    soundSystem.play('lose');
                    handleGoToJail(gameState.currentPlayer);
                    gameState.doubles = 0;
                    document.getElementById('rollDice').disabled = false;
                    return;
                }

                // ŸÅÿ≠ÿµ ÿ•ŸÜÿ¨ÿßÿ≤ ÿßŸÑŸÜÿ±ÿØ ÿßŸÑŸÖÿ≠ÿ∏Ÿàÿ∏
                AchievementSystem.checkAchievement(player, 'lucky_roller', { consecutiveDoubles: gameState.doubles });

                // ÿ™ÿ≠ÿ±ŸäŸÉ ÿßŸÑŸÑÿßÿπÿ®
                setTimeout(() => {
                    movePlayer(gameState.currentPlayer, total);
                    
                    // ÿ•ÿπÿßÿØÿ© ÿ™ŸÅÿπŸäŸÑ ÿ≤ÿ± ÿßŸÑŸÜÿ±ÿØ
                    document.getElementById('rollDice').disabled = false;
                    
                    // ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ÿ≤Ÿàÿ¨Ÿäÿå ŸäŸÖŸÉŸÜ ÿ•ŸÜŸáÿßÿ° ÿßŸÑÿØŸàÿ±
                    if (!isDouble) {
                        document.getElementById('endTurn').disabled = false;
                    }
                }, 1000);
            });
        }

        function showDiceAnimation(callback) {
            let diceContainer = document.getElementById('diceContainer');
            if (!diceContainer) {
                diceContainer = createDiceContainer();
            }
            
            // ÿ£ŸÜŸäŸÖŸäÿ¥ŸÜ ÿßŸÑÿØŸàÿ±ÿßŸÜ
            diceContainer.classList.add('rolling');
            
            // ŸÖÿ≠ÿßŸÉÿßÿ© ÿßŸÑÿ±ŸÖŸä ŸÑŸÖÿØÿ© ÿ´ÿßŸÜŸäÿ™ŸäŸÜ
            let rollCount = 0;
            const rollInterval = setInterval(() => {
                const tempDice1 = Math.floor(Math.random() * 6) + 1;
                const tempDice2 = Math.floor(Math.random() * 6) + 1;
                updateDiceDisplay(tempDice1, tempDice2);
                rollCount++;
                
                if (rollCount >= 20) {
                    clearInterval(rollInterval);
                    diceContainer.classList.remove('rolling');
                    callback();
                }
            }, 100);
        }

        function createDiceContainer() {
            const container = document.createElement('div');
            container.id = 'diceContainer';
            container.innerHTML = `
                <div class="dice-wrapper">
                    <div class="dice" id="dice1">‚öÄ</div>
                    <div class="dice" id="dice2">‚öÄ</div>
                </div>
            `;
            container.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 1000;
                pointer-events: none;
                background: rgba(0,0,0,0.8);
                border-radius: 15px;
                padding: 20px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            `;
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑŸÜÿ±ÿØ
            const diceStyle = document.createElement('style');
            diceStyle.textContent = `
                .dice-wrapper {
                    display: flex;
                    gap: 20px;
                    align-items: center;
                    justify-content: center;
                }
                .dice {
                    width: 60px;
                    height: 60px;
                    background: white;
                    border-radius: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 40px;
                    color: #333;
                    border: 2px solid #ddd;
                    transition: all 0.1s ease;
                }
                .rolling .dice {
                    animation: diceRoll 0.1s infinite;
                }
                @keyframes diceRoll {
                    0% { transform: rotate(0deg); }
                    25% { transform: rotate(90deg); }
                    50% { transform: rotate(180deg); }
                    75% { transform: rotate(270deg); }
                    100% { transform: rotate(360deg); }
                }
            `;
            document.head.appendChild(diceStyle);
            
            document.body.appendChild(container);
            return container;
        }

        function updateDiceDisplay(dice1, dice2) {
            const diceSymbols = ['‚öÄ', '‚öÅ', '‚öÇ', '‚öÉ', '‚öÑ', '‚öÖ'];
            const dice1Element = document.getElementById('dice1');
            const dice2Element = document.getElementById('dice2');
            
            if (dice1Element && dice2Element) {
                dice1Element.textContent = diceSymbols[dice1 - 1];
                dice2Element.textContent = diceSymbols[dice2 - 1];
            }
        }

        function movePlayer(playerIndex, steps) {
            const player = gameState.players[playerIndex];
            const oldPosition = player.position;
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ¨ÿØŸäÿØ
            let newPosition = (player.position + steps) % 40;
            let passedStart = newPosition < oldPosition;
            
            // ÿ£ŸÜŸäŸÖŸäÿ¥ŸÜ ÿßŸÑÿ≠ÿ±ŸÉÿ© ÿßŸÑÿ™ÿØÿ±Ÿäÿ¨Ÿäÿ©
            animatePlayerMovement(playerIndex, oldPosition, steps, () => {
                player.position = newPosition;
                
                // ŸÅÿ≠ÿµ ÿßŸÑŸÖÿ±Ÿàÿ± ÿ®ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®ÿØÿßŸäÿ©
                if (passedStart) {
                    player.money += 200;
                    MessageSystem.showMoneyTransaction(player.name, 200, true);
                    MessageSystem.show('üéØ ŸÖÿ±ÿ±ÿ™ ÿ®ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®ÿØÿßŸäÿ©! ÿ≠ÿµŸÑÿ™ ÿπŸÑŸâ 200 ÿ±.ÿπ', 'success', 4000);
                    soundSystem.play('bonus');
                    
                    // ÿ™ÿ£ÿ´Ÿäÿ± ÿÆÿßÿµ ŸÑŸÑŸÖÿ±Ÿàÿ± ÿ®ÿßŸÑÿ®ÿØÿßŸäÿ©
                    confetti({
                        particleCount: 80,
                        spread: 90,
                        origin: { y: 0.7 },
                        colors: ['#00FF00', '#32CD32', '#7FFF00']
                    });
                }

                updatePlayersDisplay();
                updatePlayerPosition(playerIndex);
                handleSquareLanding(playerIndex, player.position);
            });
        }

        function animatePlayerMovement(playerIndex, startPos, steps, callback) {
            let currentStep = 0;
            const player = gameState.players[playerIndex];
            
            const moveStep = () => {
                if (currentStep >= steps) {
                    callback();
                    return;
                }
                
                currentStep++;
                const tempPosition = (startPos + currentStep) % 40;
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑŸÖÿ§ŸÇÿ™
                updatePlayerPosition(playerIndex, tempPosition);
                
                // ÿ™ÿ£ÿ´Ÿäÿ± ÿµŸàÿ™Ÿä ŸÑŸÑÿ≠ÿ±ŸÉÿ©
                if (currentStep % 2 === 0) {
                    soundSystem.play('select', 0.3);
                }
                
                // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ŸÑŸÑŸÖÿ±ÿ®ÿπ ÿßŸÑÿ≠ÿßŸÑŸä
                highlightSquare(tempPosition);
                
                setTimeout(moveStep, 300); // ÿ≥ÿ±ÿπÿ© ÿßŸÑÿ≠ÿ±ŸÉÿ©
            };
            
            moveStep();
        }

        function updatePlayerPosition(playerIndex, position = null) {
            const player = gameState.players[playerIndex];
            const pos = position !== null ? position : player.position;
            const square = document.getElementById(`square-${pos}`);
            
            if (square) {
                // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÑÿßÿπÿ® ŸÖŸÜ ÿßŸÑŸÖŸàÿßŸÇÿπ ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©
                document.querySelectorAll('.player-token').forEach(token => {
                    if (token.dataset.player === playerIndex.toString()) {
                        token.remove();
                    }
                });
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÑÿßÿπÿ® ŸÑŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ¨ÿØŸäÿØ
                const token = document.createElement('div');
                token.className = 'player-token';
                token.dataset.player = playerIndex;
                token.style.cssText = `
                    width: 20px;
                    height: 20px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, 
                        ${getPlayerColor(playerIndex)}, 
                        ${getDarkerColor(getPlayerColor(playerIndex))});
                    border: 2px solid white;
                    position: absolute;
                    bottom: ${5 + (playerIndex * 25)}px;
                    right: 5px;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
                    animation: bounceIn 0.5s ease-out;
                    z-index: 100;
                `;
                token.textContent = (playerIndex + 1);
                token.style.color = 'white';
                token.style.fontSize = '12px';
                token.style.fontWeight = 'bold';
                token.style.display = 'flex';
                token.style.alignItems = 'center';
                token.style.justifyContent = 'center';
                
                square.appendChild(token);
            }
        }

        function highlightSquare(position) {
            // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ™ŸÖŸäŸäÿ≤ ÿßŸÑÿ≥ÿßÿ®ŸÇ
            document.querySelectorAll('.square-highlight').forEach(el => el.classList.remove('square-highlight'));
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ŸÖŸäŸäÿ≤ ŸÑŸÑŸÖÿ±ÿ®ÿπ ÿßŸÑÿ≠ÿßŸÑŸä
            const square = document.getElementById(`square-${position}`);
            if (square) {
                square.classList.add('square-highlight');
                setTimeout(() => square.classList.remove('square-highlight'), 300);
            }
        }

        function getPlayerColor(playerIndex) {
            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#F4A460', '#98D8C8'];
            return colors[playerIndex % colors.length];
        }

        function getDarkerColor(color) {
            // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑŸÑŸàŸÜ ŸÑÿØÿ±ÿ¨ÿ© ÿ£ÿ∫ŸÖŸÇ
            const hex = color.replace('#', '');
            const r = Math.max(0, parseInt(hex.substr(0, 2), 16) - 50);
            const g = Math.max(0, parseInt(hex.substr(2, 2), 16) - 50);
            const b = Math.max(0, parseInt(hex.substr(4, 2), 16) - 50);
            return `rgb(${r}, ${g}, ${b})`;
        }

        function handleSquareLanding(playerIndex, position) {
            const player = gameState.players[playerIndex];
            const property = omanProperties[position];

            // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ÿÆÿßÿµ ŸÑŸÑŸÜÿ≤ŸàŸÑ
            const square = document.getElementById(`square-${position}`);
            if (square) {
                square.classList.add('landing-effect');
                setTimeout(() => square.classList.remove('landing-effect'), 1000);
            }

            // ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑŸáÿ®Ÿàÿ∑ ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ± ÿµŸàÿ™Ÿä
            MessageSystem.show(`üéØ ${player.name} Ÿáÿ®ÿ∑ ÿπŸÑŸâ ${property.name}`, 'info', 3000);
            soundSystem.play('bell', 0.5);

            switch (property.type) {
                case 'property':
                case 'airport':
                case 'utility':
                    handlePropertyLanding(playerIndex, property);
                    break;
                case 'tax':
                    handleTax(playerIndex, property.price);
                    break;
                case 'chance':
                    handleChanceCard(playerIndex);
                    break;
                case 'community':
                    handleCommunityCard(playerIndex);
                    break;
                case 'go-to-jail':
                    handleGoToJail(playerIndex);
                    break;
                case 'start':
                    // ÿ™ÿ£ÿ´Ÿäÿ± ÿÆÿßÿµ ŸÑŸÑŸáÿ®Ÿàÿ∑ ÿπŸÑŸâ ÿßŸÑÿ®ÿØÿßŸäÿ©
                    confetti({
                        particleCount: 60,
                        spread: 80,
                        origin: { y: 0.8 }
                    });
                    break;
                case 'jail':
                    MessageSystem.show('üèõÔ∏è ŸÖÿ¨ÿ±ÿØ ÿ≤Ÿäÿßÿ±ÿ© ŸÑŸÑÿ≥ÿ¨ŸÜ!', 'info');
                    break;
                case 'free':
                    MessageSystem.show('üÖøÔ∏è ŸÖŸàŸÇŸÅ ŸÖÿ¨ÿßŸÜŸä - ÿßÿ≥ÿ™ÿ±ÿ≠!', 'success');
                    soundSystem.play('bonus', 0.7);
                    break;
            }

            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÑŸàÿ≠ÿ© ÿßŸÑŸÇŸäÿßÿØŸäÿ©
            LeaderboardSystem.updateLeaderboard();
        }

        function handlePropertyLanding(playerIndex, property) {
            const player = gameState.players[playerIndex];
            
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÖŸÑŸÉŸäÿ© ÿßŸÑÿπŸÇÿßÿ±
            const owner = gameState.players.find(p => p.properties.includes(property.id));
            
            if (!owner) {
                // ÿßŸÑÿπŸÇÿßÿ± ŸÖÿ™ÿßÿ≠ ŸÑŸÑÿ¥ÿ±ÿßÿ°
                showPropertyPurchaseDialog(playerIndex, player, property);
            } else if (owner !== player) {
                // ÿØŸÅÿπ ÿ•Ÿäÿ¨ÿßÿ±
                const rent = calculateRent(property, owner);
                handleRentPayment(player, owner, property, rent);
            } else {
                // ÿßŸÑÿπŸÇÿßÿ± ŸÖŸÖŸÑŸàŸÉ ŸÑŸÑÿßÿπÿ® ŸÜŸÅÿ≥Ÿá
                MessageSystem.show(`üè† ${property.name} ŸÖŸÖŸÑŸàŸÉ ŸÑŸÉ ÿ®ÿßŸÑŸÅÿπŸÑ!`, 'info');
                soundSystem.play('select', 0.5);
            }
        }

        function showPropertyPurchaseDialog(playerIndex, player, property) {
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®
            validatePlayerData(player);
            
            if (player.money < property.price) {
                MessageSystem.show(`üí∏ ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ŸÖÿßŸÑ ŸÉÿßŸÅŸç ŸÑÿ¥ÿ±ÿßÿ° ${property.name}! ÿ™ÿ≠ÿ™ÿßÿ¨ ${formatMoney(property.price)}`, 'error', 5000);
                soundSystem.play('lose');
                return;
            }

            // ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿßŸÅÿ∞ÿ© ÿ¥ÿ±ÿßÿ° ÿ™ŸÅÿßÿπŸÑŸäÿ©
            const modal = document.createElement('div');
            modal.className = 'purchase-modal';
            modal.innerHTML = `
                <div class="purchase-content">
                    <h2>üè† ÿ¥ÿ±ÿßÿ° ${property.name}</h2>
                    <div class="property-details">
                        <p><strong>ÿßŸÑÿ≥ÿπÿ±:</strong> ${formatMoney(property.price)}</p>
                        <p><strong>ÿßŸÑŸÖÿßŸÑŸÉ ÿßŸÑÿ≠ÿßŸÑŸä:</strong> ÿ∫Ÿäÿ± ŸÖŸÖŸÑŸàŸÉ</p>
                        <p><strong>ÿ±ÿµŸäÿØŸÉ:</strong> ${formatMoney(player.money)}</p>
                        <p><strong>ÿßŸÑÿ±ÿµŸäÿØ ÿ®ÿπÿØ ÿßŸÑÿ¥ÿ±ÿßÿ°:</strong> ${formatMoney(player.money - property.price)}</p>
                    </div>
                    <div class="purchase-buttons">
                        <button onclick="purchaseProperty(${playerIndex}, ${property.id})" class="btn-purchase">
                            üí∞ ÿ¥ÿ±ÿßÿ°
                        </button>
                        <button onclick="closePurchaseModal()" class="btn-decline">
                            ‚ùå ÿ±ŸÅÿ∂
                        </button>
                    </div>
                </div>
            `;
            
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: fadeIn 0.3s ease-out;
            `;

            document.body.appendChild(modal);
            soundSystem.play('notification');
        }

        function purchaseProperty(playerIndex, propertyId) {
            const player = gameState.players[playerIndex];
            const property = omanProperties[propertyId];
            
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÉŸÅÿßŸäÿ© ÿßŸÑŸÖÿßŸÑ
            if (player.money < property.price) {
                MessageSystem.show(`üí∏ ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ŸÖÿßŸÑ ŸÉÿßŸÅŸç ŸÑÿ¥ÿ±ÿßÿ° ${property.name}!`, 'error');
                closePurchaseModal();
                return;
            }

            player.money -= property.price;
            player.properties.push(propertyId);
            
            // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ©
            closePurchaseModal();
            
            // ÿ±ÿ≥ÿßÿ¶ŸÑ Ÿàÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑŸÜÿ¨ÿßÿ≠
            MessageSystem.showPropertyPurchase(player.name, property.name, property.price);
            soundSystem.playSequence(['buy', 'bonus'], 300);
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ŸÑŸÑÿ¥ÿ±ÿßÿ°
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.7 },
                colors: ['#FFD700', '#FFA500', '#FF8C00']
            });

            // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ∏Ÿáÿ± ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™
            updatePropertyDisplay();

            // ŸÅÿ≠ÿµ ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™
            AchievementSystem.checkAchievement(player, 'first_property');
            AchievementSystem.checkAchievement(player, 'millionaire');
            AchievementSystem.checkAchievement(player, 'monopoly_master');

            updatePlayersDisplay();
            LeaderboardSystem.updateLeaderboard();
        }

        function closePurchaseModal() {
            const modal = document.querySelector('.purchase-modal');
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease-in';
                setTimeout(() => modal.remove(), 300);
            }
        }

        function handleRentPayment(payer, receiver, property, rent) {
            payer.money -= rent;
            receiver.money += rent;
            
            MessageSystem.showRentPayment(payer.name, receiver.name, property.name, rent);
            soundSystem.play('lose');
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ŸÑÿØŸÅÿπ ÿßŸÑÿ•Ÿäÿ¨ÿßÿ±
            const payerElement = document.querySelector(`[data-player="${gameState.players.indexOf(payer)}"]`);
            if (payerElement) {
                payerElement.style.animation = 'shake 0.5s ease-in-out';
                setTimeout(() => payerElement.style.animation = '', 500);
            }

            // ŸÅÿ≠ÿµ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥ ÿ®ÿπÿØ ÿØŸÅÿπ ÿßŸÑÿ•Ÿäÿ¨ÿßÿ± ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑŸÖÿ≠ÿ≥ŸÜ
            const payerIndex = gameState.players.indexOf(payer);
            const isBankrupt = checkBankruptcyAfterPayment(payerIndex);
            
            if (!isBankrupt) {
                updatePlayersDisplay();
            }
            // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÖŸÅŸÑÿ≥ÿå ÿßŸÑÿØÿßŸÑÿ© ÿ≥ÿ™ÿ™ŸàŸÑŸâ ÿßŸÑÿπÿ±ÿ∂ ŸàÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ
        }

        function calculateRent(property, owner) {
            if (property.type === 'property') {
                return property.rent[0]; // ÿ•Ÿäÿ¨ÿßÿ± ÿ£ÿ≥ÿßÿ≥Ÿä (ŸäŸÖŸÉŸÜ ÿ™ÿ∑ŸàŸäÿ±Ÿá ŸÑÿßÿ≠ŸÇÿßŸã)
            } else if (property.type === 'airport') {
                const airportsOwned = owner.properties.filter(id => 
                    omanProperties[id].type === 'airport'
                ).length;
                return property.rent[airportsOwned - 1];
            } else if (property.type === 'utility') {
                const utilitiesOwned = owner.properties.filter(id => 
                    omanProperties[id].type === 'utility'
                ).length;
                return (utilitiesOwned === 1 ? 4 : 10) * (Math.floor(Math.random() * 6) + 1 + Math.floor(Math.random() * 6) + 1);
            }
            return 0;
        }

        function handleTax(playerIndex, amount) {
            const player = gameState.players[playerIndex];
            player.money -= amount;
            MessageSystem.show(`ÿØŸÅÿπÿ™ ${amount} ÿ±.ÿπ ÿ∂ÿ±Ÿäÿ®ÿ©`, 'error');
            soundSystem.play('lose');
            
            // ŸÅÿ≠ÿµ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥ ÿ®ÿπÿØ ÿØŸÅÿπ ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ©
            const isBankrupt = checkBankruptcyAfterPayment(playerIndex);
            
            if (!isBankrupt) {
                updatePlayersDisplay();
            }
        }

        // ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑÿµÿØŸÅÿ© ŸàÿßŸÑÿÆÿ≤ÿßŸÜÿ© ÿßŸÑÿπÿßŸÖÿ©
        const chanceCards = [
            { text: "üéâ ÿ™ŸÇÿØŸÖ ÿ•ŸÑŸâ ÿßŸÑÿ®ÿØÿßŸäÿ© Ÿàÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 200 ÿ±.ÿπ", action: "goToStart" },
            { text: "üè† ÿ™ŸÇÿØŸÖ ÿ•ŸÑŸâ ŸÖÿ≥ŸÇÿ∑ ÿßŸÑÿπÿßÿµŸÖÿ©", action: "goToProperty", property: 1 },
            { text: "üí∞ ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 150 ÿ±.ÿπ ŸÖŸÉÿßŸÅÿ£ÿ©", action: "money", amount: 150 },
            { text: "üìÑ ÿßÿØŸÅÿπ 50 ÿ±.ÿπ ÿ∂ÿ±Ÿäÿ®ÿ©", action: "money", amount: -50 },
            { text: "üöó ÿ™ŸÇÿØŸÖ ÿ•ŸÑŸâ ÿ£ŸÇÿ±ÿ® ŸÖÿ∑ÿßÿ±", action: "goToNearestAirport" },
            { text: "‚¨ÖÔ∏è ÿßÿ±ÿ¨ÿπ 3 ŸÖÿ±ÿ®ÿπÿßÿ™", action: "moveBack", spaces: 3 },
            { text: "üèõÔ∏è ÿßÿ∞Ÿáÿ® ÿ•ŸÑŸâ ÿßŸÑÿ≥ÿ¨ŸÜ ŸÖÿ®ÿßÿ¥ÿ±ÿ©", action: "goToJail" },
            { text: "üéÅ ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 100 ÿ±.ÿπ ŸÖŸÜ ŸÉŸÑ ŸÑÿßÿπÿ®", action: "collectFromPlayers", amount: 100 },
            { text: "üîß ÿßÿØŸÅÿπ 40 ÿ±.ÿπ ŸÑŸÉŸÑ ŸÖŸÜÿ≤ŸÑ Ÿà 115 ÿ±.ÿπ ŸÑŸÉŸÑ ŸÅŸÜÿØŸÇ", action: "payForBuildings" },
            { text: "üéØ ÿ™ŸÇÿØŸÖ ÿ•ŸÑŸâ ÿµŸÑÿßŸÑÿ©", action: "goToProperty", property: 11 },
            { text: "üè¶ ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 200 ÿ±.ÿπ ŸÖŸÜ ÿßŸÑÿ®ŸÜŸÉ", action: "money", amount: 200 },
            { text: "üö´ ÿßÿØŸÅÿπ ÿ∫ÿ±ÿßŸÖÿ© 15 ÿ±.ÿπ", action: "money", amount: -15 }
        ];

        const communityCards = [
            { text: "üéì ÿ≠ÿµŸÑÿ™ ÿπŸÑŸâ ŸÖŸÜÿ≠ÿ© ÿØÿ±ÿßÿ≥Ÿäÿ© - ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 200 ÿ±.ÿπ", action: "money", amount: 200 },
            { text: "üè• ÿßÿØŸÅÿπ ŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÖÿ≥ÿ™ÿ¥ŸÅŸâ 100 ÿ±.ÿπ", action: "money", amount: -100 },
            { text: "üìà ÿ£ÿ±ÿ®ÿßÿ≠ ÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±ŸÉ - ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 50 ÿ±.ÿπ", action: "money", amount: 50 },
            { text: "üéÇ ÿπŸäÿØ ŸÖŸäŸÑÿßÿØŸÉ - ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 10 ÿ±.ÿπ ŸÖŸÜ ŸÉŸÑ ŸÑÿßÿπÿ®", action: "collectFromPlayers", amount: 10 },
            { text: "üöó ÿ∫ÿ±ÿßŸÖÿ© ÿ≥ÿ±ÿπÿ© - ÿßÿØŸÅÿπ 50 ÿ±.ÿπ", action: "money", amount: -50 },
            { text: "üíº ŸÖŸÉÿßŸÅÿ£ÿ© ÿÆÿØŸÖÿßÿ™ - ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 100 ÿ±.ÿπ", action: "money", amount: 100 },
            { text: "üèõÔ∏è ÿßÿ∞Ÿáÿ® ÿ•ŸÑŸâ ÿßŸÑÿ≥ÿ¨ŸÜ ŸÖÿ®ÿßÿ¥ÿ±ÿ©", action: "goToJail" },
            { text: "üéâ ÿ™ŸÇÿØŸÖ ÿ•ŸÑŸâ ÿßŸÑÿ®ÿØÿßŸäÿ© Ÿàÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 200 ÿ±.ÿπ", action: "goToStart" },
            { text: "üè† ÿßÿØŸÅÿπ 40 ÿ±.ÿπ ŸÑŸÉŸÑ ŸÖŸÜÿ≤ŸÑ Ÿà 115 ÿ±.ÿπ ŸÑŸÉŸÑ ŸÅŸÜÿØŸÇ", action: "payForBuildings" },
            { text: "üìÑ ÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑÿØÿÆŸÑ - ÿßÿØŸÅÿπ 200 ÿ±.ÿπ", action: "money", amount: -200 },
            { text: "üéÅ Ÿàÿ±ÿßÿ´ÿ© - ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 100 ÿ±.ÿπ", action: "money", amount: 100 },
            { text: "üí≥ ÿÆÿ∑ÿ£ ÿ®ŸÜŸÉŸä ŸÑÿµÿßŸÑÿ≠ŸÉ - ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 75 ÿ±.ÿπ", action: "money", amount: 75 }
        ];

        function handleChanceCard(playerIndex) {
            console.log('üé≤ ÿ™ŸÅÿπŸäŸÑ ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿµÿØŸÅÿ© ŸÑŸÑÿßÿπÿ®:', playerIndex);
            const card = chanceCards[Math.floor(Math.random() * chanceCards.length)];
            console.log('ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÖÿÆÿ™ÿßÿ±ÿ©:', card);
            showCardModal(playerIndex, card, 'chance');
        }

        function handleCommunityCard(playerIndex) {
            console.log('üèõÔ∏è ÿ™ŸÅÿπŸäŸÑ ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿÆÿ≤ÿßŸÜÿ© ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÑÿßÿπÿ®:', playerIndex);
            const card = communityCards[Math.floor(Math.random() * communityCards.length)];
            console.log('ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÖÿÆÿ™ÿßÿ±ÿ©:', card);
            showCardModal(playerIndex, card, 'community');
        }

        function showCardModal(playerIndex, card, type) {
            const player = gameState.players[playerIndex];
            const cardTitle = type === 'chance' ? 'üé≤ ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿµÿØŸÅÿ©' : 'üèõÔ∏è ÿµŸÜÿØŸàŸÇ ÿßŸÑÿÆÿ≤ÿßŸÜÿ© ÿßŸÑÿπÿßŸÖÿ©';
            const cardColor = type === 'chance' ? '#e74c3c' : '#3498db';

            const modal = document.createElement('div');
            modal.className = 'card-modal';
            modal.innerHTML = `
                <div class="card-content" style="border-color: ${cardColor}">
                    <h2 style="color: white !important">${cardTitle}</h2>
                    <div class="card-text">
                        <p>${card.text}</p>
                    </div>
                    <div class="card-player">
                        <strong>${player.name}</strong>
                    </div>
                    <button onclick="executeCardAction(${playerIndex}, '${encodeURIComponent(JSON.stringify(card))}', '${type}')" 
                            class="btn-execute" style="background: ${cardColor}">
                        ‚ú® ÿ™ŸÜŸÅŸäÿ∞ ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
                    </button>
                </div>
            `;

            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: cardSlideIn 0.5s ease-out;
            `;

            document.body.appendChild(modal);
            soundSystem.play('reveal');
        }

        function executeCardAction(playerIndex, encodedCardData, type) {
            const player = gameState.players[playerIndex];
            const card = JSON.parse(decodeURIComponent(encodedCardData));

            // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ±
            const modal = document.querySelector('.card-modal');
            if (modal) {
                modal.style.animation = 'cardSlideOut 0.3s ease-in';
                setTimeout(() => modal.remove(), 300);
            }

            // ÿ™ÿ£ÿ´Ÿäÿ± ÿµŸàÿ™Ÿä ŸÑŸÑÿ™ŸÜŸÅŸäÿ∞
            soundSystem.play('select');

            setTimeout(() => {
                switch (card.action) {
                    case 'money':
                        handleMoneyChange(playerIndex, card.amount);
                        break;
                    case 'goToStart':
                        movePlayerToPosition(playerIndex, 0);
                        player.money += 200; // ŸÖŸÉÿßŸÅÿ£ÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ŸÖŸÜ ÿßŸÑÿ®ÿØÿßŸäÿ©
                        MessageSystem.show(`üéâ ${player.name} ŸàÿµŸÑ ŸÑŸÑÿ®ÿØÿßŸäÿ© Ÿàÿ≠ÿµŸÑ ÿπŸÑŸâ 200 ÿ±.ÿπ!`, 'success');
                        soundSystem.play('bonus');
                        break;
                    case 'goToProperty':
                        movePlayerToPosition(playerIndex, card.property);
                        break;
                    case 'goToJail':
                        handleGoToJail(playerIndex);
                        break;
                    case 'goToNearestAirport':
                        moveToNearestAirport(playerIndex);
                        break;
                    case 'moveBack':
                        movePlayerBack(playerIndex, card.spaces);
                        break;
                    case 'collectFromPlayers':
                        collectFromAllPlayers(playerIndex, card.amount);
                        break;
                    case 'payForBuildings':
                        payForBuildings(playerIndex);
                        break;
                }

                updatePlayersDisplay();
                LeaderboardSystem.updateLeaderboard();
            }, 500);
        }

        function handleMoneyChange(playerIndex, amount) {
            const player = gameState.players[playerIndex];
            const oldMoney = player.money;
            player.money += amount;

            if (amount > 0) {
                MessageSystem.show(`üí∞ ${player.name} ÿ≠ÿµŸÑ ÿπŸÑŸâ ${amount} ÿ±.ÿπ!`, 'success');
                soundSystem.play('bonus');
                confetti({
                    particleCount: 50,
                    spread: 60,
                    origin: { y: 0.8 },
                    colors: ['#FFD700', '#32CD32']
                });
            } else {
                MessageSystem.show(`üí∏ ${player.name} ÿØŸÅÿπ ${Math.abs(amount)} ÿ±.ÿπ!`, 'error');
                soundSystem.play('lose');
                
                // ŸÅÿ≠ÿµ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥
                if (player.money < 0) {
                    handleBankruptcy(playerIndex, Math.abs(amount));
                }
            }
        }

        // ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥ ÿßŸÑŸÖÿ™ÿ∑Ÿàÿ±
        function handleBankruptcy(playerIndex, debtAmount) {
            const player = gameState.players[playerIndex];
            const debt = Math.abs(player.money); // ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ≥ÿßŸÑÿ®
            
            console.log(`üí∏ ${player.name} ŸÖŸÅŸÑÿ≥! ÿßŸÑÿØŸäŸÜ: ${debt} ÿ±.ÿπ`);
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ© ŸÑŸÖŸÖÿ™ŸÑŸÉÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®
            const totalAssets = calculatePlayerAssets(player);
            
            if (totalAssets >= debt) {
                // ŸäŸÖŸÉŸÜ ÿ•ŸÜŸÇÿßÿ∞Ÿá ÿ®ÿ®Ÿäÿπ ÿßŸÑŸÖŸÖÿ™ŸÑŸÉÿßÿ™
                showBankruptcyOptions(playerIndex, debt, totalAssets);
            } else {
                // ÿ•ŸÅŸÑÿßÿ≥ ŸÜŸáÿßÿ¶Ÿä ŸÅŸàÿ±Ÿä
                console.log(`üíî ${player.name} - ÿ•ŸÅŸÑÿßÿ≥ ŸÜŸáÿßÿ¶Ÿä! ÿßŸÑŸÖŸÖÿ™ŸÑŸÉÿßÿ™ ÿ∫Ÿäÿ± ŸÉÿßŸÅŸäÿ©`);
                declareBankruptcy(playerIndex);
            }
        }

        // ŸÅÿ≠ÿµ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥ ÿßŸÑÿ∞ŸÉŸä - Ÿäÿ™ŸÖ ÿßÿ≥ÿ™ÿØÿπÿßÿ§Ÿá ÿ®ÿπÿØ ÿ£Ÿä ÿπŸÖŸÑŸäÿ© ÿØŸÅÿπ
        function checkBankruptcyAfterPayment(playerIndex) {
            const player = gameState.players[playerIndex];
            
            if (player.money < 0 && !player.isBankrupt) {
                console.log(`üö® ÿßŸÉÿ™ÿ¥ÿßŸÅ ŸÖÿßŸÑ ÿ≥ÿßŸÑÿ® ŸÑŸÄ ${player.name}: ${player.money} ÿ±.ÿπ`);
                setTimeout(() => {
                    handleBankruptcy(playerIndex, Math.abs(player.money));
                }, 500); // ÿ™ÿ£ÿÆŸäÿ± ÿµÿ∫Ÿäÿ± ŸÑŸÑÿ≥ŸÖÿßÿ≠ ÿ®ÿßŸÜÿ™Ÿáÿßÿ° ÿßŸÑÿπŸÖŸÑŸäÿßÿ™ ÿßŸÑÿ£ÿÆÿ±Ÿâ
                return true; // Ÿäÿ¥Ÿäÿ± ÿ•ŸÑŸâ Ÿàÿ¨ŸàÿØ ÿ•ŸÅŸÑÿßÿ≥
            }
            return false; // ŸÑÿß ŸäŸàÿ¨ÿØ ÿ•ŸÅŸÑÿßÿ≥
        }

        function calculatePlayerAssets(player) {
            let totalValue = 0;
            
            // ŸÇŸäŸÖÿ© ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ (ŸÜÿµŸÅ ÿßŸÑÿ≥ÿπÿ± ÿßŸÑÿ£ÿµŸÑŸä)
            if (player.properties) {
                player.properties.forEach(propId => {
                    const property = omanProperties.find(p => p.id === propId);
                    if (property) {
                        totalValue += Math.floor(property.price * 0.5); // ÿ®Ÿäÿπ ÿ®ŸÜÿµŸÅ ÿßŸÑÿ≥ÿπÿ±
                    }
                });
            }
            
            return totalValue;
        }

        function showBankruptcyOptions(playerIndex, debt, totalAssets) {
            const player = gameState.players[playerIndex];
            
            const modal = document.createElement('div');
            modal.className = 'bankruptcy-modal';
            modal.innerHTML = `
                <div class="bankruptcy-content">
                    <div class="bankruptcy-header">
                        <h2 style="color: #e74c3c;">üí∏ ÿ•ŸÜÿ∞ÿßÿ± ÿ•ŸÅŸÑÿßÿ≥!</h2>
                        <div class="bankruptcy-warning">
                            ‚ö†Ô∏è ${player.name} ŸÑÿß ŸäŸÖŸÑŸÉ ŸÖÿßŸÑÿßŸã ŸÉÿßŸÅŸäÿßŸã!
                        </div>
                    </div>
                    
                    <div class="bankruptcy-details">
                        <div class="debt-info">
                            <div class="debt-label">üí∞ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®:</div>
                            <div class="debt-amount">${formatMoney(debt)}</div>
                        </div>
                        
                        <div class="assets-info">
                            <div class="assets-label">üè† ŸÇŸäŸÖÿ© ÿßŸÑŸÖŸÖÿ™ŸÑŸÉÿßÿ™:</div>
                            <div class="assets-amount">${formatMoney(totalAssets)}</div>
                        </div>
                        
                        <div class="current-money">
                            <div class="money-label">üí∏ ÿßŸÑÿ±ÿµŸäÿØ ÿßŸÑÿ≠ÿßŸÑŸä:</div>
                            <div class="money-amount negative">${formatMoney(player.money)}</div>
                        </div>
                    </div>
                    
                    <div class="bankruptcy-options">
                        <button onclick="sellProperties(${playerIndex}, ${debt})" class="bankruptcy-btn sell-btn">
                            üè† ÿ®Ÿäÿπ ÿßŸÑŸÖŸÖÿ™ŸÑŸÉÿßÿ™
                            <small>ÿ®Ÿäÿπ ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ŸÑÿ≥ÿØÿßÿØ ÿßŸÑÿØŸäŸÜ</small>
                        </button>
                        
                        <button onclick="declareBankruptcy(${playerIndex})" class="bankruptcy-btn bankrupt-btn">
                            üíî ÿ•ÿπŸÑÿßŸÜ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥
                            <small>ÿßŸÑÿÆÿ±Ÿàÿ¨ ŸÖŸÜ ÿßŸÑŸÑÿπÿ®ÿ©</small>
                        </button>
                        
                        <div class="bankruptcy-help">
                            üí° ŸäŸÖŸÉŸÜŸÉ ÿ®Ÿäÿπ ÿπŸÇÿßÿ±ÿßÿ™ŸÉ ÿ®ŸÜÿµŸÅ ÿßŸÑÿ≥ÿπÿ± ÿßŸÑÿ£ÿµŸÑŸä ŸÑÿ≥ÿØÿßÿØ ÿßŸÑÿØŸäŸÜ
                            <br>‚è∞ ÿ≥Ÿäÿ™ŸÖ ÿ•ÿπŸÑÿßŸÜ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿÆŸÑÿßŸÑ 30 ÿ´ÿßŸÜŸäÿ©
                        </div>
                    </div>
                </div>
            `;

            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: bankruptcySlideIn 0.5s ease-out;
            `;

            document.body.appendChild(modal);
            soundSystem.play('lose');

            // ÿ•ŸÅŸÑÿßÿ≥ ÿ™ŸÑŸÇÿßÿ¶Ÿä ÿ®ÿπÿØ 30 ÿ´ÿßŸÜŸäÿ© ŸÑŸÖŸÜÿπ ÿßŸÑÿ™ÿπŸÑŸäŸÇ
            setTimeout(() => {
                const stillOpen = document.querySelector('.bankruptcy-modal');
                if (stillOpen) {
                    console.log('‚è∞ ÿ•ŸÅŸÑÿßÿ≥ ÿ™ŸÑŸÇÿßÿ¶Ÿä ÿ®ÿπÿØ ÿßŸÜÿ™Ÿáÿßÿ° ÿßŸÑŸàŸÇÿ™');
                    declareBankruptcy(playerIndex);
                }
            }, 30000);
        }

        function sellProperties(playerIndex, debt) {
            const player = gameState.players[playerIndex];
            let totalSold = 0;
            const soldProperties = [];

            // ÿ®Ÿäÿπ ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ Ÿàÿßÿ≠ÿØÿßŸã ÿ™ŸÑŸà ÿßŸÑÿ¢ÿÆÿ± ÿ≠ÿ™Ÿâ ÿ≥ÿØÿßÿØ ÿßŸÑÿØŸäŸÜ
            if (player.properties) {
                for (let i = player.properties.length - 1; i >= 0 && (player.money + totalSold) < 0; i--) {
                    const propId = player.properties[i];
                    const property = omanProperties.find(p => p.id === propId);
                    
                    if (property) {
                        const sellPrice = Math.floor(property.price * 0.5);
                        totalSold += sellPrice;
                        soldProperties.push(property.name);
                        
                        // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿπŸÇÿßÿ± ŸÖŸÜ ŸÖŸÑŸÉŸäÿ© ÿßŸÑŸÑÿßÿπÿ®
                        player.properties.splice(i, 1);
                        
                        // ÿ•ÿ≤ÿßŸÑÿ© ŸÖŸÑŸÉŸäÿ© ÿßŸÑÿπŸÇÿßÿ± ŸÖŸÜ ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÑÿπÿ®ÿ©
                        delete gameState.propertyOwners[propId];
                    }
                }
            }

            // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿßŸÑ ÿßŸÑŸÖÿ≠ÿµŸÑ ŸÖŸÜ ÿßŸÑÿ®Ÿäÿπ
            player.money += totalSold;

            // ÿ•ÿ∫ŸÑÿßŸÇ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ•ŸÅŸÑÿßÿ≥
            const modal = document.querySelector('.bankruptcy-modal');
            if (modal) modal.remove();

            // ÿπÿ±ÿ∂ ŸÜÿ™Ÿäÿ¨ÿ© ÿßŸÑÿ®Ÿäÿπ
            if (player.money >= 0) {
                MessageSystem.show(`üè† ${player.name} ÿ®ÿßÿπ ÿπŸÇÿßÿ±ÿßÿ™Ÿá ŸÖŸÇÿßÿ®ŸÑ ${formatMoney(totalSold)} Ÿàÿ™ÿ¨ŸÜÿ® ÿßŸÑÿ•ŸÅŸÑÿßÿ≥!`, 'success');
                soundSystem.play('victory');
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.8 },
                    colors: ['#27AE60', '#F39C12']
                });
            } else {
                MessageSystem.show(`üí∏ ÿßŸÑÿ®Ÿäÿπ ŸÑŸÖ ŸäŸÉŸÅŸê! ${player.name} ŸÖÿß ÿ≤ÿßŸÑ ŸÖÿØŸäŸÜÿßŸã ÿ®ŸÄ ${formatMoney(Math.abs(player.money))}`, 'error');
                // ŸÑÿß Ÿäÿ≤ÿßŸÑ ŸÖŸÅŸÑÿ≥ÿßŸã
                setTimeout(() => {
                    declareBankruptcy(playerIndex);
                }, 2000);
            }

            updatePlayersDisplay();
            LeaderboardSystem.updateLeaderboard();
        }

        function declareBankruptcy(playerIndex) {
            const player = gameState.players[playerIndex];
            
            // ÿ•ÿ∫ŸÑÿßŸÇ ÿ£Ÿä ŸÜŸàÿßŸÅÿ∞ ŸÖŸÅÿ™Ÿàÿ≠ÿ©
            const modal = document.querySelector('.bankruptcy-modal');
            if (modal) modal.remove();

            // ÿ•ÿπŸÑÿßŸÜ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥
            MessageSystem.show(`üíî ${player.name} ÿ£ÿπŸÑŸÜ ÿ•ŸÅŸÑÿßÿ≥Ÿá ŸàÿÆÿ±ÿ¨ ŸÖŸÜ ÿßŸÑŸÑÿπÿ®ÿ©!`, 'error', 8000, true);
            soundSystem.play('lose');

            // ÿ™ÿ≠ÿ±Ÿäÿ± ÿ¨ŸÖŸäÿπ ŸÖŸÖÿ™ŸÑŸÉÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®
            if (player.properties) {
                player.properties.forEach(propId => {
                    delete gameState.propertyOwners[propId];
                });
            }

            // Ÿàÿ∂ÿπ ÿπŸÑÿßŸÖÿ© ÿßŸÑÿ•ŸÅŸÑÿßÿ≥
            player.isBankrupt = true;
            player.money = 0;
            player.properties = [];

            // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿ®ÿµÿ±Ÿäÿ© ŸÑŸÑÿ•ŸÅŸÑÿßÿ≥
            createBankruptcyEffect(player.name);

            // ŸÅÿ≠ÿµ ÿ•ÿ∞ÿß ÿ®ŸÇŸä ŸÑÿßÿπÿ® Ÿàÿßÿ≠ÿØ ŸÅŸÇÿ∑
            const activePlayers = gameState.players.filter(p => !p.isBankrupt);
            if (activePlayers.length === 1) {
                // ŸÅŸàÿ≤ ÿ®ÿßŸÑÿ•ŸÅŸÑÿßÿ≥
                setTimeout(() => {
                    handleGameWin(activePlayers[0]);
                }, 3000);
                return;
            } else if (activePlayers.length === 0) {
                // ÿ¨ŸÖŸäÿπ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ŸÖŸÅŸÑÿ≥ŸàŸÜ (ŸÜÿßÿØÿ± ÿ¨ÿØÿßŸã)
                MessageSystem.show('üè¶ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿ£ŸÅŸÑÿ≥Ÿàÿß! ÿßŸÑÿ®ŸÜŸÉ ŸäŸÅŸàÿ≤! üòÖ', 'info', 8000);
                return;
            }

            updatePlayersDisplay();
            LeaderboardSystem.updateLeaderboard();

            // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑŸÖŸÅŸÑÿ≥ ŸáŸà ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ≠ÿßŸÑŸäÿå ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ŸÑŸÑÿØŸàÿ± ÿßŸÑÿ™ÿßŸÑŸä
            if (playerIndex === gameState.currentPlayer) {
                console.log('üîÑ ÿßŸÜÿ™ŸÇÿßŸÑ ÿ™ŸÑŸÇÿßÿ¶Ÿä ŸÑŸÑÿØŸàÿ± ÿßŸÑÿ™ÿßŸÑŸä ÿ®ÿπÿØ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥');
                setTimeout(() => {
                    nextTurn();
                    // ÿ™ŸÅÿπŸäŸÑ ÿ≤ÿ± ÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ ŸÑŸÑÿßÿπÿ® ÿßŸÑÿ¨ÿØŸäÿØ
                    document.getElementById('rollDice').disabled = false;
                    document.getElementById('endTurn').disabled = true;
                }, 2000);
            }
        }

        function createBankruptcyEffect(playerName) {
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ŸÑŸÑÿ•ŸÅŸÑÿßÿ≥
            const effect = document.createElement('div');
            effect.innerHTML = `
                <div style="
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: linear-gradient(45deg, #e74c3c, #c0392b);
                    color: white;
                    padding: 30px;
                    border-radius: 20px;
                    text-align: center;
                    z-index: 10001;
                    box-shadow: 0 20px 40px rgba(0,0,0,0.5);
                    animation: bankruptcyExplosion 3s ease-out forwards;
                ">
                    <div style="font-size: 3em;">üíî</div>
                    <div style="font-size: 1.5em; margin: 10px 0;">${playerName}</div>
                    <div style="font-size: 2em; font-weight: bold;">ŸÖŸèŸÅŸÑŸêÿ≥!</div>
                </div>
            `;
            
            document.body.appendChild(effect);
            
            setTimeout(() => {
                effect.remove();
            }, 3000);
        }

        function moveToNearestAirport(playerIndex) {
            const player = gameState.players[playerIndex];
            const airports = [5, 15, 25, 35]; // ŸÖŸàÿßŸÇÿπ ÿßŸÑŸÖÿ∑ÿßÿ±ÿßÿ™
            let nearestAirport = airports[0];
            let minDistance = Math.abs(player.position - airports[0]);

            airports.forEach(airport => {
                const distance = (airport - player.position + 40) % 40;
                if (distance < minDistance) {
                    nearestAirport = airport;
                    minDistance = distance;
                }
            });

            movePlayerToPosition(playerIndex, nearestAirport);
        }

        function collectFromAllPlayers(playerIndex, amount) {
            const player = gameState.players[playerIndex];
            let totalCollected = 0;

            gameState.players.forEach((otherPlayer, index) => {
                if (index !== playerIndex) {
                    const payment = Math.min(amount, otherPlayer.money);
                    otherPlayer.money -= payment;
                    totalCollected += payment;
                }
            });

            player.money += totalCollected;
            MessageSystem.show(`üí∞ ${player.name} ÿ¨ŸÖÿπ ${totalCollected} ÿ±.ÿπ ŸÖŸÜ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ!`, 'success');
            soundSystem.play('win');
        }

        function handleSpecialCard(playerIndex, cardType) {
            if (cardType === 'chance') {
                handleChanceCard(playerIndex);
            } else {
                handleCommunityCard(playerIndex);
            }
        }

        function movePlayerBack(playerIndex, spaces) {
            const player = gameState.players[playerIndex];
            const newPosition = (player.position - spaces + 40) % 40;
            movePlayerToPosition(playerIndex, newPosition);
        }

        function movePlayerToPosition(playerIndex, targetPosition) {
            const player = gameState.players[playerIndex];
            const oldPosition = player.position;
            
            // ÿ•ÿ∞ÿß ŸÖÿ± ŸÖŸÜ ÿßŸÑÿ®ÿØÿßŸäÿ©ÿå ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 200 ÿ±.ÿπ
            if (targetPosition < oldPosition && targetPosition !== 0) {
                player.money += 200;
                MessageSystem.show(`üí∞ ${player.name} ŸÖÿ± ŸÖŸÜ ÿßŸÑÿ®ÿØÿßŸäÿ© Ÿàÿ≠ÿµŸÑ ÿπŸÑŸâ 200 ÿ±.ÿπ!`, 'success');
            }
            
            player.position = targetPosition;
            animatePlayerMovement(playerIndex, oldPosition, targetPosition, () => {
                handleSquareLanding(playerIndex, targetPosition);
            });
        }

        function payForBuildings(playerIndex) {
            const player = gameState.players[playerIndex];
            // ÿ≠ÿ≥ÿßÿ® ÿ™ŸÉŸÑŸÅÿ© ÿßŸÑŸÖÿ®ÿßŸÜŸä (ÿ≥Ÿäÿ™ŸÖ ÿ™ÿ∑ŸàŸäÿ± ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ®ŸÜÿßÿ° ŸÑÿßÿ≠ŸÇÿßŸã)
            const houseCost = 40;
            const hotelCost = 115;
            
            // ŸÑŸÑÿ¢ŸÜÿå ÿ≥Ÿäÿ™ŸÖ ÿØŸÅÿπ ŸÖÿ®ŸÑÿ∫ ÿ´ÿßÿ®ÿ™
            const totalCost = 100;
            player.money -= totalCost;
            
            MessageSystem.show(`üè† ${player.name} ÿØŸÅÿπ ${totalCost} ÿ±.ÿπ ÿ±ÿ≥ŸàŸÖ ÿµŸäÿßŸÜÿ©!`, 'error');
            soundSystem.play('lose');
        }

        function handleTax(playerIndex, amount) {
            const player = gameState.players[playerIndex];
            player.money -= amount;
            
            MessageSystem.show(`üìÑ ${player.name} ÿØŸÅÿπ ${amount} ÿ±.ÿπ ÿ∂ÿ±Ÿäÿ®ÿ©!`, 'error');
            soundSystem.play('lose');
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ŸÑŸÑÿ∂ÿ±Ÿäÿ®ÿ©
            const playerElement = document.querySelector(`[data-player="${playerIndex}"]`);
            if (playerElement) {
                playerElement.classList.add('shake');
                setTimeout(() => playerElement.classList.remove('shake'), 500);
            }
            
            updatePlayersDisplay();
        }

        function handleGoToJail(playerIndex) {
            const player = gameState.players[playerIndex];
            const oldPosition = player.position;
            player.position = 10; // ŸÖŸàŸÇÿπ ÿßŸÑÿ≥ÿ¨ŸÜ
            player.inJail = true;
            player.jailTurns = 0;
            
            MessageSystem.show(`üèõÔ∏è ${player.name} ÿ∞Ÿáÿ® ÿ•ŸÑŸâ ÿßŸÑÿ≥ÿ¨ŸÜ!`, 'error');
            soundSystem.play('lose');
            
            // ÿ™ÿ≠ÿ±ŸäŸÉ ÿßŸÑŸÑÿßÿπÿ® ÿ•ŸÑŸâ ÿßŸÑÿ≥ÿ¨ŸÜ ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ± ÿÆÿßÿµ
            animatePlayerMovement(playerIndex, oldPosition, 10, () => {
                const jailSquare = document.getElementById('square-10');
                if (jailSquare) {
                    jailSquare.classList.add('pulse-effect');
                    setTimeout(() => jailSquare.classList.remove('pulse-effect'), 600);
                }
            });
            
            updatePlayersDisplay();
        }

        // ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≥ÿ¨ŸÜ ÿßŸÑŸÖÿ™ÿ∑Ÿàÿ±
        function handleJailTurn(player) {
            player.jailTurns++;
            
            // ÿ™ÿπÿ∑ŸäŸÑ ÿ≤ÿ± ÿßŸÑŸÜÿ±ÿØ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©
            document.getElementById('rollDice').disabled = true;
            
            MessageSystem.show(`üèõÔ∏è ${player.name} ŸÅŸä ÿßŸÑÿ≥ÿ¨ŸÜ - ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ${player.jailTurns}/3`, 'warning', 3000);
            
            // ÿπÿ±ÿ∂ ÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑÿÆÿ±Ÿàÿ¨ ŸÖŸÜ ÿßŸÑÿ≥ÿ¨ŸÜ
            showJailOptions(player);
        }

        function showJailOptions(player) {
            const modal = document.createElement('div');
            modal.className = 'jail-modal';
            modal.innerHTML = `
                <div class="jail-content">
                    <h2 style="color: #e74c3c;">üèõÔ∏è ${player.name} ŸÅŸä ÿßŸÑÿ≥ÿ¨ŸÜ</h2>
                    <p>ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ${player.jailTurns} ŸÖŸÜ 3</p>
                    
                    <div class="jail-options">
                        <button onclick="tryJailEscape('dice')" class="jail-btn jail-btn-try">
                            üé≤ ÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ ŸÑŸÑÿÆÿ±Ÿàÿ¨
                            <small>ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ≤Ÿàÿ¨Ÿä ŸÑŸÑÿÆÿ±Ÿàÿ¨</small>
                        </button>
                        
                        <button onclick="tryJailEscape('pay')" class="jail-btn jail-btn-pay">
                            üí∞ ÿØŸÅÿπ ŸÉŸÅÿßŸÑÿ© 50 ÿ±.ÿπ
                            <small>ÿßŸÑÿÆÿ±Ÿàÿ¨ ŸÅŸàÿ±ÿßŸã</small>
                        </button>
                        
                        ${player.jailTurns >= 3 ? `
                            <div style="background: #e74c3c; color: white; padding: 10px; border-radius: 10px; margin-top: 10px;">
                                ‚ö†Ô∏è ŸÖÿ≠ÿßŸàŸÑÿ™ŸÉ ÿßŸÑÿ£ÿÆŸäÿ±ÿ©! ÿ≥Ÿäÿ™ŸÖ ÿ•ÿ¨ÿ®ÿßÿ±ŸÉ ÿπŸÑŸâ ÿßŸÑÿØŸÅÿπ ÿ•ÿ∞ÿß ŸÅÿ¥ŸÑÿ™.
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;

            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: fadeIn 0.3s ease-out;
            `;

            document.body.appendChild(modal);
            soundSystem.play('notification');
        }

        function tryJailEscape(method) {
            const player = gameState.players[gameState.currentPlayer];
            const modal = document.querySelector('.jail-modal');
            
            if (method === 'pay') {
                // ÿØŸÅÿπ ÿßŸÑŸÉŸÅÿßŸÑÿ©
                if (player.money >= 50) {
                    player.money -= 50;
                    releaseFromJail(player, 'paid');
                } else {
                    MessageSystem.show('üí∏ ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ŸÖÿßŸÑ ŸÉÿßŸÅŸç ŸÑŸÑŸÉŸÅÿßŸÑÿ©!', 'error');
                    return;
                }
            } else if (method === 'dice') {
                // ÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ ŸÑŸÑÿÆÿ±Ÿàÿ¨
                const dice1 = Math.floor(Math.random() * 6) + 1;
                const dice2 = Math.floor(Math.random() * 6) + 1;
                const isDouble = dice1 === dice2;
                
                updateDiceDisplay(dice1, dice2);
                
                if (isDouble) {
                    // ŸÜÿ¨ÿ≠ ŸÅŸä ÿßŸÑÿÆÿ±Ÿàÿ¨
                    releaseFromJail(player, 'escaped');
                    // Ÿäÿ™ÿ≠ÿ±ŸÉ ÿ®ÿßŸÑŸÜÿ±ÿØ ÿßŸÑŸÖÿ±ŸÖŸä
                    setTimeout(() => {
                        movePlayer(gameState.currentPlayer, dice1 + dice2);
                    }, 1000);
                } else {
                    // ŸÅÿ¥ŸÑ ŸÅŸä ÿßŸÑÿÆÿ±Ÿàÿ¨
                    if (player.jailTurns >= 3) {
                        // ÿ•ÿ¨ÿ®ÿßÿ±Ÿä ÿπŸÑŸâ ÿßŸÑÿØŸÅÿπ
                        MessageSystem.show('üí∏ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ÿßŸÑÿ£ÿÆŸäÿ±ÿ© ŸÅÿ¥ŸÑÿ™! ÿØŸÅÿπ ÿ•ÿ¨ÿ®ÿßÿ±Ÿä ŸÑŸÑŸÉŸÅÿßŸÑÿ©.', 'error');
                        if (player.money >= 50) {
                            player.money -= 50;
                            releaseFromJail(player, 'forced');
                            // Ÿäÿ™ÿ≠ÿ±ŸÉ ÿ®ÿßŸÑŸÜÿ±ÿØ ÿßŸÑŸÖÿ±ŸÖŸä
                            setTimeout(() => {
                                movePlayer(gameState.currentPlayer, dice1 + dice2);
                            }, 1000);
                        } else {
                            MessageSystem.show('üí∏ ŸÑÿß ŸäŸÖŸÉŸÜŸÉ ÿØŸÅÿπ ÿßŸÑŸÉŸÅÿßŸÑÿ©! ÿ≥ÿ™ÿ®ŸÇŸâ ŸÅŸä ÿßŸÑÿ≥ÿ¨ŸÜ.', 'error');
                            setTimeout(() => {
                                nextTurn();
                            }, 2000);
                        }
                    } else {
                        MessageSystem.show(`üö´ ŸÅÿ¥ŸÑ ÿßŸÑŸáÿ±Ÿàÿ®! ÿßŸÑŸÜÿ±ÿØ: ${dice1} + ${dice2}`, 'error');
                        setTimeout(() => {
                            nextTurn();
                        }, 2000);
                    }
                }
            }
            
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease-in';
                setTimeout(() => modal.remove(), 300);
            }
        }

        function releaseFromJail(player, method) {
            player.inJail = false;
            player.jailTurns = 0;
            
            let message = '';
            switch (method) {
                case 'paid':
                    message = `üí∞ ${player.name} ÿØŸÅÿπ 50 ÿ±.ÿπ ŸàÿÆÿ±ÿ¨ ŸÖŸÜ ÿßŸÑÿ≥ÿ¨ŸÜ!`;
                    soundSystem.play('coin');
                    break;
                case 'escaped':
                    message = `üéâ ${player.name} Ÿáÿ±ÿ® ŸÖŸÜ ÿßŸÑÿ≥ÿ¨ŸÜ ÿ®ÿ≤Ÿàÿ¨Ÿä!`;
                    soundSystem.play('victory');
                    confetti({
                        particleCount: 50,
                        spread: 60,
                        origin: { y: 0.8 }
                    });
                    break;
                case 'forced':
                    message = `üí∏ ${player.name} ÿ£Ÿèÿ¨ÿ®ÿ± ÿπŸÑŸâ ÿØŸÅÿπ ÿßŸÑŸÉŸÅÿßŸÑÿ©!`;
                    soundSystem.play('lose');
                    break;
            }
            
            MessageSystem.show(message, method === 'escaped' ? 'success' : 'info');
            updatePlayersDisplay();
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ŸÅÿπŸäŸÑ ÿ≤ÿ± ÿßŸÑŸÜÿ±ÿØ
            document.getElementById('rollDice').disabled = false;
        }

        // ŸÜÿ∏ÿßŸÖ ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ•Ÿäÿ¨ÿßÿ± ÿßŸÑŸÖÿ≠ÿ™ÿ±ŸÅ
        function calculateRent(property, owner) {
            let baseRent = property.rent;
            
            // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÖÿßŸÑŸÉ ŸäŸÖŸÑŸÉ ŸÖÿ¨ŸÖŸàÿπÿ© ŸÉÿßŸÖŸÑÿ©
            if (hasMonopoly(owner, property)) {
                baseRent *= 2;
            }
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ™ŸÉŸÑŸÅÿ© ÿßŸÑŸÖÿ®ÿßŸÜŸä (ÿ≥Ÿäÿ™ŸÖ ÿ™ÿ∑ŸàŸäÿ± Ÿáÿ∞ÿß ŸÑÿßÿ≠ŸÇÿßŸã)
            // baseRent += (property.houses * property.houseRent);
            // if (property.hotel) baseRent = property.hotelRent;
            
            return baseRent;
        }

        function hasMonopoly(player, property) {
            const colorGroup = getColorGroup(property.id);
            return colorGroup.every(propId => player.properties.includes(propId));
        }

        function getColorGroup(propertyId) {
            // ŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ŸÅŸä ÿßŸÑŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿßŸÑÿπŸÖÿßŸÜŸä
            const colorGroups = {
                brown: [1, 3],
                lightBlue: [6, 8, 9],
                pink: [11, 13, 14],
                orange: [16, 18, 19],
                red: [21, 23, 24],
                yellow: [26, 27, 29],
                green: [31, 32, 34],
                blue: [37, 39]
            };
            
            for (const [color, properties] of Object.entries(colorGroups)) {
                if (properties.includes(propertyId)) {
                    return properties;
                }
            }
            return [];
        }

        // ====================================
        // ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÑÿπÿ® ÿßŸÑŸÖÿ≠ÿ™ÿ±ŸÅ ŸàÿßŸÑÿ™ŸÜÿßŸÅÿ≥Ÿä
        // ====================================

        function nextTurn() {
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÑŸàÿ≠ÿ© ÿßŸÑŸÇŸäÿßÿØŸäÿ©
            LeaderboardSystem.updateLeaderboard();
            
            // ŸÅÿ≠ÿµ ÿ¥ÿ±ÿ∑ ÿßŸÑŸÅŸàÿ≤
            const winner = checkWinCondition();
            if (winner) {
                handleGameWin(winner);
                return;
            }

            // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ™ÿßŸÑŸä ÿ∫Ÿäÿ± ÿßŸÑŸÖŸÅŸÑÿ≥
            let attempts = 0;
            do {
                gameState.currentPlayer = (gameState.currentPlayer + 1) % gameState.players.length;
                attempts++;
                
                // ÿ•ÿ∞ÿß ÿπÿßÿØ ŸÑŸÑÿßÿπÿ® ÿßŸÑÿ£ŸàŸÑÿå ÿ≤ŸäÿßÿØÿ© ÿßŸÑŸÖÿ±ÿ≠ŸÑÿ©
                if (gameState.currentPlayer === 0) {
                    gameState.currentRound++;
                    MessageSystem.show(`üîÑ ÿ®ÿØÿßŸäÿ© ÿßŸÑŸÖÿ±ÿ≠ŸÑÿ© ${gameState.currentRound}`, 'info', 3000);
                    soundSystem.play('notification');
                }
                
                // ŸÖŸÜÿπ ÿßŸÑŸÑŸàŸÑÿ® ÿßŸÑŸÑÿßŸÜŸáÿßÿ¶Ÿä
                if (attempts >= gameState.players.length) {
                    console.error('ÿ¨ŸÖŸäÿπ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ŸÖŸÅŸÑÿ≥ŸàŸÜ!');
                    break;
                }
            } while (gameState.players[gameState.currentPlayer].isBankrupt);
            
            // ÿ™ŸÖŸäŸäÿ≤ ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ≠ÿßŸÑŸä
            LeaderboardSystem.highlightCurrentPlayer();
            
            // ÿ•ÿ¥ÿπÿßÿ± ÿ®ÿØŸàÿ± ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ¨ÿØŸäÿØ
            const currentPlayer = gameState.players[gameState.currentPlayer];
            MessageSystem.show(`üéØ ÿØŸàÿ± ${currentPlayer.name}`, 'success', 4000);
            
            // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿµŸàÿ™Ÿäÿ© ŸÑÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿØŸàÿ±
            soundSystem.play('select');
            setTimeout(() => {
                soundSystem.play('notification');
            }, 500);
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ŸÑÿ™ŸÖŸäŸäÿ≤ ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ≠ÿßŸÑŸä
            highlightCurrentPlayerOnBoard();
            addBoardTurnEffect();
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ¨ŸÖŸäÿπ Ÿàÿßÿ¨Ÿáÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
            updatePlayersDisplay();
            updateGameInfo();
            updateButtonStates();
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÅŸàÿ±Ÿä ŸÑŸÑÿ®ÿ∑ÿßŸÇÿßÿ™
            setTimeout(() => {
                updatePlayerCardHighlight();
            }, 100);
        }

        function checkWinCondition() {
            // ŸÅÿ≠ÿµ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ ŸÑÿßÿπÿ® Ÿàÿßÿ≠ÿØ ŸÅŸÇÿ∑ ŸÑŸÖ ŸäŸÅŸÑÿ≥
            const activePlayers = gameState.players.filter(player => !player.isBankrupt);
            if (activePlayers.length === 1) {
                return activePlayers[0];
            }
            
            // ŸÅÿ≠ÿµ ÿ•ÿ∞ÿß ŸÑŸÖ Ÿäÿ®ŸÇ ÿ£Ÿä ŸÑÿßÿπÿ® ŸÜÿ¥ÿ∑ (ÿ≠ÿßŸÑÿ© ŸÜÿßÿØÿ±ÿ©)
            if (activePlayers.length === 0) {
                // ÿßŸÑÿ®ŸÜŸÉ ŸäŸÅŸàÿ≤!
                return { name: "ÿßŸÑÿ®ŸÜŸÉ ÿßŸÑŸÖÿ±ŸÉÿ≤Ÿä ÿßŸÑÿπŸèŸÖÿßŸÜŸä", isBank: true };
            }
            
            // ŸÅÿ≠ÿµ ÿ•ÿ∞ÿß ŸàÿµŸÑÿ™ ÿßŸÑŸÑÿπÿ®ÿ© ŸÑÿ≠ÿØ ÿ≤ŸÖŸÜŸä ŸÖÿπŸäŸÜ (ŸÖÿ´ŸÑÿßŸã 20 ŸÖÿ±ÿ≠ŸÑÿ©)
            if (gameState.currentRound >= 20) {
                // ÿ•ÿ±ÿ¨ÿßÿπ ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ£ÿ∫ŸÜŸâ ŸÖŸÜ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÜÿ¥ÿ∑ŸäŸÜ
                return activePlayers.reduce((richest, player) => {
                    const playerNetWorth = LeaderboardSystem.calculateNetWorth(player);
                    const richestNetWorth = LeaderboardSystem.calculateNetWorth(richest);
                    return playerNetWorth > richestNetWorth ? player : richest;
                });
            }
            
            return null;
        }

        function handleGameWin(winner) {
            // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑŸÅŸàÿ≤ ÿßŸÑÿ±ÿßÿ¶ÿπÿ©
            soundSystem.playSequence(['win', 'firework'], 1000);
            
            // ÿπÿ±ÿ∂ ÿ¥ÿßÿ¥ÿ© ÿßŸÑŸÅŸàÿ≤
            showWinnerScreen(winner);
            
            // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿ®ÿµÿ±Ÿäÿ© ŸÑŸÑŸÅŸàÿ≤
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    confetti({
                        particleCount: 100,
                        spread: 70,
                        origin: { y: 0.6 },
                        colors: ['#FFD700', '#FFA500', '#FF6B35', '#4ECDC4', '#45B7D1']
                    });
                }, i * 300);
            }
            
            // ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™
            AchievementSystem.checkAchievement(winner, 'game_winner');
            AchievementSystem.saveProgress();
        }

        function showWinnerScreen(winner) {
            const modal = document.createElement('div');
            modal.className = 'winner-modal';
            modal.innerHTML = `
                <div class="winner-content">
                    <h1>üèÜ ŸÖÿ®ÿ±ŸàŸÉ ÿßŸÑŸÅŸàÿ≤! üèÜ</h1>
                    <div class="winner-info">
                        <h2>${winner.name}</h2>
                        <p>ÿßŸÑŸÅÿßÿ¶ÿ≤ ÿ®ŸÑÿπÿ®ÿ© ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿπŸèŸÖÿßŸÜ!</p>
                        <div class="winner-stats">
                            <div class="stat">
                                <span>üí∞ ÿßŸÑÿ£ŸÖŸàÿßŸÑ ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©:</span>
                                <span>${winner.money} ÿ±.ÿπ</span>
                            </div>
                            <div class="stat">
                                <span>üè† ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑŸÖŸÖŸÑŸàŸÉÿ©:</span>
                                <span>${winner.properties.length}</span>
                            </div>
                            <div class="stat">
                                <span>üìä ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿµÿßŸÅŸäÿ©:</span>
                                <span>${LeaderboardSystem.calculateNetWorth(winner)} ÿ±.ÿπ</span>
                            </div>
                        </div>
                    </div>
                    <div class="winner-actions">
                        <button onclick="restartGame()" class="btn-restart">
                            üîÑ ŸÑÿπÿ®ÿ© ÿ¨ÿØŸäÿØÿ©
                        </button>
                        <button onclick="showFinalLeaderboard()" class="btn-leaderboard">
                            üìä ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©
                        </button>
                    </div>
                </div>
            `;
            
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: fadeIn 0.5s ease-out;
            `;
            
            document.body.appendChild(modal);
        }

        function updateButtonStates() {
            const rollDiceBtn = document.getElementById('rollDice');
            const endTurnBtn = document.getElementById('endTurn');
            
            if (!rollDiceBtn || !endTurnBtn) return;
            
            if (!gameState.gameStarted) {
                rollDiceBtn.disabled = true;
                endTurnBtn.disabled = true;
                rollDiceBtn.textContent = 'üé≤ ŸÅŸä ÿßŸÜÿ™ÿ∏ÿßÿ± ÿßŸÑÿ®ÿØÿ°';
                endTurnBtn.textContent = '‚è∏Ô∏è ŸÖÿ™ŸàŸÇŸÅ';
            } else {
                const currentPlayer = gameState.players[gameState.currentPlayer];
                rollDiceBtn.textContent = `üé≤ ${currentPlayer?.name} - ÿßÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ`;
                endTurnBtn.textContent = `‚è≠Ô∏è ÿ•ŸÜŸáÿßÿ° ÿØŸàÿ± ${currentPlayer?.name}`;
                
                // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ∏Ÿáÿ± ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ŸÑŸÑÿßÿπÿ® ÿßŸÑÿ≠ÿßŸÑŸä
                rollDiceBtn.style.background = 'linear-gradient(45deg, #00d2ff, #3a7bd5)';
                rollDiceBtn.style.boxShadow = '0 4px 15px rgba(0, 210, 255, 0.4)';
                endTurnBtn.style.background = 'linear-gradient(45deg, #ff6b6b, #ffa500)';
                endTurnBtn.style.boxShadow = '0 4px 15px rgba(255, 107, 107, 0.4)';
            }
        }

        // ÿØÿßŸÑÿ© ŸÑÿ™ÿ≠ÿØŸäÿ´ ÿ™ŸÖŸäŸäÿ≤ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™
        function updatePlayerCardHighlight() {
            const playerCards = document.querySelectorAll('.player-card');
            playerCards.forEach((card, index) => {
                card.classList.remove('current-player');
                if (index === gameState.currentPlayer) {
                    card.classList.add('current-player');
                    // ÿ™ÿ£ÿ´Ÿäÿ± ÿµŸàÿ™Ÿä ÿÆŸÅŸäŸÅ
                    setTimeout(() => {
                        soundSystem.play('hover');
                    }, 300);
                }
            });
        }

        // ÿØÿßŸÑÿ© ŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ŸÑŸÑŸàÿ≠ÿ© ÿπŸÜÿØ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿØŸàÿ±
        function addBoardTurnEffect() {
            const gameBoard = document.querySelector('.game-board');
            if (gameBoard) {
                gameBoard.style.transform = 'scale(1.02)';
                gameBoard.style.boxShadow = '0 0 50px rgba(0, 210, 255, 0.6)';
                gameBoard.style.transition = 'all 0.5s ease';
                
                setTimeout(() => {
                    gameBoard.style.transform = 'scale(1)';
                    gameBoard.style.boxShadow = '0 20px 40px rgba(0,0,0,0.1)';
                }, 800);
            }
        }

        function highlightCurrentPlayerOnBoard() {
            // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ™ŸÖŸäŸäÿ≤ ŸÖŸÜ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
            document.querySelectorAll('.player-token').forEach(token => {
                token.classList.remove('current-player-highlight');
            });
            
            // ÿ™ŸÖŸäŸäÿ≤ ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ≠ÿßŸÑŸä ÿπŸÑŸâ ÿßŸÑŸÑŸàÿ≠ÿ©
            const currentPlayerToken = document.querySelector(`[data-player="${gameState.currentPlayer}"]`);
            if (currentPlayerToken) {
                currentPlayerToken.classList.add('current-player-highlight');
            }
        }

        function updateGameInfo() {
            const gameInfoDiv = document.getElementById('game-info');
            if (!gameInfoDiv) return;
            
            const currentPlayer = gameState.players[gameState.currentPlayer];
            if (!currentPlayer) return;
            
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            validatePlayerData(currentPlayer);
            
            const currentPosition = currentPlayer.position >= 0 && currentPlayer.position < omanProperties.length ? 
                currentPlayer.position : 0;
            
            gameInfoDiv.innerHTML = `
                <div class="current-turn-info" style="
                    background: linear-gradient(135deg, #00d2ff, #3a7bd5, #667eea);
                    color: white;
                    padding: 25px;
                    border-radius: 20px;
                    text-align: center;
                    box-shadow: 0 10px 30px rgba(0, 210, 255, 0.4);
                    margin-bottom: 20px;
                    border: 3px solid rgba(255,255,255,0.3);
                    animation: infoGlow 3s ease-in-out infinite alternate;
                    position: relative;
                    overflow: hidden;
                ">
                    <!-- ÿ™ÿ£ÿ´Ÿäÿ± ÿÆŸÑŸÅŸäÿ© ŸÖÿ™ÿ≠ÿ±ŸÉÿ© -->
                    <div style="
                        position: absolute;
                        top: -50%;
                        left: -50%;
                        width: 200%;
                        height: 200%;
                        background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
                        animation: shimmer 3s ease-in-out infinite;
                        pointer-events: none;
                    "></div>
                    
                    <h2 style="margin: 0 0 20px 0; font-size: 2em; position: relative; z-index: 1;">
                        üéØ ÿØŸàÿ±: ${currentPlayer.name}
                    </h2>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; position: relative; z-index: 1;">
                        <div style="background: rgba(255,255,255,0.25); padding: 15px; border-radius: 15px; border: 2px solid rgba(255,255,255,0.3); backdrop-filter: blur(10px);">
                            <div style="font-size: 1.2em; font-weight: bold;">üèÜ ÿßŸÑŸÖÿ±ÿ≠ŸÑÿ©</div>
                            <div style="font-size: 1.5em; margin-top: 5px;">${gameState.currentRound || 1}</div>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.25); padding: 15px; border-radius: 15px; border: 2px solid rgba(255,255,255,0.3); backdrop-filter: blur(10px);">
                            <div style="font-size: 1.2em; font-weight: bold;">üìç ÿßŸÑŸÖŸàŸÇÿπ</div>
                            <div style="font-size: 1.2em; margin-top: 5px;">${omanProperties[currentPosition]?.name || 'ÿßŸÑÿ®ÿØÿßŸäÿ©'}</div>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.25); padding: 15px; border-radius: 15px; border: 2px solid rgba(255,255,255,0.3); backdrop-filter: blur(10px);">
                            <div style="font-size: 1.2em; font-weight: bold;">üí∞ ÿßŸÑÿ±ÿµŸäÿØ</div>
                            <div style="font-size: 1.5em; margin-top: 5px;">${formatMoney(currentPlayer.money)}</div>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.25); padding: 15px; border-radius: 15px; border: 2px solid rgba(255,255,255,0.3); backdrop-filter: blur(10px);">
                            <div style="font-size: 1.2em; font-weight: bold;">üè† ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™</div>
                            <div style="font-size: 1.5em; margin-top: 5px;">${currentPlayer.properties ? currentPlayer.properties.length : 0}</div>
                        </div>
                    </div>
                    
                    ${gameState.gameStarted ? `
                        <div style="margin-top: 20px; padding: 15px; background: rgba(46, 204, 113, 0.4); border-radius: 15px; border: 3px dashed rgba(255,255,255,0.6); position: relative; z-index: 1;">
                            <div style="font-size: 1.3em; font-weight: bold;">üí° ÿßŸÑÿ™ÿπŸÑŸäŸÖÿßÿ™</div>
                            <div style="font-size: 1.1em; margin-top: 5px;">ÿßÿ∂ÿ∫ÿ∑ "ÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ" ŸÑŸÑÿ®ÿØÿ° ŸÅŸä ÿ≠ÿ±ŸÉÿ™ŸÉ!</div>
                        </div>
                    ` : `
                        <div style="margin-top: 20px; padding: 15px; background: rgba(231, 76, 60, 0.4); border-radius: 15px; border: 3px dashed rgba(255,255,255,0.6); position: relative; z-index: 1;">
                            <div style="font-size: 1.3em; font-weight: bold;">‚è≥ ŸÅŸä ÿßŸÜÿ™ÿ∏ÿßÿ± ÿßŸÑÿ®ÿØÿ°</div>
                            <div style="font-size: 1.1em; margin-top: 5px;">ÿßÿ∂ÿ∫ÿ∑ "ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ©" ŸÑŸÑÿ®ÿØÿ°!</div>
                        </div>ÿ¥
                    `}
                </div>
            `;
        }

        function restartGame() {
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿ≠ÿßŸÑÿ© ÿßŸÑŸÑÿπÿ®ÿ©
            gameState.currentPlayer = 0;
            gameState.currentRound = 1;
            gameState.players.forEach(player => {
                player.money = 1500;
                player.position = 0;
                player.properties = [];
                player.inJail = false;
                player.jailTurns = 0;
            });
            
            // ÿ•ÿ≤ÿßŸÑÿ© ÿ¥ÿßÿ¥ÿ© ÿßŸÑŸÅŸàÿ≤
            const modal = document.querySelector('.winner-modal');
            if (modal) modal.remove();
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ¥ÿßÿ¥ÿ©
            updatePlayersDisplay();
            LeaderboardSystem.updateLeaderboard();
            MessageSystem.show('üéÆ ÿ®ÿØÿ£ÿ™ ŸÑÿπÿ®ÿ© ÿ¨ÿØŸäÿØÿ©!', 'success');
            soundSystem.play('startapp');
        }

        function showFinalLeaderboard() {
            LeaderboardSystem.showLeaderboard();
        }

        function endTurn() {
            if (!gameState.gameStarted) {
                MessageSystem.show('Ÿäÿ¨ÿ® ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ© ÿ£ŸàŸÑÿßŸã!', 'error');
                return;
            }

            // ŸÅÿ≠ÿµ ÿ•ŸÅŸÑÿßÿ≥ ÿßŸÑŸÑÿßÿπÿ® ÿßŸÑÿ≠ÿßŸÑŸä ŸÇÿ®ŸÑ ÿ•ŸÜŸáÿßÿ° ÿßŸÑÿØŸàÿ±
            const currentPlayer = gameState.players[gameState.currentPlayer];
            if (currentPlayer.money < 0 && !currentPlayer.isBankrupt) {
                console.log(`üí∏ ÿßŸÉÿ™ÿ¥ÿßŸÅ ÿ•ŸÅŸÑÿßÿ≥ ${currentPlayer.name} ŸÅŸä ŸÜŸáÿßŸäÿ© ÿßŸÑÿØŸàÿ±`);
                handleBankruptcy(gameState.currentPlayer, Math.abs(currentPlayer.money));
                return; // ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿØŸàÿ± ÿ≠ÿ™Ÿâ Ÿäÿ™ŸÖ ÿßŸÑÿ™ÿπÿßŸÖŸÑ ŸÖÿπ ÿßŸÑÿ•ŸÅŸÑÿßÿ≥
            }

            // ÿ™ÿπÿ∑ŸäŸÑ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿØŸàÿ± ÿßŸÑÿ≠ÿßŸÑŸä
            document.getElementById('rollDice').disabled = true;
            document.getElementById('endTurn').disabled = true;
            
            // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ŸÑŸÑÿØŸàÿ± ÿßŸÑÿ™ÿßŸÑŸä
            nextTurn();
            
            // ÿ™ŸÅÿπŸäŸÑ ÿ≤ÿ± ÿ±ŸÖŸä ÿßŸÑŸÜÿ±ÿØ ŸÑŸÑÿßÿπÿ® ÿßŸÑÿ¨ÿØŸäÿØ
            setTimeout(() => {
                document.getElementById('rollDice').disabled = false;
            }, 1000);
        }

        // ===========================================
        // ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÑÿπÿ®ÿ©
        // ===========================================
        function startGame() {
            if (gameState.gameStarted) {
                MessageSystem.show('ÿßŸÑŸÑÿπÿ®ÿ© ÿ®ÿØÿ£ÿ™ ÿ®ÿßŸÑŸÅÿπŸÑ!', 'error');
                return;
            }

            if (!gameState.players || gameState.players.length < 2) {
                MessageSystem.show('Ÿäÿ¨ÿ® ÿ•ÿπÿØÿßÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿ£ŸàŸÑÿßŸã!', 'error');
                return;
            }

            gameState.gameStarted = true;
            gameState.currentPlayer = 0;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ∏Ÿáÿ± ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™
            updatePropertyDisplay();
            
            MessageSystem.show('üéÆ ÿ®ÿØÿ£ÿ™ ÿßŸÑŸÑÿπÿ®ÿ©! ÿ≠ÿ∏ÿßŸã ŸÖŸàŸÅŸÇÿßŸã!', 'success');
            soundSystem.play('win');
            updatePlayersDisplay();
            LeaderboardSystem.updateLeaderboard();
        }

        function showRules() {
            document.getElementById('rulesModal').style.display = 'block';
        }

        // ===========================================
        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ£ÿ≠ÿØÿßÿ´
        // ===========================================
        function setupEventListeners() {
            console.log('üîß ÿ®ÿØÿ° ÿ•ÿπÿØÿßÿØ ŸÖÿπÿßŸÑÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´...');
            
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ÿßŸÑÿπŸÜÿßÿµÿ± ŸÇÿ®ŸÑ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ£ÿ≠ÿØÿßÿ´
            const setupPlayersBtn = document.getElementById('setupPlayersBtn');
            const startGameBtn = document.getElementById('startGameBtn');
            const rollDiceBtn = document.getElementById('rollDice');
            const endTurnBtn = document.getElementById('endTurn');
            const showRulesBtn = document.getElementById('showRules');
            
            // ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
            if (setupPlayersBtn) {
                setupPlayersBtn.addEventListener('click', setupSmartPlayerSelection);
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ setupPlayersBtn');
            }
            if (startGameBtn) {
                startGameBtn.addEventListener('click', startGameWithStudents);
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ startGameBtn');
            }
            if (rollDiceBtn) {
                rollDiceBtn.addEventListener('click', () => rollDice());
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ rollDice');
            }
            if (endTurnBtn) {
                endTurnBtn.addEventListener('click', () => endTurn());
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ endTurn');
            }
            if (showRulesBtn) {
                showRulesBtn.addEventListener('click', showRules);
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ showRules');
            }

            // Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑÿ∞ŸÉŸäÿ©
            const playersCount = document.getElementById('playersCount');
            if (playersCount) {
                playersCount.addEventListener('change', () => {
                    const setupBtn = document.getElementById('setupPlayersBtn');
                    const classSelect = document.getElementById('classSelect');
                    if (setupBtn && classSelect && classSelect.value) {
                        setupBtn.disabled = false;
                    }
                });
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ playersCount');
            }
            
            // ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ŸÅŸä ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ±
            const confirmBtn = document.getElementById('confirmPlayerSelection');
            const cancelBtn = document.getElementById('cancelPlayerSelection');
            const clearBtn = document.getElementById('clearSelection');
            
            if (confirmBtn) {
                confirmBtn.addEventListener('click', confirmPlayerSelection);
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ confirmPlayerSelection');
            }
            if (cancelBtn) {
                cancelBtn.addEventListener('click', cancelPlayerSelection);
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ cancelPlayerSelection');
            }
            if (clearBtn) {
                clearBtn.addEventListener('click', clearSelection);
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ clearSelection');
            }

            // ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿπŸÑŸàŸäÿ© ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜÿ©
            setupTopControlButtons();
            
            console.log('‚úÖ ÿ™ŸÖ ÿ•ÿπÿØÿßÿØ ÿ¨ŸÖŸäÿπ ŸÖÿπÿßŸÑÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´');
        }
        
        // ÿ•ÿπÿØÿßÿØ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿπŸÑŸàŸäÿ©
        function setupTopControlButtons() {
            console.log('üéÆ ÿ•ÿπÿØÿßÿØ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿπŸÑŸàŸäÿ©...');
            
            // ÿ≤ÿ± ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
            const returnToIndex = document.getElementById('returnToIndex');
            if (returnToIndex) {
                returnToIndex.addEventListener('click', () => {
                    if (confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©ÿü')) {
                        window.location.href = '../index.html';
                    }
                });
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≤ÿ± ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©');
            } else {
                console.error('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ≤ÿ± returnToIndex');
            }

            // ÿ≤ÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿ®ÿßŸÑÿµŸàÿ™
            const soundToggle = document.getElementById('soundToggle');
            if (soundToggle) {
                soundToggle.addEventListener('click', () => {
                    try {
                        const enabled = soundSystem.toggle();
                        const icon = soundToggle.querySelector('i');
                        if (icon) {
                            icon.className = enabled ? 'fas fa-volume-up' : 'fas fa-volume-mute';
                        }
                        MessageSystem.show(enabled ? 'üîä ÿ™ŸÖ ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿµŸàÿ™' : 'üîá ÿ™ŸÖ ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿµŸàÿ™', 'info', 2000);
                    } catch (error) {
                        console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿµŸàÿ™:', error);
                        MessageSystem.show('ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿµŸàÿ™', 'error', 2000);
                    }
                });
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≤ÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿ®ÿßŸÑÿµŸàÿ™');
            } else {
                console.error('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ≤ÿ± soundToggle');
            }

            // ÿ≤ÿ± ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©
            const fullscreenToggle = document.getElementById('fullscreenToggle');
            if (fullscreenToggle) {
                fullscreenToggle.addEventListener('click', () => {
                    try {
                        if (!document.fullscreenElement) {
                            document.documentElement.requestFullscreen().then(() => {
                                const icon = fullscreenToggle.querySelector('i');
                                if (icon) {
                                    icon.className = 'fas fa-compress';
                                }
                                MessageSystem.show('üñ•Ô∏è ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©', 'success', 2000);
                            }).catch(err => {
                                console.error('ÿÆÿ∑ÿ£ ŸÅŸä ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©:', err);
                                MessageSystem.show('‚ùå ŸÑÿß ŸäŸÖŸÉŸÜ ÿ™ŸÅÿπŸäŸÑ ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©', 'error', 2000);
                            });
                        } else {
                            document.exitFullscreen().then(() => {
                                const icon = fullscreenToggle.querySelector('i');
                                if (icon) {
                                    icon.className = 'fas fa-expand';
                                }
                                MessageSystem.show('ü™ü ÿ™ŸÖ ÿ•ŸÑÿ∫ÿßÿ° ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©', 'info', 2000);
                            });
                        }
                    } catch (error) {
                        console.error('ÿÆÿ∑ÿ£ ŸÅŸä ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©:', error);
                        MessageSystem.show('‚ùå ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ© ÿ∫Ÿäÿ± ŸÖÿØÿπŸàŸÖ', 'error', 2000);
                    }
                });
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≤ÿ± ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©');
            } else {
                console.error('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ≤ÿ± fullscreenToggle');
            }

            // ÿ≤ÿ± ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©
            const gameInfo = document.getElementById('gameInfo');
            if (gameInfo) {
                gameInfo.addEventListener('click', () => {
                    try {
                        showGameInfoModal();
                        MessageSystem.show('üìñ ÿ™ŸÖ ÿπÿ±ÿ∂ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©', 'info', 2000);
                    } catch (error) {
                        console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿπÿ±ÿ∂ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©:', error);
                        MessageSystem.show('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿπÿ±ÿ∂ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™', 'error', 2000);
                    }
                });
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≤ÿ± ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©');
            } else {
                console.error('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ≤ÿ± gameInfo');
            }
        }
        
        // ÿπÿ±ÿ∂ ŸÜÿßŸÅÿ∞ÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©
        function showGameInfoModal() {
            const gameInfoModal = document.createElement('div');
            gameInfoModal.className = 'modal';
            gameInfoModal.style.display = 'block';
            gameInfoModal.innerHTML = `
                <div class="modal-content">
                    <span class="close" onclick="this.closest('.modal').remove()">&times;</span>
                    <h2><i class="fas fa-info-circle"></i> ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©</h2>
                    <div class="game-info-content">
                        <div class="info-section">
                            <h3>üéÆ ŸÜŸàÿπ ÿßŸÑŸÑÿπÿ®ÿ©</h3>
                            <p>ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿ≥ŸÑÿ∑ŸÜÿ© ÿπŸèŸÖÿßŸÜ ÿßŸÑÿ™ÿπŸÑŸäŸÖŸä</p>
                        </div>
                        <div class="info-section">
                            <h3>üéØ ÿßŸÑŸáÿØŸÅ</h3>
                            <p>ÿ™ÿπŸÑŸÖ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸäÿß ÿßŸÑÿπŸèŸÖÿßŸÜŸäÿ© Ÿàÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ£ŸÖŸàÿßŸÑ ŸÖŸÜ ÿÆŸÑÿßŸÑ ÿ¥ÿ±ÿßÿ° ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™</p>
                        </div>
                        <div class="info-section">
                            <h3>üë• ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ</h3>
                            <p>2-6 ŸÑÿßÿπÿ®ŸäŸÜ</p>
                        </div>
                        <div class="info-section">
                            <h3>‚è±Ô∏è ŸÖÿØÿ© ÿßŸÑŸÑÿπÿ®ÿ©</h3>
                            <p>30-60 ÿØŸÇŸäŸÇÿ©</p>
                        </div>
                        <div class="info-section">
                            <h3>üèõÔ∏è ÿßŸÑÿ£ŸÖÿßŸÉŸÜ</h3>
                            <p>ŸÖÿØŸÜ ŸàŸÖÿπÿßŸÑŸÖ ÿ≠ŸÇŸäŸÇŸäÿ© ŸÖŸÜ ÿ≥ŸÑÿ∑ŸÜÿ© ÿπŸèŸÖÿßŸÜ</p>
                        </div>
                        <div class="info-section">
                            <h3>üì± ÿßŸÑÿ•ÿµÿØÿßÿ±</h3>
                            <p>ÿßŸÑÿ•ÿµÿØÿßÿ± ÿßŸÑÿ™ÿπŸÑŸäŸÖŸä 2025</p>
                        </div>
                        <div class="info-section">
                            <h3>üîÑ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™</h3>
                            <p>ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™: ${playerData && Object.keys(playerData).length > 0 ? '‚úÖ ŸÖÿ≠ŸÖŸÑÿ© ÿ®ŸÜÿ¨ÿßÿ≠' : '‚ùå ÿ∫Ÿäÿ± ŸÖÿ≠ŸÖŸÑÿ©'}</p>
                            <p>ÿπÿØÿØ ÿßŸÑÿµŸÅŸàŸÅ: ${playerData ? Object.keys(playerData).length : 0}</p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button onclick="this.closest('.modal').remove()" class="btn btn-primary">ÿ≠ÿ≥ŸÜÿßŸã</button>
                        ${!playerData || Object.keys(playerData).length === 0 ? 
                            '<button onclick="this.closest(\'.modal\').remove(); location.reload();" class="btn btn-secondary">ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©</button>' : 
                            ''}
                    </div>
                </div>
            `;
            document.body.appendChild(gameInfoModal);
        }
        
        // ÿ•ÿπÿØÿßÿØ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿπŸÑŸàŸäÿ©
        function setupTopControlButtons() {
            console.log('üéÆ ÿ•ÿπÿØÿßÿØ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿπŸÑŸàŸäÿ©...');
            
            // ÿ≤ÿ± ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
            const returnToIndex = document.getElementById('returnToIndex');
            if (returnToIndex) {
                returnToIndex.addEventListener('click', () => {
                    if (confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©ÿü')) {
                        window.location.href = '../index.html';
                    }
                });
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≤ÿ± ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©');
            }

            // ÿ≤ÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿ®ÿßŸÑÿµŸàÿ™
            const soundToggle = document.getElementById('soundToggle');
            if (soundToggle) {
                soundToggle.addEventListener('click', () => {
                    try {
                        const enabled = soundSystem.toggle();
                        const icon = soundToggle.querySelector('i');
                        if (icon) {
                            icon.className = enabled ? 'fas fa-volume-up' : 'fas fa-volume-mute';
                        }
                        MessageSystem.show(enabled ? 'üîä ÿ™ŸÖ ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿµŸàÿ™' : 'üîá ÿ™ŸÖ ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿµŸàÿ™', 'info', 2000);
                    } catch (error) {
                        console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿµŸàÿ™:', error);
                        MessageSystem.show('ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿµŸàÿ™', 'error', 2000);
                    }
                });
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≤ÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿ®ÿßŸÑÿµŸàÿ™');
            }

            // ÿ≤ÿ± ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©
            const fullscreenToggle = document.getElementById('fullscreenToggle');
            if (fullscreenToggle) {
                fullscreenToggle.addEventListener('click', () => {
                    try {
                        if (!document.fullscreenElement) {
                            document.documentElement.requestFullscreen().then(() => {
                                const icon = fullscreenToggle.querySelector('i');
                                if (icon) {
                                    icon.className = 'fas fa-compress';
                                }
                                MessageSystem.show('üñ•Ô∏è ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©', 'success', 2000);
                            }).catch(err => {
                                console.error('ÿÆÿ∑ÿ£ ŸÅŸä ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©:', err);
                                MessageSystem.show('‚ùå ŸÑÿß ŸäŸÖŸÉŸÜ ÿ™ŸÅÿπŸäŸÑ ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©', 'error', 2000);
                            });
                        } else {
                            document.exitFullscreen().then(() => {
                                const icon = fullscreenToggle.querySelector('i');
                                if (icon) {
                                    icon.className = 'fas fa-expand';
                                }
                                MessageSystem.show('ü™ü ÿ™ŸÖ ÿ•ŸÑÿ∫ÿßÿ° ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©', 'info', 2000);
                            });
                        }
                    } catch (error) {
                        console.error('ÿÆÿ∑ÿ£ ŸÅŸä ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©:', error);
                        MessageSystem.show('‚ùå ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ© ÿ∫Ÿäÿ± ŸÖÿØÿπŸàŸÖ', 'error', 2000);
                    }
                });
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≤ÿ± ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©');
            }

            // ÿ≤ÿ± ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©
            const gameInfo = document.getElementById('gameInfo');
            if (gameInfo) {
                gameInfo.addEventListener('click', () => {
                    try {
                        showGameInfoModal();
                        MessageSystem.show('üìñ ÿ™ŸÖ ÿπÿ±ÿ∂ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©', 'info', 2000);
                    } catch (error) {
                        console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿπÿ±ÿ∂ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©:', error);
                        MessageSystem.show('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿπÿ±ÿ∂ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™', 'error', 2000);
                    }
                });
                console.log('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≤ÿ± ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©');
            }
            
            // ÿ•ÿπÿØÿßÿØ ÿßÿÆÿ™ÿµÿßÿ±ÿßÿ™ ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖŸÅÿßÿ™Ÿäÿ≠
            document.addEventListener('keydown', (e) => {
                if (e.key === ' ') {
                    e.preventDefault();
                    if (typeof rollDice === 'function') rollDice();
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (typeof endTurn === 'function') endTurn();
                } else if (e.key === 'Escape') {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.style.display = 'none';
                    });
                    const smartSelection = document.getElementById('smartPlayerSelection');
                    if (smartSelection) smartSelection.style.display = 'none';
                }
            });
        }

        // ===========================================
        // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑŸÑÿπÿ®ÿ©
        // ===========================================
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üéÆ ÿ®ÿØÿ° ÿ™ÿ≠ŸÖŸäŸÑ ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿπŸèŸÖÿßŸÜ...');

            try {
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿßÿ®
                console.log('üîÑ ÿ®ÿØÿ° ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿßÿ®...');
                await loadStudentData();
                console.log('‚úÖ ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿßÿ®');
                
                // ŸÖŸÑÿ° ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿµŸÅŸàŸÅ
                console.log('üìö ŸÖŸÑÿ° ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿµŸÅŸàŸÅ...');
                populateClassSelect();
                console.log('‚úÖ ÿ™ŸÖ ŸÖŸÑÿ° ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿµŸÅŸàŸÅ');
                
                // ÿ•ŸÜÿ¥ÿßÿ° ŸÑŸàÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ©
                console.log('üèóÔ∏è ÿ•ŸÜÿ¥ÿßÿ° ŸÑŸàÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ©...');
                createGameBoard();
                console.log('‚úÖ ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ŸÑŸàÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ©');
                
                // ÿ•ÿπÿØÿßÿØ ŸÖÿπÿßŸÑÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´
                console.log('‚öôÔ∏è ÿ•ÿπÿØÿßÿØ ŸÖÿπÿßŸÑÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´...');
                setupEventListeners();
                console.log('‚úÖ ÿ™ŸÖ ÿ•ÿπÿØÿßÿØ ŸÖÿπÿßŸÑÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´');
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ±ÿ≥ŸàŸÖ ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ© ŸàÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑÿ™ŸÅÿßÿπŸÑŸäÿ©
                const animationStyles = `
                    @keyframes slideInRight {
                        from {
                            opacity: 0;
                            transform: translateX(100px);
                        }
                        to {
                            opacity: 1;
                            transform: translateX(0);
                        }
                    }
                    
                    @keyframes slideOutRight {
                        from {
                            opacity: 1;
                            transform: translateX(0);
                        }
                        to {
                            opacity: 0;
                            transform: translateX(100px);
                        }
                    }
                    
                    @keyframes shake {
                        0%, 100% { transform: translateX(0); }
                        25% { transform: translateX(-5px); }
                        75% { transform: translateX(5px); }
                    }
                    
                    .current-player {
                        border: 3px solid var(--accent-gold) !important;
                        box-shadow: var(--shadow-glow-gold) !important;
                    }
                    
                    /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑÿ™ŸÅÿßÿπŸÑŸäÿ© */
                    .students-interactive-grid {
                        display: grid !important;
                        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)) !important;
                        gap: 15px !important;
                        padding: 0 30px !important;
                        max-height: 500px !important;
                        overflow-y: auto !important;
                        margin-bottom: 30px !important;
                    }
                    
                    .student-interactive-card {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
                        border-radius: 12px !important;
                        padding: 15px !important;
                        text-align: center !important;
                        cursor: pointer !important;
                        transition: all 0.3s ease !important;
                        border: 2px solid transparent !important;
                        position: relative !important;
                        overflow: hidden !important;
                        color: white !important;
                        min-height: 140px !important;
                        display: flex !important;
                        flex-direction: column !important;
                        align-items: center !important;
                        justify-content: center !important;
                    }
                    
                    .student-interactive-card::before {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
                        z-index: 1;
                        transition: opacity 0.3s ease;
                    }
                    
                    .student-interactive-card:hover {
                        transform: translateY(-5px) !important;
                        box-shadow: 0 10px 25px rgba(0,0,0,0.2) !important;
                        border-color: #ffd700 !important;
                    }
                    
                    .student-interactive-card:hover::before {
                        opacity: 0.8;
                    }
                    
                    .student-interactive-card.selected {
                        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%) !important;
                        border-color: #ffd700 !important;
                        transform: translateY(-3px) !important;
                        box-shadow: 0 8px 20px rgba(17, 153, 142, 0.4) !important;
                    }
                    
                    .student-interactive-card.selected::before {
                        background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
                    }
                    
                    .student-avatar {
                        width: 50px !important;
                        height: 50px !important;
                        border-radius: 50% !important;
                        background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%) !important;
                        display: flex !important;
                        align-items: center !important;
                        justify-content: center !important;
                        margin: 0 auto 10px !important;
                        font-size: 20px !important;
                        font-weight: bold !important;
                        color: #333 !important;
                        position: relative !important;
                        z-index: 2 !important;
                        box-shadow: 0 3px 10px rgba(255, 215, 0, 0.4) !important;
                    }
                    
                    .student-name {
                        font-weight: bold !important;
                        color: white !important;
                        margin-bottom: 8px !important;
                        position: relative !important;
                        z-index: 2 !important;
                        font-size: 14px !important;
                    }
                    
                    .student-status {
                        display: flex !important;
                        align-items: center !important;
                        justify-content: center !important;
                        gap: 5px !important;
                        color: rgba(255,255,255,0.9) !important;
                        font-size: 12px !important;
                        position: relative !important;
                        z-index: 2 !important;
                    }
                    
                    .student-status i {
                        font-size: 14px !important;
                    }
                    
                    .selected-player-card {
                        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%) !important;
                        border-radius: 10px !important;
                        padding: 15px !important;
                        text-align: center !important;
                        position: relative !important;
                        color: white !important;
                        border: 2px solid #ffd700 !important;
                    }
                    
                    .selected-player-card .remove-btn {
                        position: absolute !important;
                        top: -8px !important;
                        right: -8px !important;
                        background: #ff4757 !important;
                        border: none !important;
                        border-radius: 50% !important;
                        width: 24px !important;
                        height: 24px !important;
                        display: flex !important;
                        align-items: center !important;
                        justify-content: center !important;
                        cursor: pointer !important;
                        color: white !important;
                        font-size: 12px !important;
                        transition: all 0.3s ease !important;
                        z-index: 3 !important;
                    }
                    
                    .selected-player-card .remove-btn:hover {
                        background: #ff3838 !important;
                        transform: scale(1.1) !important;
                    }
                    
                    .player-role {
                        margin-top: 8px !important;
                        font-size: 11px !important;
                        color: rgba(255,255,255,0.8) !important;
                        font-weight: bold !important;
                    }
                `;
                
                const styleSheet = document.createElement('style');
                styleSheet.textContent = animationStyles;
                document.head.appendChild(styleSheet);
                
                MessageSystem.show('ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿπŸèŸÖÿßŸÜ ÿ®ŸÜÿ¨ÿßÿ≠! üéâ', 'success');
                console.log('‚úÖ ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÑÿπÿ®ÿ© ÿ®ŸÜÿ¨ÿßÿ≠!');
                
            } catch (error) {
                console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÑÿπÿ®ÿ©:', error);
                MessageSystem.show('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÑÿπÿ®ÿ©', 'error');
            }
        });

        // ÿ•ÿπÿØÿßÿØ Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜÿ©
        document.addEventListener('DOMContentLoaded', () => {
            const playerCountOptions = document.querySelectorAll('.player-count-option');
            const playersCountSelect = document.getElementById('playersCount');
            
            // ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
            const defaultOption = document.querySelector('.player-count-option[data-count="2"]');
            if (defaultOption) {
                defaultOption.classList.add('selected');
                playersCountSelect.value = '2';
            }
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑŸÜŸÇÿ± ŸÑÿÆŸäÿßÿ±ÿßÿ™ ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ
            playerCountOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ™ÿ≠ÿØŸäÿØ ŸÖŸÜ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™
                    playerCountOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑÿÆŸäÿßÿ± ÿßŸÑŸÖŸÜŸÇŸàÿ±
                    option.classList.add('selected');
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ŸÇŸäŸÖÿ© ÿßŸÑŸÄ select ÿßŸÑŸÖÿÆŸÅŸä
                    const count = option.getAttribute('data-count');
                    playersCountSelect.value = count;
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿπÿØÿßÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®
                    document.getElementById('totalPlayersNeeded').textContent = count;
                    
                    // ÿ™ÿ£ÿ´Ÿäÿ± ÿµŸàÿ™Ÿä
                    soundSystem.play('Click');
                    
                    // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä
                    option.style.animation = 'pulse 0.3s ease';
                    setTimeout(() => {
                        option.style.animation = '';
                    }, 300);
                    
                    // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿπÿØÿØ
                    selectedPlayers = [];
                    updateSelectionUI();
                    
                    // ÿ±ÿ≥ÿßŸÑÿ© ÿ•ÿπŸÑÿßŸÖŸäÿ©
                    MessageSystem.show(`ÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ${count} ŸÑÿßÿπÿ®ŸäŸÜ ŸÑŸÑÿπÿ®ÿ©! üéÆ`, 'info', 2000);
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ±
                    updateSetupButtonState();
                });
                
                // ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑÿ™ŸÅÿßÿπŸÑ
                option.addEventListener('mouseenter', () => {
                    if (!option.classList.contains('selected')) {
                        option.style.transform = 'translateY(-2px) scale(1.02)';
                    }
                });
                
                option.addEventListener('mouseleave', () => {
                    if (!option.classList.contains('selected')) {
                        option.style.transform = 'translateY(0) scale(1)';
                    }
                });
            });
        });
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿ≤ÿ± ÿßŸÑÿ•ÿπÿØÿßÿØ
        function updateSetupButtonState() {
            const classSelect = document.getElementById('classSelect');
            const playersCount = document.getElementById('playersCount').value;
            const setupBtn = document.getElementById('setupPlayersBtn');
            
            setupBtn.disabled = !classSelect.value || !playersCount;
        }
    </script>

    <!-- ÿßŸÑŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®Ÿä ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ© -->
    <script src="../assets/js/responsive-helper.js"></script>
</body>
</html>
